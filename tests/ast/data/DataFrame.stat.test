## TEST CASE

df = session.table("test_table")

df2 = df.stat.approx_quantile("NUM", [0.5])

df3 = df.stat.approx_quantile(["NUM", "NUM"], [0, 0.2, 0.4], statement_params={'a':'b'})

df = session.create_dataframe([[0.1, 0.5], [0.2, 0.6], [0.3, 0.7]], schema=["a", "b"])

df4 = df.stat.cov("a", "b")

df5 = df.stat.cov("a", "b", statement_params={'a':'b'})

df4 = df.stat.corr("a", "b")

df5 = df.stat.corr("a", "b", statement_params={'a':'b'})

df = session.create_dataframe([(1, 1), (1, 2), (2, 1), (2, 1), (2, 3), (3, 2), (3, 3)], schema=["key", "value"])

ct = df.stat.crosstab("key", "value")

ct2 = df.stat.crosstab("key", "value", statement_params={'a':'b'})

df = session.create_dataframe([("Bob", 17), ("Alice", 10), ("Nico", 8), ("Bob", 12)], schema=["name", "age"])

fractions = {"Bob": 0.5, "Nico": 1.0}

sample_df = df.stat.sample_by("name", fractions)

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df2 = df.stat.approx_quantile(["NUM"], [0.5])

df2

df3 = df.stat.approx_quantile(["NUM", "NUM"], [0.0, 0.2, 0.4], statement_params={"a": "b"})

df3

df = session.create_dataframe([[0.1, 0.5], [0.2, 0.6], [0.3, 0.7]], schema=["a", "b"])

df4 = df.stat.cov("a", "b")

df4

df5 = df.stat.cov("a", "b", statement_params={"a": "b"})

df5

df4 = df.stat.corr("a", "b")

df4

df5 = df.stat.corr("a", "b", statement_params={"a": "b"})

df5

df = session.create_dataframe([(1, 1), (1, 2), (2, 1), (2, 1), (2, 3), (3, 2), (3, 3)], schema=["key", "value"])

ct = df.stat.crosstab("key", "value")

ct2 = df.stat.crosstab("key", "value", statement_params={"a": "b"})

df = session.create_dataframe([("Bob", 17), ("Alice", 10), ("Nico", 8), ("Bob", 12)], schema=["name", "age"])

sample_df = df.stat.sample_by("name", {"Bob": 0.5}{"Nico": 1.0})

## EXPECTED ENCODED AST

<<<<<<< HEAD
CkMKQQoz4gswEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoiAggBEgQKAmRmGAEiAggBCmQKYgpTmglQCiSyDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgNOVU0SAggBGggAAAAAAADgPyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSBQoDZGYyGAIiAggCCggSBggDEgIIAhABGhESDwoNCgVmaW5hbBADGAkgFCIEEAEYFw==
CqUBCqIBCpIBmgmOAQoksgwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIDTlVNCiSyDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgNOVU0SAggBGhgAAAAAAAAAAJqZmZmZmck/mpmZmZmZ2T8iGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheKgYKAWESAWISBQoDZGYzGAQiAggECggSBggFEgIIBBABGhESDwoNCgVmaW5hbBADGAkgFCIEEAEYFw==
CqEDCp4DCo8D8gWLAwriAgrfAgpzygJwChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIo+gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBGamZmZmZm5PxIo+gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBEAAAAAAADgPwpzygJwChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIo+gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBGamZmZmZnJPxIo+gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBEzMzMzMzPjPwpzygJwChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIo+gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBEzMzMzMzPTPxIo+gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBFmZmZmZmbmPxIICgYKAWEKAWIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgQKAmRmGAYiAggGCnwKegprqgloCiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgFhEiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgFiGgIIBiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISBQoDZGY0GAciAggHCggSBggIEgIIBxABGhESDwoNCgVmaW5hbBADGAkgFCIEEAEYFw==
CoUBCoIBCnOqCXAKIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSAWESIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSAWIaAggGIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZCoGCgFhEgFiEgUKA2RmNRgJIgIICQoIEgYIChICCAkQARoREg8KDQoFZmluYWwQAxgJIBQiBBABGBc=
CnwKegprogloCiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEgFhEiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEgFiGgIIBiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYSBQoDZGY0GAsiAggLCggSBggMEgIICxABGhESDwoNCgVmaW5hbBADGAkgFCIEEAEYFw==
CoUBCoIBCnOiCXAKIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSAWESIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSAWIaAggGIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaCoGCgFhEgFiEgUKA2RmNRgNIgIIDQoIEgYIDhICCA0QARoREg8KDQoFZmluYWwQAxgJIBQiBBABGBc=
CpkGCpYGCocG8gWDBgrUBQrRBQpl0gxiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahABEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEAEKZdIMYgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoQARIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahACCmXSDGIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEAISIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoQAQpl0gxiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahACEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEAEKZdIMYgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoQAhIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahADCmXSDGIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEAMSIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoQAgpl0gxiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahADEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEAMSDgoMCgNrZXkKBXZhbHVlGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIECgJkZhgPIgIIDwqBAQp/CnGyCW4KJLIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSA2tleRImsgwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIFdmFsdWUaAggPIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIECgJjdBgQIgIIEAqLAQqIAQp5sgl2CiSyDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEgNrZXkSJrIMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4SBXZhbHVlGgIIDyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4qBgoBYRIBYhIFCgNjdDIYESICCBEK8gMK7wMK4APyBdwDCq4DCqsDCmjSDGUKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEiSyDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEgNCb2ISIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAQEQpq0gxnChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBImsgwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIFQWxpY2USIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAQCgpp0gxmChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIlsgwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIETmljbxIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBAICmjSDGUKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEiSyDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEgNCb2ISIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAQDBINCgsKBG5hbWUKA2FnZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHASBAoCZGYYEiICCBIKzAEKyQEKswG6Ca8BCiWyDCIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EgRuYW1lEgeCAgQKAggSGi8KJLIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQSA0JvYhEAAAAAAADgPxowCiWyDCIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EgROaWNvEQAAAAAAAPA/IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBILCglzYW1wbGVfZGYYEyICCBMQARoREg8KDQoFZmluYWwQAxgJIBQiBBABGBc=
=======
CkMKQQoz4gswEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoiAggBEgQKAmRmGAEiAggBCmQKYgpTmglQCiTaDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgNOVU0SAggBGggAAAAAAADgPyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSBQoDZGYyGAIiAggCCggSBggDEgIIAhABGhESDwoNCgVmaW5hbBADGAkgFCIEEAEYFw==
CqUBCqIBCpIBmgmOAQok2gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIDTlVNCiTaDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgNOVU0SAggBGhgAAAAAAAAAAJqZmZmZmck/mpmZmZmZ2T8iGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheKgYKAWESAWISBQoDZGYzGAQiAggECggSBggFEgIIBBABGhESDwoNCgVmaW5hbBADGAkgFCIEEAEYFw==
CqEDCp4DCo8D8gWLAwriAgrfAgpzygJwChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIo+gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBGamZmZmZm5PxIo+gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBEAAAAAAADgPwpzygJwChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIo+gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBGamZmZmZnJPxIo+gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBEzMzMzMzPjPwpzygJwChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIo+gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBEzMzMzMzPTPxIo+gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBFmZmZmZmbmPxIICgYKAWEKAWIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgQKAmRmGAYiAggGCnwKegprqgloCiLaDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgFhEiLaDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgFiGgIIBiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISBQoDZGY0GAciAggHCggSBggIEgIIBxABGhESDwoNCgVmaW5hbBADGAkgFCIEEAEYFw==
CoUBCoIBCnOqCXAKItoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSAWESItoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSAWIaAggGIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZCoGCgFhEgFiEgUKA2RmNRgJIgIICQoIEgYIChICCAkQARoREg8KDQoFZmluYWwQAxgJIBQiBBABGBc=
CnwKegprogloCiLaDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEgFhEiLaDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEgFiGgIIBiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYSBQoDZGY0GAsiAggLCggSBggMEgIICxABGhESDwoNCgVmaW5hbBADGAkgFCIEEAEYFw==
CoUBCoIBCnOiCXAKItoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSAWESItoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSAWIaAggGIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaCoGCgFhEgFiEgUKA2RmNRgNIgIIDQoIEgYIDhICCA0QARoREg8KDQoFZmluYWwQAxgJIBQiBBABGBc=
CpkGCpYGCocG8gWDBgrUBQrRBQpl+gxiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahABEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEAEKZfoMYgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoQARIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahACCmX6DGIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEAISIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoQAQpl+gxiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahACEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEAEKZfoMYgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoQAhIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahADCmX6DGIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEAMSIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoQAgpl+gxiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahADEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEAMSDgoMCgNrZXkKBXZhbHVlGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIECgJkZhgPIgIIDwqBAQp/CnGyCW4KJNoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSA2tleRIm2gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIFdmFsdWUaAggPIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIECgJjdBgQIgIIEAqLAQqIAQp5sgl2CiTaDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEgNrZXkSJtoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4SBXZhbHVlGgIIDyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4qBgoBYRIBYhIFCgNjdDIYESICCBEK8gMK7wMK4APyBdwDCq4DCqsDCmj6DGUKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEiTaDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEgNCb2ISIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAQEQpq+gxnChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIm2gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIFQWxpY2USIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAQCgpp+gxmChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIl2gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIETmljbxIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBAICmj6DGUKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEiTaDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEgNCb2ISIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAQDBINCgsKBG5hbWUKA2FnZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHASBAoCZGYYEiICCBIKzAEKyQEKswG6Ca8BCiXaDCIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EgRuYW1lEgeCAgQKAggSGi8KJNoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQSA0JvYhEAAAAAAADgPxowCiXaDCIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EgROaWNvEQAAAAAAAPA/IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBILCglzYW1wbGVfZGYYEyICCBMQARoREg8KDQoFZmluYWwQAxgJIBQiBBABGBc=
>>>>>>> 10efa4a6b (SNOW-1677859 Add table functions passthough dataframeAst)
