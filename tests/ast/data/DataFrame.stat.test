## TEST CASE

df = session.table(tables.table1)

df2 = df.stat.approx_quantile("NUM", [0.5])

df3 = df.stat.approx_quantile(["NUM", "NUM"], [0, 0.2, 0.4], statement_params={'a':'b'})

df = session.create_dataframe([[0.1, 0.5], [0.2, 0.6], [0.3, 0.7]], schema=["a", "b"])

df4 = df.stat.cov("a", "b")

df5 = df.stat.cov("a", "b", statement_params={'a':'b'})

df4 = df.stat.corr("a", "b")

df5 = df.stat.corr("a", "b", statement_params={'a':'b'})

df = session.create_dataframe([(1, 1), (1, 2), (2, 1), (2, 1), (2, 3), (3, 2), (3, 3)], schema=["key", "value"])

ct = df.stat.crosstab("key", "value")

ct2 = df.stat.crosstab("key", "value", statement_params={'a':'b'})

df = session.create_dataframe([("Bob", 17), ("Alice", 10), ("Nico", 8), ("Bob", 12)], schema=["name", "age"])

fractions = {"Bob": 0.5, "Nico": 1.0}

sample_df = df.stat.sample_by("name", fractions)

## EXPECTED UNPARSER OUTPUT

df = session.table("table1")

df2 = df.stat.approx_quantile(["NUM"], [0.5])

df2

df3 = df.stat.approx_quantile(["NUM", "NUM"], [0.0, 0.2, 0.4], statement_params={"a": "b"})

df3

df = session.create_dataframe([[0.1, 0.5], [0.2, 0.6], [0.3, 0.7]], schema=["a", "b"])

df4 = df.stat.cov("a", "b")

df4

df5 = df.stat.cov("a", "b", statement_params={"a": "b"})

df5

df4 = df.stat.corr("a", "b")

df4

df5 = df.stat.corr("a", "b", statement_params={"a": "b"})

df5

df = session.create_dataframe([(1, 1), (1, 2), (2, 1), (2, 1), (2, 3), (3, 2), (3, 3)], schema=["key", "value"])

ct = df.stat.crosstab("key", "value")

ct2 = df.stat.crosstab("key", "value", statement_params={"a": "b"})

df = session.create_dataframe([("Bob", 17), ("Alice", 10), ("Nico", 8), ("Bob", 12)], schema=["name", "age"])

sample_df = df.stat.sample_by("name", {"Bob": 0.5, "Nico": 1.0})

## EXPECTED ENCODED AST

Cj8KPQovggwsEgoKCAoGdGFibGUxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRiICCAESBAoCZGYYASICCAEKZApiClOiCVAKJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEgSA05VTRICCAEaCAAAAAAAAOA/IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSBIFCgNkZjIYAiICCAIKCBIGCAMSAggCEAEaERIPCg0KBWZpbmFsEAMYCSAUIgQQARgX
CqUBCqIBCpIBogmOAQok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoShIDTlVNCiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShKEgNOVU0SAggBGhgAAAAAAAAAAJqZmZmZmck/mpmZmZmZ2T8iGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShKKgYKAWESAWISBQoDZGYzGAQiAggECggSBggFEgIIBBABGhESDwoNCgVmaW5hbBADGAkgFCIEEAEYFw==
CqEDCp4DCo8D+gWLAwriAgrfAgpz0gJwChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBIoggIlChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBGamZmZmZm5PxIoggIlChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBEAAAAAAADgPwpz0gJwChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBIoggIlChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBGamZmZmZnJPxIoggIlChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBEzMzMzMzPjPwpz0gJwChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBIoggIlChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBEzMzMzMzPTPxIoggIlChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBFmZmZmZmbmPxIICgYKAWEKAWIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShMEgQKAmRmGAYiAggGCnwKegprsgloCiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShOEgFhEiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShOEgFiGgIIBiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE4SBQoDZGY0GAciAggHCggSBggIEgIIBxABGhESDwoNCgVmaW5hbBADGAkgFCIEEAEYFw==
CoUBCoIBCnOyCXAKIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFASAWESIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFASAWIaAggGIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUCoGCgFhEgFiEgUKA2RmNRgJIgIICQoIEgYIChICCAkQARoREg8KDQoFZmluYWwQAxgJIBQiBBABGBc=
CnwKegprqgloCiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShSEgFhEiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShSEgFiGgIIBiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFISBQoDZGY0GAsiAggLCggSBggMEgIICxABGhESDwoNCgVmaW5hbBADGAkgFCIEEAEYFw==
CoUBCoIBCnOqCXAKIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFQSAWESIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFQSAWIaAggGIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVCoGCgFhEgFiEgUKA2RmNRgNIgIIDQoIEgYIDhICCA0QARoREg8KDQoFZmluYWwQAxgJIBQiBBABGBc=
CpkGCpYGCocG+gWDBgrUBQrRBQplmg1iChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVhIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVhABEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShWEAEKZZoNYgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYSIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYQARIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVhACCmWaDWIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShWEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShWEAISIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYQAQplmg1iChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVhIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVhACEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShWEAEKZZoNYgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYSIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYQAhIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVhADCmWaDWIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShWEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShWEAMSIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYQAgplmg1iChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVhIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVhADEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShWEAMSDgoMCgNrZXkKBXZhbHVlGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVhIECgJkZhgPIgIIDwqBAQp/CnG6CW4KJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgSA2tleRIm+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBIFdmFsdWUaAggPIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBIECgJjdBgQIgIIEAqLAQqIAQp5ugl2CiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgNrZXkSJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSBXZhbHVlGgIIDyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoqBgoBYRIBYhIFCgNjdDIYESICCBEK8gMK7wMK4AP6BdwDCq4DCqsDCmiaDWUKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgNCb2ISIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwQEQpqmg1nChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBIm+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBIFQWxpY2USIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwQCgppmg1mChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBIl+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBIETmljbxIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBAICmiaDWUKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgNCb2ISIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwQDBINCgsKBG5hbWUKA2FnZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSBAoCZGYYEiICCBIKzAEKyQEKswHCCa8BCiX6DCIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgRuYW1lEgeCAgQKAggSGi8KJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGASA0JvYhEAAAAAAADgPxowCiX6DCIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgROaWNvEQAAAAAAAPA/IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBILCglzYW1wbGVfZGYYEyICCBMQARoREg8KDQoFZmluYWwQAxgJIBQiBBABGBc=
