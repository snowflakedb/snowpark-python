## TEST CASE

df = session.table("test_table")

df2 = df.stat.approx_quantile("NUM", [0.5])

df3 = df.stat.approx_quantile(["NUM", "NUM"], [0, 0.2, 0.4], statement_params={'a':'b'})

df = session.create_dataframe([[0.1, 0.5], [0.2, 0.6], [0.3, 0.7]], schema=["a", "b"])

df4 = df.stat.cov("a", "b")

df5 = df.stat.cov("a", "b", statement_params={'a':'b'})

df4 = df.stat.corr("a", "b")

df5 = df.stat.corr("a", "b", statement_params={'a':'b'})

df = session.create_dataframe([(1, 1), (1, 2), (2, 1), (2, 1), (2, 3), (3, 2), (3, 3)], schema=["key", "value"])

ct = df.stat.crosstab("key", "value")

ct2 = df.stat.crosstab("key", "value", statement_params={'a':'b'})

df = session.create_dataframe([("Bob", 17), ("Alice", 10), ("Nico", 8), ("Bob", 12)], schema=["name", "age"])

fractions = {"Bob": 0.5, "Nico": 1.0}

sample_df = df.stat.sample_by("name", fractions)

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df2 = df.stat.approx_quantile(["NUM"], [0.5])

df2

df3 = df.stat.approx_quantile(["NUM", "NUM"], [0.0, 0.2, 0.4], statement_params={"a": "b"})

df3

df = session.create_dataframe([[0.1, 0.5], [0.2, 0.6], [0.3, 0.7]], schema=["a", "b"])

df4 = df.stat.cov("a", "b")

df4

df5 = df.stat.cov("a", "b", statement_params={"a": "b"})

df5

df4 = df.stat.corr("a", "b")

df4

df5 = df.stat.corr("a", "b", statement_params={"a": "b"})

df5

df = session.create_dataframe([(1, 1), (1, 2), (2, 1), (2, 1), (2, 3), (3, 2), (3, 3)], schema=["key", "value"])

ct = df.stat.crosstab("key", "value")

ct2 = df.stat.crosstab("key", "value", statement_params={"a": "b"})

df = session.create_dataframe([("Bob", 17), ("Alice", 10), ("Nico", 8), ("Bob", 12)], schema=["name", "age"])

sample_df = df.stat.sample_by("name", {"Bob": 0.5}{"Nico": 1.0})

## EXPECTED ENCODED AST

CkkKRwo52gs2Eg4KDAoKdGVzdF90YWJsZRogCCgQWhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKFoiAggBEgQKAmRmGAEiAggBCnAKbgpfmglcCiqaDCcKIAgzEFwaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDihcEgNOVU0SAggBGggAAAAAAADgPyIgCDMQXBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAOKFwSBQoDZGYyGAIiAggCCggSBggDEgIIAhABGhESDwoNCgVmaW5hbBADGAsgCSIEEAEYFQ==
CrcBCrQBCqQBmgmgAQoqmgwnCiAIYBBeGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oXhIDTlVNCiqaDCcKIAhgEF4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgDiheEgNOVU0SAggBGhgAAAAAAAAAAJqZmZmZmck/mpmZmZmZ2T8iIAhgEF4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgDiheKgYKAWESAWISBQoDZGYzGAQiAggECggSBggFEgIIBBABGhESDwoNCgVmaW5hbBADGAsgCSIEEAEYFQ==
CuMDCuADCtED8gXNAwqeAwqbAwqGAcICggEKIAheEGAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShgEi7yASsKIAheEGAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShgEZqZmZmZmbk/Ei7yASsKIAheEGAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShgEQAAAAAAAOA/CoYBwgKCAQogCF4QYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKGASLvIBKwogCF4QYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKGARmpmZmZmZyT8SLvIBKwogCF4QYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKGARMzMzMzMz4z8KhgHCAoIBCiAIXhBgGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oYBIu8gErCiAIXhBgGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oYBEzMzMzMzPTPxIu8gErCiAIXhBgGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oYBFmZmZmZmbmPxIICgYKAWEKAWIaIAheEGAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShgEgQKAmRmGAYiAggGCo8BCowBCn2qCXoKKJoMJQogCCMQYhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAOKGISAWESKJoMJQogCCMQYhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAOKGISAWIaAggGIiAIIxBiGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oYhIFCgNkZjQYByICCAcKCBIGCAgSAggHEAEaERIPCg0KBWZpbmFsEAMYCyAJIgQQARgV
CpkBCpYBCoYBqgmCAQoomgwlCiAIPxBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oZBIBYRIomgwlCiAIPxBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oZBIBYhoCCAYiIAg/EGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDihkKgYKAWESAWISBQoDZGY1GAkiAggJCggSBggKEgIICRABGhESDwoNCgVmaW5hbBADGAsgCSIEEAEYFQ==
Co8BCowBCn2iCXoKKJoMJQogCCQQZhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAOKGYSAWESKJoMJQogCCQQZhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAOKGYSAWIaAggGIiAIJBBmGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oZhIFCgNkZjQYCyICCAsKCBIGCAwSAggLEAEaERIPCg0KBWZpbmFsEAMYCyAJIgQQARgV
CpkBCpYBCoYBogmCAQoomgwlCiAIQBBoGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oaBIBYRIomgwlCiAIQBBoGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oaBIBYhoCCAYiIAhAEGgaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDihoKgYKAWESAWISBQoDZGY1GA0iAggNCggSBggOEgIIDRABGhESDwoNCgVmaW5hbBADGAsgCSIEEAEYFQ==
Cp0HCpoHCosH8gWHBwrSBgrPBgp3wgx0CiAIeBBqGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oahInsgIkCiAIeBBqGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oahABEieyAiQKIAh4EGoaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShqEAEKd8IMdAogCHgQahoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKGoSJ7ICJAogCHgQahoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKGoQARInsgIkCiAIeBBqGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oahACCnfCDHQKIAh4EGoaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShqEieyAiQKIAh4EGoaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShqEAISJ7ICJAogCHgQahoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKGoQAQp3wgx0CiAIeBBqGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oahInsgIkCiAIeBBqGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oahACEieyAiQKIAh4EGoaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShqEAEKd8IMdAogCHgQahoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKGoSJ7ICJAogCHgQahoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKGoQAhInsgIkCiAIeBBqGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oahADCnfCDHQKIAh4EGoaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShqEieyAiQKIAh4EGoaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShqEAMSJ7ICJAogCHgQahoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKGoQAgp3wgx0CiAIeBBqGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oahInsgIkCiAIeBBqGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oahADEieyAiQKIAh4EGoaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShqEAMSDgoMCgNrZXkKBXZhbHVlGiAIeBBqGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oahIECgJkZhgPIgIIDwqWAQqTAQqEAbIJgAEKKpoMJwogCC0QbBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKGwSA2tleRIsmgwpCiAILRBsGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0obBIFdmFsdWUaAggPIiAILRBsGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0obBIECgJjdBgQIgIIEAqfAQqcAQqMAbIJiAEKKpoMJwogCEoQbhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAOKG4SA2tleRIsmgwpCiAIShBuGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4obhIFdmFsdWUaAggPIiAIShBuGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4obioGCgFhEgFiEgUKA2N0MhgRIgIIEQrABAq9BAquBPIFqgQK9gMK8wMKesIMdwogCHUQcBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKHASKpoMJwogCHUQcBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKHASA0JvYhInsgIkCiAIdRBwGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0ocBARCnzCDHkKIAh1EHAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShwEiyaDCkKIAh1EHAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShwEgVBbGljZRInsgIkCiAIdRBwGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0ocBAKCnvCDHgKIAh1EHAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShwEiuaDCgKIAh1EHAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShwEgROaWNvEieyAiQKIAh1EHAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShwEAgKesIMdwogCHUQcBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKHASKpoMJwogCHUQcBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKHASA0JvYhInsgIkCiAIdRBwGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0ocBAMEg0KCwoEbmFtZQoDYWdlGiAIdRBwGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0ocBIECgJkZhgSIgIIEgrkAQrhAQrLAboJxwEKK5oMKAogCDgQdBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAUKHQSBG5hbWUSB4ICBAoCCBIaNQoqmgwnCiAIOBB0GhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBQodBIDQm9iEQAAAAAAAOA/GjYKK5oMKAogCDgQdBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAUKHQSBE5pY28RAAAAAAAA8D8iIAg4EHQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFCh0EgsKCXNhbXBsZV9kZhgTIgIIExABGhESDwoNCgVmaW5hbBADGAsgCSIEEAEYFQ==
