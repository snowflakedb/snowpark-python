## TEST CASE

df = session.table("test_table")

df2 = df.stat.approx_quantile("NUM", [0.5])

df3 = df.stat.approx_quantile(["NUM", "NUM"], [0, 0.2, 0.4], statement_params={'a':'b'})

df = session.create_dataframe([[0.1, 0.5], [0.2, 0.6], [0.3, 0.7]], schema=["a", "b"])

df4 = df.stat.cov("a", "b")

df5 = df.stat.cov("a", "b", statement_params={'a':'b'})

df4 = df.stat.corr("a", "b")

df5 = df.stat.corr("a", "b", statement_params={'a':'b'})

df = session.create_dataframe([(1, 1), (1, 2), (2, 1), (2, 1), (2, 3), (3, 2), (3, 3)], schema=["key", "value"])

ct = df.stat.crosstab("key", "value")

ct2 = df.stat.crosstab("key", "value", statement_params={'a':'b'})

df = session.create_dataframe([("Bob", 17), ("Alice", 10), ("Nico", 8), ("Bob", 12)], schema=["name", "age"])

fractions = {"Bob": 0.5, "Nico": 1.0}

sample_df = df.stat.sample_by("name", fractions)

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df2 = df.stat.approx_quantile(["NUM"], [0.5])

df2

df3 = df.stat.approx_quantile(["NUM", "NUM"], [0.0, 0.2, 0.4], statement_params={"a": "b"})

df3

df = session.create_dataframe([[0.1, 0.5], [0.2, 0.6], [0.3, 0.7]], schema=["a", "b"])

df4 = df.stat.cov("a", "b")

df4

df5 = df.stat.cov("a", "b", statement_params={"a": "b"})

df5

df4 = df.stat.corr("a", "b")

df4

df5 = df.stat.corr("a", "b", statement_params={"a": "b"})

df5

df = session.create_dataframe([(1, 1), (1, 2), (2, 1), (2, 1), (2, 3), (3, 2), (3, 3)], schema=["key", "value"])

ct = df.stat.crosstab("key", "value")

ct2 = df.stat.crosstab("key", "value", statement_params={"a": "b"})

df = session.create_dataframe([("Bob", 17), ("Alice", 10), ("Nico", 8), ("Bob", 12)], schema=["name", "age"])

sample_df = df.stat.sample_by("name", {"Bob": 0.5}{"Nico": 1.0})

## EXPECTED ENCODED AST

CkMKQQozogswEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoiAggBEgQKAmRmGAEiAggBCmQKYgpTgglQCiTqCyEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgNOVU0SAggBGggAAAAAAADgPyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSBQoDZGYyGAIiAggCCggSBggDEgIIAhABGhESDwoNCgVmaW5hbBADGAggEyIEEAEYFQ==
CqUBCqIBCpIBggmOAQok6gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIDTlVNCiTqCyEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgNOVU0SAggBGhgAAAAAAAAAAJqZmZmZmck/mpmZmZmZ2T8iGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheKgYKAWESAWISBQoDZGYzGAQiAggECggSBggFEgIIBBABGhESDwoNCgVmaW5hbBADGAggEyIEEAEYFQ==
CqEDCp4DCo8DygWLAwriAgrfAgpzogJwChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIo4gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBGamZmZmZm5PxIo4gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBEAAAAAAADgPwpzogJwChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIo4gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBGamZmZmZnJPxIo4gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBEzMzMzMzPjPwpzogJwChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIo4gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBEzMzMzMzPTPxIo4gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBFmZmZmZmbmPxIICgYKAWEKAWIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgQKAmRmGAYiAggGCnwKegprkgloCiLqCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgFhEiLqCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgFiGgIIBiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISBQoDZGY0GAciAggHCggSBggIEgIIBxABGhESDwoNCgVmaW5hbBADGAggEyIEEAEYFQ==
CoUBCoIBCnOSCXAKIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSAWESIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSAWIaAggGIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZCoGCgFhEgFiEgUKA2RmNRgJIgIICQoIEgYIChICCAkQARoREg8KDQoFZmluYWwQAxgIIBMiBBABGBU=
CnwKegprigloCiLqCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEgFhEiLqCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEgFiGgIIBiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYSBQoDZGY0GAsiAggLCggSBggMEgIICxABGhESDwoNCgVmaW5hbBADGAggEyIEEAEYFQ==
CoUBCoIBCnOKCXAKIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSAWESIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSAWIaAggGIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaCoGCgFhEgFiEgUKA2RmNRgNIgIIDQoIEgYIDhICCA0QARoREg8KDQoFZmluYWwQAxgIIBMiBBABGBU=
CpkGCpYGCocGygWDBgrUBQrRBQplkgxiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIhkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahABEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEAEKZZIMYgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoQARIhkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahACCmWSDGIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEAISIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoQAQplkgxiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIhkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahACEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEAEKZZIMYgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoQAhIhkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahADCmWSDGIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEAMSIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoQAgplkgxiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIhkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahADEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEAMSDgoMCgNrZXkKBXZhbHVlGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIECgJkZhgPIgIIDwqBAQp/CnGaCW4KJOoLIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSA2tleRIm6gsjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIFdmFsdWUaAggPIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIECgJjdBgQIgIIEAqLAQqIAQp5mgl2CiTqCyEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEgNrZXkSJuoLIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4SBXZhbHVlGgIIDyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4qBgoBYRIBYhIFCgNjdDIYESICCBEK8gMK7wMK4APKBdwDCq4DCqsDCmiSDGUKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEiTqCyEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEgNCb2ISIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAQEQpqkgxnChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIm6gsjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIFQWxpY2USIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAQCgppkgxmChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIl6gsiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIETmljbxIhkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBAICmiSDGUKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEiTqCyEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEgNCb2ISIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAQDBINCgsKBG5hbWUKA2FnZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHASBAoCZGYYEiICCBIKzAEKyQEKswGiCa8BCiXqCyIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EgRuYW1lEgeKAgQKAggSGi8KJOoLIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQSA0JvYhEAAAAAAADgPxowCiXqCyIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EgROaWNvEQAAAAAAAPA/IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBILCglzYW1wbGVfZGYYEyICCBMQARoREg8KDQoFZmluYWwQAxgIIBMiBBABGBU=
