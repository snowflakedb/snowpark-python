## TEST CASE

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan() , "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

# TODO: SNOW-1546550 fix multiple otherwise calls.
df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(
    when(col("a") == 1, "one")
    .otherwise("other_one")
    .when(col("a") == 2, "two")
    .otherwise("other_two")
    .when(col("a") == 3, "three")
    .otherwise("other_three")
    .when(col("a") == 4, "four")
    .otherwise("other_four")
    .when(col("a") == 5, "five")
    .otherwise("other_five")
)

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan(), "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(when(col("a") == 1, "one").otherwise("other_one").when(col("a") == 2, "two").otherwise("other_two").when(col("a") == 3, "three").otherwise("other_three").when(col("a") == 4, "four").otherwise("other_four").when(col("a") == 5, "five").otherwise("other_five"))

## EXPECTED ENCODED AST

CkMKQQozogswEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFQiAggBEgQKAmRmGB0iAggdCpoCCpcCCogC4giEAgraAZoE1gEKtwEKcnpwCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYaKeoLJgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYSCGJvb2xfY29sIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYaJeoLIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYSBHRydWUSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShWEgeKAgQKAggdGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoViABEgQKAmRmGB4iAggeCpYFCpMFCoQF4giABQrWBJoE0gQK9QEKsAHaAawBCmt6aQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYGiLqCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEgFBIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBIhkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBABGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgaJOoLIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgSA29uZQr1AQqwAZoCrAEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgaIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgSAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBok6gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBIDdHdvCkQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYGibqCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEgVvdGhlchIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgSB4oCBAoCCB4aGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYIAESBAoCZGYYHyICCB8KzgQKywQKvATiCLgECo4EmgSKBArfAgrTAZIEzwEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoaIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaECUaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaIiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaECoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaGmt6aQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaGiLqCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgFCIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWgqJARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoaa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoaIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSAUMiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIHigIECgIIHxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFogARIECgJkZhggIgIIIAr7Agr4AgrpAuII5QIKuwKaBLcCCtIBCo0BsgSJAQpremkKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBoi6gsfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBIBQSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBok6gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBIDb25lCkQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcGibqCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgVvdGhlchIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSB4oCBAoCCCAaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcIAESBAoCZGYYISICCCEKxAYKwQYKsgbiCK4GCoQGmgSABgqYAgqNAdoEiQEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aanpoCicKJQoHCgUKA2xpdBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4QASIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4KuwIKsAHaAawBCmt6aQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheGiLqCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIhkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhABGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aanpoCicKJQoHCgUKA2xpdBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4QAiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4KiAESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheGmp6aAonCiUKBwoFCgNsaXQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheGiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEAMiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIHigIECgIIIRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4gARIECgJkZhgiIgIIIgqbBQqYBQqJBeIIhQUK2wSaBNcECvgBCrMBigWvAQpremkKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYRoi6gsfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYRIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGESJOoLIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGESA2ZvbxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShhGiTqCyEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShhEgNmb28KQxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGEaJeoLIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGESBG51bGwK+AEKswGKBa8BCmt6aQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShhGiLqCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShhEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYRIk6gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYRIDYmFyGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGEaJOoLIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGESA2JhchIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGESB4oCBAoCCCIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShhIAESBAoCZGYYIyICCCMK6AMK5QMK1gPiCNIDCqgDmgSkAwq/Agr5AXL2AQpremkKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYxoi6gsfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYxIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGMSa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGMaIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGMSAWIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShjGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGMaJeoLIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGMSBGJvdGgKRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGMaJuoLIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGMSBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYxIHigIECgIIIxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGMgARIECgJkZhgkIgIIJAqyDQqvDQqgDeIInA0K8gyaBO4MCvUBCrAB2gGsAQpremkKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhoi6gsfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYSIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYQARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmGiTqCyEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEgNvbmUKSBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYaKuoLJwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYSCW90aGVyX29uZQr1AQqwAdoBrAEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgaIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoEAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhok6gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIDdHdvCkgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmGirqCycKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEglvdGhlcl90d28K9wEKsAHaAawBCmt6aQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqGiLqCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIhkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahADGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYaJuoLIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYSBXRocmVlCkoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmGizqCykKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEgtvdGhlcl90aHJlZQr2AQqwAdoBrAEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEAQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhol6gsiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIEZm91cgpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhor6gsoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIKb3RoZXJfZm91cgr2AQqwAdoBrAEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4aIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4SAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEAUaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhol6gsiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIEZml2ZQpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhor6gsoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIKb3RoZXJfZml2ZRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYSB4oCBAoCCCQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShlIAESBAoCZGYYJSICCCUQARoREg8KDQoFZmluYWwQAxgJIBMiBBABGBU=
