## TEST CASE

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan() , "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

# TODO: SNOW-1546550 fix multiple otherwise calls.
df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(
    when(col("a") == 1, "one")
    .otherwise("other_one")
    .when(col("a") == 2, "two")
    .otherwise("other_two")
    .when(col("a") == 3, "three")
    .otherwise("other_three")
    .when(col("a") == 4, "four")
    .otherwise("other_four")
    .when(col("a") == 5, "five")
    .otherwise("other_five")
)

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan(), "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(when(col("a") == 1, "one").otherwise("other_one").when(col("a") == 2, "two").otherwise("other_two").when(col("a") == 3, "three").otherwise("other_three").when(col("a") == 4, "four").otherwise("other_four").when(col("a") == 5, "five").otherwise("other_five"))

## EXPECTED ENCODED AST

CkMKQQoz4gswEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoiAggBEgQKAmRmGAEiAggBCv8BCvwBCu0B+gjpAQq/AcIEuwEKnAEKV4oBVAoLGgkKBwoFCgNjb2waKbIMJgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSCGJvb2xfY29sIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwaJbIMIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSBHRydWUSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgeCAgQKAggBGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXCABEgQKAmRmGAIiAggCCuAECt0ECs4E+gjKBAqgBMIEnAQK2gEKlQHyAZEBClCKAU0KCxoJCgcKBQoDY29sGiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgFBIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhABGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aJLIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SA29uZQraAQqVAcICkQEKUIoBTQoLGgkKBwoFCgNjb2waIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhoksgwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIDdHdvCkQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheGiayDCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgVvdGhlchIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheIAESBAoCZGYYAyICCAMK/AMK+QMK6gP6COYDCrwDwgS4AwqpAgq4AboEtAEKUIoBTQoLGgkKBwoFCgNjb2waIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGASAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgECUaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgIiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgECoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgGlCKAU0KCxoJCgcKBQoDY29sGiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgFCIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYApuEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBpQigFNCgsaCQoHCgUKA2NvbBoisgwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIBQyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGASGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgeCAgQKAggDGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYCABEgQKAmRmGAQiAggECt4CCtsCCswC+gjIAgqeAsIEmgIKtQEKcdoEbgpQigFNCgsaCQoHCgUKA2NvbBoisgwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIBQSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhoksgwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIDb25lCkQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiGiayDCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgVvdGhlchIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISB4ICBAoCCAQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiIAESBAoCZGYYBSICCAUKugUKtwUKqAX6CKQFCvoEwgT2BArgAQpxggVuClCKAU0KCxoJCgcKBQoDY29sGiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGk+KAUwKCxoJCgcKBQoDbGl0GiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEAEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkCoUCCpUB8gGRAQpQigFNCgsaCQoHCgUKA2NvbBoisgwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQQARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGk+KAUwKCxoJCgcKBQoDbGl0GiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEAIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkCm0SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGk+KAUwKCxoJCgcKBQoDbGl0GiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEAMiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIHggIECgIIBRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQgARIECgJkZhgGIgIIBgrlBAriBArTBPoIzwQKpQTCBKEECt0BCpgBsgWUAQpQigFNCgsaCQoHCgUKA2NvbBoisgwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSJLIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSA2ZvbxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnGiSyDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgNmb28KQxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcaJbIMIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSBG51bGwK3QEKmAGyBZQBClCKAU0KCxoJCgcKBQoDY29sGiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIksgwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIDYmFyGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcaJLIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSA2JhchIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSB4ICBAoCCAYaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnIAESBAoCZGYYByICCAcKswMKsAMKoQP6CJ0DCvMCwgTvAgqKAgrEAYIBwAEKUIoBTQoLGgkKBwoFCgNjb2waIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShpElCKAU0KCxoJCgcKBQoDY29sGiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShpEgFiIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShpGiWyDCIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShpEgRib3RoCkQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShpGiayDCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShpEgVvdGhlchIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSB4ICBAoCCAcaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShpIAESBAoCZGYYCCICCAgKqwwKqAwKmQz6CJUMCusLwgTnCwraAQqVAfIBkQEKUIoBTQoLGgkKBwoFCgNjb2waIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBoksgwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIDb25lCkgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsGiqyDCcKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEglvdGhlcl9vbmUK2gEKlQHyAZEBClCKAU0KCxoJCgcKBQoDY29sGiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhACGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaJLIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSA3R3bwpIEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBoqsgwnChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIJb3RoZXJfdHdvCtwBCpUB8gGRAQpQigFNCgsaCQoHCgUKA2NvbBoisgwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHASIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAQAxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHASGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsGiayDCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEgV0aHJlZQpKEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBossgwpChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBILb3RoZXJfdGhyZWUK2wEKlQHyAZEBClCKAU0KCxoJCgcKBQoDY29sGiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUochIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUochAEGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUochIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaJbIMIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSBGZvdXIKSRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaK7IMKAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSCm90aGVyX2ZvdXIK2wEKlQHyAZEBClCKAU0KCxoJCgcKBQoDY29sGiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBAFGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaJbIMIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSBGZpdmUKSRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaK7IMKAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSCm90aGVyX2ZpdmUSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEgeCAgQKAggIGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoayABEgQKAmRmGAkiAggJEAEaERIPCg0KBWZpbmFsEAMYCSASIgYQARgWIAE=
