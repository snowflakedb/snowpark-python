## TEST CASE

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan() , "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

# TODO: SNOW-1546550 fix multiple otherwise calls.
df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(
    when(col("a") == 1, "one")
    .otherwise("other_one")
    .when(col("a") == 2, "two")
    .otherwise("other_two")
    .when(col("a") == 3, "three")
    .otherwise("other_three")
    .when(col("a") == 4, "four")
    .otherwise("other_four")
    .when(col("a") == 5, "five")
    .otherwise("other_five")
)

## EXPECTED UNPARSER OUTPUT



## EXPECTED ENCODED AST

CkMKQQozwgswEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoiAggBEgQKAmRmGAEiAggBCpsCCpgCCokC+giFAgrbAcIE1wEKuAEKc4oBcAonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcGimCDCYKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEghib29sX2NvbCIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcGiWCDCIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgR0cnVlEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBIHggIECgIIARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwgARIECgJkZhgCIgIIAgqYBQqVBQqGBfoIggUK2ATCBNQECvYBCrEB6gGtAQpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aIoIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEiGyAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhokggwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIDb25lCvYBCrEBugKtAQpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aIoIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEiGyAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhokggwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIDdHdvCkQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheGiaCDCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgVvdGhlchIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheIAESBAoCZGYYAyICCAMK0QQKzgQKvwT6CLsECpEEwgSNBArhAgrUAboE0AEKbIoBaQonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgGiKCDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgFBIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIhsgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBAlGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYCIhsgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBAqEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAaIoIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGASAUIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgCooBEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAaIoIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGASAUMiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIHggIECgIIAxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAgARIECgJkZhgEIgIIBAr8Agr5AgrqAvoI5gIKvALCBLgCCtMBCo4B2gSKAQpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGIaIoIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGIaJIIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISA29uZQpEEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhomggwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIFb3RoZXISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgeCAgQKAggEGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYiABEgQKAmRmGAUiAggFCskGCsYGCrcG+gizBgqJBsIEhQYKmgIKjgGCBYoBCmyKAWkKJxolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBoiggwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBprigFoCicaJQoHCgUKA2xpdBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaIbICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQQASIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQKvQIKsQHqAa0BCmyKAWkKJxolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBoiggwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSIbICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQQARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGmuKAWgKJxolCgcKBQoDbGl0EhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBohsgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBACIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZAqJARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaa4oBaAonGiUKBwoFCgNsaXQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGiGyAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEAMiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIHggIECgIIBRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQgARIECgJkZhgGIgIIBgqdBQqaBQqLBfoIhwUK3QTCBNkECvkBCrQBsgWwAQpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcaIoIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEiSCDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgNmb28aGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxokggwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIDZm9vCkMSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnGiWCDCIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgRudWxsCvkBCrQBsgWwAQpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcaIoIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEiSCDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgNiYXIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxokggwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIDYmFyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIHggIECgIIBhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcgARIECgJkZhgHIgIIBwrrAwroAwrZA/oI1QMKqwPCBKcDCsICCvwBggH4AQpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkaIoIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShpEmyKAWkKJxolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRoiggwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIBYiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShpEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRolggwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIEYm90aApEEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRomggwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIFb3RoZXISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShpEgeCAgQKAggHGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaSABEgQKAmRmGAgiAggICrcNCrQNCqUN+gihDQr3DMIE8wwK9gEKsQHqAa0BCmyKAWkKJxolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBoiggwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSIbICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwQARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsGiSCDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEgNvbmUKSBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaKoIMJwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSCW90aGVyX29uZQr2AQqxAeoBrQEKbIoBaQonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuGiKCDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhIhsgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhACGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaJIIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSA3R3bwpIEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBoqggwnChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIJb3RoZXJfdHdvCvgBCrEB6gGtAQpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAaIoIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHASAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEiGyAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEAMaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBomggwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIFdGhyZWUKShIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaLIIMKQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSC290aGVyX3RocmVlCvcBCrEB6gGtAQpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHIaIoIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHISAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyEiGyAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyEAQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBolggwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIEZm91cgpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBorggwoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIKb3RoZXJfZm91cgr3AQqxAeoBrQEKbIoBaQonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0GiKCDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBIhsgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBAFGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaJYIMIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSBGZpdmUKSRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaK4IMKAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSCm90aGVyX2ZpdmUSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEgeCAgQKAggIGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoayABEgQKAmRmGAkiAggJEAEaERIPCg0KBWZpbmFsEAMYCSATIgQQARgV
