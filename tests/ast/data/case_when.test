## TEST CASE

df = session.table(tables.table1)

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan() , "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

# TODO: SNOW-1546550 fix multiple otherwise calls.
df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(
    when(col("a") == 1, "one")
    .otherwise("other_one")
    .when(col("a") == 2, "two")
    .otherwise("other_two")
    .when(col("a") == 3, "three")
    .otherwise("other_three")
    .when(col("a") == 4, "four")
    .otherwise("other_four")
    .when(col("a") == 5, "five")
    .otherwise("other_five")
)

## EXPECTED UNPARSER OUTPUT

df = session.table("table1")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan(), "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(when(col("a") == 1, "one").otherwise("other_one").when(col("a") == 2, "two").otherwise("other_two").when(col("a") == 3, "three").otherwise("other_three").when(col("a") == 4, "four").otherwise("other_four").when(col("a") == 5, "five").otherwise("other_five"))

## EXPECTED ENCODED AST

Cj8KPQovggwsEgoKCAoGdGFibGUxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoPyICCAESBAoCZGYYASICCAEK/wEK/AEK7QGCCekBCr8BygS7AQqcAQpXkgFUCgsaCQoHCgUKA2NvbBop+gwmChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoQRIIYm9vbF9jb2wiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShBEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoQRol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoQRIEdHJ1ZRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEESB4ICBAoCCAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShBIAESBAoCZGYYAiICCAIK4AQK3QQKzgSCCcoECqAEygScBAraAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEMSAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShDEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShDEAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShDEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoQxok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoQxIDb25lCtoBCpUBygKRAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoQxIBQSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEMSIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEMQAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEMSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShDGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShDEgN0d28KRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEMaJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEMSBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoQxIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEMgARIECgJkZhgDIgIIAwr8Awr5AwrqA4IJ5gMKvAPKBLgDCqkCCrgBwgS0AQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRRIBQSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEUSIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEUQJRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEUiIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEUQKhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEUaUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEUSAUIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShFCm4SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShFGlCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShFEgFDIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEUSB4ICBAoCCAMaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShFIAESBAoCZGYYBCICCAQK3gIK2wIKzAKCCcgCCp4CygSaAgq1AQpx4gRuClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShHEgFBIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShHGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShHEgNvbmUKRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEcaJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEcSBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRxIHggIECgIIBBoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEcgARIECgJkZhgFIgIIBQq6BQq3BQqoBYIJpAUK+gTKBPYECuABCnGKBW4KUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEkSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEkaT5IBTAoLGgkKBwoFCgNsaXQaIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEkQASIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEkKhQIKlQH6AZEBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShJEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSRIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSRABGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEkaT5IBTAoLGgkKBwoFCgNsaXQaIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEkQAiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEkKbRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEkaT5IBTAoLGgkKBwoFCgNsaXQaIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEkQAyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEkSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShJEgeCAgQKAggFGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSSABEgQKAmRmGAYiAggGCuUECuIECtMEggnPBAqlBMoEoQQK3QEKmAG6BZQBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShMEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBIk+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBIDZm9vGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEwaJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEwSA2ZvbwpDEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBIEbnVsbArdAQqYAboFlAEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEwSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShMEiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShMEgNiYXIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShMEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBIDYmFyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBIHggIECgIIBhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEwgARIECgJkZhgHIgIIBwqzAwqwAwqhA4IJnQMK8wLKBO8CCooCCsQBigHAAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoThIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE4SUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE4SAWIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShOGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoThIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE4aJfoMIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE4SBGJvdGgKRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE4aJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE4SBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoThIHggIECgIIBxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE4gARIECgJkZhgIIgIICAqrDAqoDAqZDIIJlQwK6wvKBOcLCtoBCpUB+gGRAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoURIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFESIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFEQARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShRGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShREgNvbmUKSBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFEaKvoMJwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFESCW90aGVyX29uZQraAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFMSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShTEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShTEAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShTEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoURok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoURIDdHdvCkgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShRGir6DCcKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShREglvdGhlcl90d28K3AEKlQH6AZEBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShVEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVRIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVRADGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFEaJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFESBXRocmVlCkoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShRGiz6DCkKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShREgtvdGhlcl90aHJlZQrbAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFcSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShXEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShXEAQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShXEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoURol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoURIEZm91cgpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoURor+gwoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoURIKb3RoZXJfZm91cgrbAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFkSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShZEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShZEAUaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShZEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoURol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoURIEZml2ZQpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoURor+gwoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoURIKb3RoZXJfZml2ZRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFESB4ICBAoCCAgaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShQIAESBAoCZGYYCSICCAkQARoREg8KDQoFZmluYWwQAxgJIBQiBBABGBc=
