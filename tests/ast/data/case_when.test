## TEST CASE

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan() , "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

# TODO: SNOW-1546550 fix multiple otherwise calls.
df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(
    when(col("a") == 1, "one")
    .otherwise("other_one")
    .when(col("a") == 2, "two")
    .otherwise("other_two")
    .when(col("a") == 3, "three")
    .otherwise("other_three")
    .when(col("a") == 4, "four")
    .otherwise("other_four")
    .when(col("a") == 5, "five")
    .otherwise("other_five")
)

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan(), "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(when(col("a") == 1, "one").otherwise("other_one").when(col("a") == 2, "two").otherwise("other_two").when(col("a") == 3, "three").otherwise("other_three").when(col("a") == 4, "four").otherwise("other_four").when(col("a") == 5, "five").otherwise("other_five"))

## EXPECTED ENCODED AST

CkMKQQozsgswEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoiAggBEgQKAmRmGAEiAggBCpoCCpcCCogC6giEAgraAaIE1gEKtwEKcnpwCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwaKfoLJgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSCGJvb2xfY29sIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwaJfoLIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSBHRydWUSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgeSAgQKAggBGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXCABEgQKAmRmGAIiAggCCpYFCpMFCoQF6giABQrWBKIE0gQK9QEKsAHaAawBCmt6aQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheGiL6Cx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgFBIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIhkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhABGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aJPoLIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SA29uZQr1AQqwAZoCrAEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aIvoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhok+gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIDdHdvCkQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheGib6CyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgVvdGhlchIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SB5ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheIAESBAoCZGYYAyICCAMKzgQKywQKvATqCLgECo4EogSKBArfAgrTAZoEzwEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAaIvoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGASAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgECUaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgIiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgECoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgGmt6aQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgGiL6Cx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgFCIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYAqJARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAaa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAaIvoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGASAUMiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIHkgIECgIIAxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAgARIECgJkZhgEIgIIBAr7Agr4AgrpAuoI5QIKuwKiBLcCCtIBCo0BugSJAQpremkKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhoi+gsfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIBQSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhok+gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIDb25lCkQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiGib6CyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgVvdGhlchIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISB5ICBAoCCAQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiIAESBAoCZGYYBSICCAUKxAYKwQYKsgbqCK4GCoQGogSABgqYAgqNAeIEiQEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaIvoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaanpoCicKJQoHCgUKA2xpdBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQQASIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQKuwIKsAHaAawBCmt6aQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGiL6Cx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIhkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBABGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaanpoCicKJQoHCgUKA2xpdBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQQAiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQKiAESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGmp6aAonCiUKBwoFCgNsaXQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEAMiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIHkgIECgIIBRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQgARIECgJkZhgGIgIIBgqbBQqYBQqJBeoIhQUK2wSiBNcECvgBCrMBkgWvAQpremkKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxoi+gsfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSJPoLIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSA2ZvbxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnGiT6CyEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgNmb28KQxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcaJfoLIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSBG51bGwK+AEKswGSBa8BCmt6aQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnGiL6Cx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIk+gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIDYmFyGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcaJPoLIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSA2JhchIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSB5ICBAoCCAYaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnIAESBAoCZGYYByICCAcK6AMK5QMK1gPqCNIDCqgDogSkAwq/Agr5AXL2AQpremkKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRoi+gsfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkaIvoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSAWIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShpGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkaJfoLIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSBGJvdGgKRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkaJvoLIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIHkgIECgIIBxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkgARIECgJkZhgIIgIICAqyDQqvDQqgDeoInA0K8gyiBO4MCvUBCrAB2gGsAQpremkKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBoi+gsfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwQARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsGiT6CyEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEgNvbmUKSBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaKvoLJwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSCW90aGVyX29uZQr1AQqwAdoBrAEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4aIvoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4SAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBok+gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIDdHdvCkgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsGir6CycKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEglvdGhlcl90d28K9wEKsAHaAawBCmt6aQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwGiL6Cx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIhkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBADGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaJvoLIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSBXRocmVlCkoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsGiz6CykKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEgtvdGhlcl90aHJlZQr2AQqwAdoBrAEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHIaIvoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHISAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyEAQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBol+gsiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIEZm91cgpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBor+gsoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIKb3RoZXJfZm91cgr2AQqwAdoBrAEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQaIvoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EAUaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBol+gsiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIEZml2ZQpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBor+gsoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIKb3RoZXJfZml2ZRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSB5ICBAoCCAgaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShrIAESBAoCZGYYCSICCAkQARoREg8KDQoFZmluYWwQAxgJIBMiBBABGBU=
