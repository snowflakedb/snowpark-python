## TEST CASE

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan() , "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

# TODO: SNOW-1546550 fix multiple otherwise calls.
df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(
    when(col("a") == 1, "one")
    .otherwise("other_one")
    .when(col("a") == 2, "two")
    .otherwise("other_two")
    .when(col("a") == 3, "three")
    .otherwise("other_three")
    .when(col("a") == 4, "four")
    .otherwise("other_four")
    .when(col("a") == 5, "five")
    .otherwise("other_five")
)

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan(), "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(when(col("a") == 1, "one").otherwise("other_one").when(col("a") == 2, "two").otherwise("other_two").when(col("a") == 3, "three").otherwise("other_three").when(col("a") == 4, "four").otherwise("other_four").when(col("a") == 5, "five").otherwise("other_five"))

## EXPECTED ENCODED AST

CkMKQQozogswEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoiAggBEgQKAmRmGAEiAggBCpoCCpcCCogC4giEAgraAZoE1gEKtwEKcnpwCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwaKeoLJgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSCGJvb2xfY29sIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwaJeoLIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSBHRydWUSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgeKAgQKAggBGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXCABEgQKAmRmGAIiAggCCpYFCpMFCoQF4giABQrWBJoE0gQK9QEKsAHaAawBCmt6aQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheGiLqCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgFBIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIhkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhABGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aJOoLIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SA29uZQr1AQqwAZoCrAEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhok6gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIDdHdvCkQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheGibqCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgVvdGhlchIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SB4oCBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheIAESBAoCZGYYAyICCAMKzgQKywQKvATiCLgECo4EmgSKBArfAgrTAZIEzwEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAaIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGASAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgECUaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgIiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgECoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgGmt6aQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgGiLqCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgFCIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYAqJARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAaa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAaIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGASAUMiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIHigIECgIIAxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAgARIECgJkZhgEIgIIBAr7Agr4AgrpAuII5QIKuwKaBLcCCtIBCo0BsgSJAQpremkKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhoi6gsfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIBQSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhok6gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIDb25lCkQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiGibqCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgVvdGhlchIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISB4oCBAoCCAQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiIAESBAoCZGYYBSICCAUKxAYKwQYKsgbiCK4GCoQGmgSABgqYAgqNAdoEiQEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaanpoCicKJQoHCgUKA2xpdBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQQASIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQKuwIKsAHaAawBCmt6aQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGiLqCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIhkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBABGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaanpoCicKJQoHCgUKA2xpdBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQQAiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQKiAESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGmp6aAonCiUKBwoFCgNsaXQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEAMiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIHigIECgIIBRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQgARIECgJkZhgGIgIIBgqbBQqYBQqJBeIIhQUK2wSaBNcECvgBCrMBigWvAQpremkKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxoi6gsfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSJOoLIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSA2ZvbxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnGiTqCyEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgNmb28KQxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcaJeoLIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSBG51bGwK+AEKswGKBa8BCmt6aQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnGiLqCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIk6gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIDYmFyGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcaJOoLIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSA2JhchIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSB4oCBAoCCAYaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnIAESBAoCZGYYByICCAcK6AMK5QMK1gPiCNIDCqgDmgSkAwq/Agr5AXL2AQpremkKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRoi6gsfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkaIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSAWIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShpGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkaJeoLIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSBGJvdGgKRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkaJuoLIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIHigIECgIIBxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkgARIECgJkZhgIIgIICAqyDQqvDQqgDeIInA0K8gyaBO4MCvUBCrAB2gGsAQpremkKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBoi6gsfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwQARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsGiTqCyEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEgNvbmUKSBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaKuoLJwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSCW90aGVyX29uZQr1AQqwAdoBrAEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4aIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4SAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBok6gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIDdHdvCkgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsGirqCycKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEglvdGhlcl90d28K9wEKsAHaAawBCmt6aQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwGiLqCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIhkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBADGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaJuoLIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSBXRocmVlCkoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsGizqCykKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEgtvdGhlcl90aHJlZQr2AQqwAdoBrAEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHIaIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHISAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyEAQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBol6gsiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIEZm91cgpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBor6gsoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIKb3RoZXJfZm91cgr2AQqwAdoBrAEKa3ppCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQaIuoLHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EAUaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBol6gsiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIEZml2ZQpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBor6gsoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIKb3RoZXJfZml2ZRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSB4oCBAoCCAgaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShrIAESBAoCZGYYCSICCAkQARoREg8KDQoFZmluYWwQAxgIIBMiBBABGBU=
