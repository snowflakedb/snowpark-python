## TEST CASE

df = session.table(tables.table1)

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan() , "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

# TODO: SNOW-1546550 fix multiple otherwise calls.
df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(
    when(col("a") == 1, "one")
    .otherwise("other_one")
    .when(col("a") == 2, "two")
    .otherwise("other_two")
    .when(col("a") == 3, "three")
    .otherwise("other_three")
    .when(col("a") == 4, "four")
    .otherwise("other_four")
    .when(col("a") == 5, "five")
    .otherwise("other_five")
)

## EXPECTED UNPARSER OUTPUT

df = session.table("table1")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan(), "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(when(col("a") == 1, "one").otherwise("other_one").when(col("a") == 2, "two").otherwise("other_two").when(col("a") == 3, "three").otherwise("other_three").when(col("a") == 4, "four").otherwise("other_four").when(col("a") == 5, "five").otherwise("other_five"))

## EXPECTED ENCODED AST

Cj8KPQovggwsEgoKCAoGdGFibGUxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUCICCAESBAoCZGYYASICCAEK/wEK/AEK7QGCCekBCr8BygS7AQqcAQpXkgFUCgsaCQoHCgUKA2NvbBop+gwmChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUhIIYm9vbF9jb2wiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShSEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUhol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUhIEdHJ1ZRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFISB4ICBAoCCAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShSIAESBAoCZGYYAiICCAIK4AQK3QQKzgSCCcoECqAEygScBAraAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFQSAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShUEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShUEAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShUEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVBok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVBIDb25lCtoBCpUBygKRAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVBIBQSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFQSIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFQQAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShUGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShUEgN0d28KRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFQaJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFQSBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVBIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFQgARIECgJkZhgDIgIIAwr8Awr5AwrqA4IJ5gMKvAPKBLgDCqkCCrgBwgS0AQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVhIBQSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYSIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYQJRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYiIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYQKhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYaUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYSAUIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShWCm4SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShWGlCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShWEgFDIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYSB4ICBAoCCAMaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShWIAESBAoCZGYYBCICCAQK3gIK2wIKzAKCCcgCCp4CygSaAgq1AQpx4gRuClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEgFBIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEgNvbmUKRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgaJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgSBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBIHggIECgIIBBoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFggARIECgJkZhgFIgIIBQq6BQq3BQqoBYIJpAUK+gTKBPYECuABCnGKBW4KUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoaT5IBTAoLGgkKBwoFCgNsaXQaIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQASIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoKhQIKlQH6AZEBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhABGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoaT5IBTAoLGgkKBwoFCgNsaXQaIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQAiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoKbRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoaT5IBTAoLGgkKBwoFCgNsaXQaIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQAyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgeCAgQKAggFGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWiABEgQKAmRmGAYiAggGCuUECuIECtMEggnPBAqlBMoEoQQK3QEKmAG6BZQBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShdEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXRIk+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXRIDZm9vGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF0aJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF0SA2ZvbwpDEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXRol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXRIEbnVsbArdAQqYAboFlAEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF0SAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShdEiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShdEgNiYXIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShdEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXRok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXRIDYmFyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXRIHggIECgIIBhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF0gARIECgJkZhgHIgIIBwqzAwqwAwqhA4IJnQMK8wLKBO8CCooCCsQBigHAAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXxIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF8SUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF8SAWIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShfGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF8aJfoMIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF8SBGJvdGgKRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF8aJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF8SBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXxIHggIECgIIBxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF8gARIECgJkZhgIIgIICAqrDAqoDAqZDIIJlQwK6wvKBOcLCtoBCpUB+gGRAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGIQARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgNvbmUKSBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGIaKvoMJwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISCW90aGVyX29uZQraAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIDdHdvCkgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiGir6DCcKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEglvdGhlcl90d28K3AEKlQH6AZEBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhADGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGIaJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISBXRocmVlCkoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiGiz6DCkKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgtvdGhlcl90aHJlZQrbAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoEAQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIEZm91cgpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhor+gwoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIKb3RoZXJfZm91cgrbAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEAUaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIEZml2ZQpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhor+gwoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIKb3RoZXJfZml2ZRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISB4ICBAoCCAgaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShhIAESBAoCZGYYCSICCAkQARoREg8KDQoFZmluYWwQAxgJIBMiBBABGBc=
