## TEST CASE

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan() , "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

# TODO: SNOW-1546550 fix multiple otherwise calls.
df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(
    when(col("a") == 1, "one")
    .otherwise("other_one")
    .when(col("a") == 2, "two")
    .otherwise("other_two")
    .when(col("a") == 3, "three")
    .otherwise("other_three")
    .when(col("a") == 4, "four")
    .otherwise("other_four")
    .when(col("a") == 5, "five")
    .otherwise("other_five")
)

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan(), "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(when(col("a") == 1, "one").otherwise("other_one").when(col("a") == 2, "two").otherwise("other_two").when(col("a") == 3, "three").otherwise("other_three").when(col("a") == 4, "four").otherwise("other_four").when(col("a") == 5, "five").otherwise("other_five"))

## EXPECTED ENCODED AST

CkMKQQoz4gswEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoiAggBEgQKAmRmGAEiAggBCpsCCpgCCokC+giFAgrbAcIE1wEKuAEKc4oBcAonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcGimyDCYKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEghib29sX2NvbCIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcGiWyDCIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgR0cnVlEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBIHggIECgIIARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwgARIECgJkZhgCIgIIAgqYBQqVBQqGBfoIggUK2ATCBNQECvYBCrEB8gGtAQpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhoksgwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIDb25lCvYBCrEBwgKtAQpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhoksgwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIDdHdvCkQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheGiayDCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgVvdGhlchIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheIAESBAoCZGYYAyICCAMK0QQKzgQKvwT6CLsECpEEwgSNBArhAgrUAboE0AEKbIoBaQonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgGiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgFBIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBAlGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYCIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBAqEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAaIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGASAUIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgCooBEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAaIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGASAUMiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIHggIECgIIAxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAgARIECgJkZhgEIgIIBAr8Agr5AgrqAvoI5gIKvALCBLgCCtMBCo4B2gSKAQpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGIaIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGIaJLIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISA29uZQpEEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhomsgwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIFb3RoZXISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgeCAgQKAggEGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYiABEgQKAmRmGAUiAggFCskGCsYGCrcG+gizBgqJBsIEhQYKmgIKjgGCBYoBCmyKAWkKJxolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBoisgwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBprigFoCicaJQoHCgUKA2xpdBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQQASIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQKvQIKsQHyAa0BCmyKAWkKJxolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBoisgwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQQARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGmuKAWgKJxolCgcKBQoDbGl0EhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBohugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBACIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZAqJARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaa4oBaAonGiUKBwoFCgNsaXQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEAMiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIHggIECgIIBRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQgARIECgJkZhgGIgIIBgqdBQqaBQqLBfoIhwUK3QTCBNkECvkBCrQBsgWwAQpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcaIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEiSyDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgNmb28aGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxoksgwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIDZm9vCkMSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnGiWyDCIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgRudWxsCvkBCrQBsgWwAQpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcaIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEiSyDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgNiYXIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxoksgwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIDYmFyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZxIHggIECgIIBhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcgARIECgJkZhgHIgIIBwrrAwroAwrZA/oI1QMKqwPCBKcDCsICCvwBggH4AQpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkaIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShpEmyKAWkKJxolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRoisgwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIBYiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShpEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRolsgwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIEYm90aApEEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRomsgwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIFb3RoZXISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShpEgeCAgQKAggHGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaSABEgQKAmRmGAgiAggICrcNCrQNCqUN+gihDQr3DMIE8wwK9gEKsQHyAa0BCmyKAWkKJxolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBoisgwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSIboCHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwQARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsGiSyDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEgNvbmUKSBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaKrIMJwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSCW90aGVyX29uZQr2AQqxAfIBrQEKbIoBaQonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuGiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhACGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaJLIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSA3R3bwpIEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBoqsgwnChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIJb3RoZXJfdHdvCvgBCrEB8gGtAQpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAaIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHASAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEAMaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBomsgwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIFdGhyZWUKShIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaLLIMKQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSC290aGVyX3RocmVlCvcBCrEB8gGtAQpsigFpCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHIaIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHISAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyEAQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBolsgwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIEZm91cgpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBorsgwoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIKb3RoZXJfZm91cgr3AQqxAfIBrQEKbIoBaQonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0GiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBAFGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaJbIMIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSBGZpdmUKSRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaK7IMKAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSCm90aGVyX2ZpdmUSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEgeCAgQKAggIGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoayABEgQKAmRmGAkiAggJEAEaERIPCg0KBWZpbmFsEAMYCSASIgYQARgWIAE=
