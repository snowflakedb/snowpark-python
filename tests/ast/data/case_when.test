## TEST CASE

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan() , "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

# TODO: SNOW-1546550 fix multiple otherwise calls.
df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(
    when(col("a") == 1, "one")
    .otherwise("other_one")
    .when(col("a") == 2, "two")
    .otherwise("other_two")
    .when(col("a") == 3, "three")
    .otherwise("other_three")
    .when(col("a") == 4, "four")
    .otherwise("other_four")
    .when(col("a") == 5, "five")
    .otherwise("other_five")
)

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan(), "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(when(col("a") == 1, "one").otherwise("other_one").when(col("a") == 2, "two").otherwise("other_two").when(col("a") == 3, "three").otherwise("other_three").when(col("a") == 4, "four").otherwise("other_four").when(col("a") == 5, "five").otherwise("other_five"))

## EXPECTED ENCODED AST

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Q19QT1NJVElPTl9URVNUX01PREUgHChiEiAIORBiGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoYhoqugwnCiAIORBiGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoYhIDb25lClASIAhMEGIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhiGiy6DCkKIAhMEGIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhiEgVvdGhlchIgCDkQYhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGISB4ICBAoCCAQaIAhNEGIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShiIAESBAoCZGYYBSICCAUKqAYKpQYKlgb6CJIGCuIFwgTeBQqGAgqEAYIFgAEKXIoBWQoLGgkKBwoFCgNjb2waKLoMJQogCCQQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKGQSAWEiIAgkEGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChkEiAILhBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoZBIgCDcQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGQaW4oBWAoLGgkKBwoFCgNsaXQaJ7oCJAogCDYQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAwKGQQASIgCDYQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAwKGQKrwIKrQHyAakBClyKAVkKCxoJCgcKBQoDY29sGii6DCUKIAhFEGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgPShkEgFhIiAIRRBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFID0oZBInugIkCiAIShBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFID0oZBABGiAIShBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFID0oZBIgCFMQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGQaW4oBWAoLGgkKBwoFCgNsaXQaJ7oCJAogCFIQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSBMKGQQAiIgCFIQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSBMKGQKfxIgCGUQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAX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CBoQbhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKG4SAWEiIAgaEG4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihuEie6AiQKIAgfEG4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihuEAIaIAgfEG4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihuEiAIJxBuGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0obhoqugwnCiAIJxBuGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0obhIDdHdvClQSIAgjEG8aFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShvGjC6DC0KIAgjEG8aFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShvEglvdGhlcl90d28KgAIKrQHyAakBClyKAVkKCxoJCgcKBQoDY29sGii6DCUKIAgaEHAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihwEgFhIiAIGhBwGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIocBInugIkCiAIHxBwGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIocBADGiAIHxBwGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIocBIgCCkQcBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKHAaLLoMKQogCCkQcBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKHASBXRocmVlClYSIAglEHEaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShxGjK6DC8KIAglEHEaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShxEgtvdGhlcl90aHJlZQr/AQqtAfIBqQEKXIoBWQoLGgkKBwoFCgNjb2waKLoMJQogCBoQchoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHISAWEiIAgaEHIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihyEie6AiQKIAgfEHIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihyEAQaIAgfEHIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihyEiAIKBByGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0ochorugwoCiAIKBByGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0ochIEZm91cgpVEiAIJBBzGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0ocxoxugwuCiAIJBBzGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0ocxIKb3RoZXJfZm91cgr/AQqtAfIBqQEKXIoBWQoLGgkKBwoFCgNjb2waKLoMJQogCBoQdBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHQSAWEiIAgaEHQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEih0Eie6AiQKIAgfEHQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEih0EAUaIAgfEHQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEih0EiAIKBB0GhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0odBorugwoCiAIKBB0GhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0odBIEZml2ZQpVEiAIJBB1GhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0odRoxugwuCiAIJBB1GhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0odRIKb3RoZXJfZml2ZRIgCCYQbBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAMKGwSB4ICBAoCCAgaIAgJEHYaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShrIAESBAoCZGYYCSICCAkQARoREg8KDQoFZmluYWwQAxgLIAkiBBABGBc=
