## TEST CASE

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan() , "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

# TODO: SNOW-1546550 fix multiple otherwise calls.
df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(
    when(col("a") == 1, "one")
    .otherwise("other_one")
    .when(col("a") == 2, "two")
    .otherwise("other_two")
    .when(col("a") == 3, "three")
    .otherwise("other_three")
    .when(col("a") == 4, "four")
    .otherwise("other_four")
    .when(col("a") == 5, "five")
    .otherwise("other_five")
)

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan(), "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(when(col("a") == 1, "one").otherwise("other_one").when(col("a") == 2, "two").otherwise("other_two").when(col("a") == 3, "three").otherwise("other_three").when(col("a") == 4, "four").otherwise("other_four").when(col("a") == 5, "five").otherwise("other_five"))

## EXPECTED ENCODED AST

CkkKRwo54gs2Eg4KDAoKdGVzdF90YWJsZRogCCgQWhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKFoiAggBEgQKAmRmGAEiAggBCscCCsQCCrUC+gixAgqBAsIE/QEK2AEKhgGKAYIBCi0aKwoHCgUKA2NvbBIgCCsQXBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKFwaL7IMLAogCCsQXBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKFwSCGJvb2xfY29sIiAIKxBcGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoXBIgCDQQXBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKFwaK7IMKAogCDQQXBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKFwSBHRydWUSIAg0EFwaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhcEgeCAgQKAggBGiAINRBcGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oXCABEgQKAmRmGAIiAggCCoQGCoEGCvIF+gjuBQq+BcIEugUKoAIKzwHyAcsBCn6KAXsKLRorCgcKBQoDY29sEiAIJBBeGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoXhoosgwlCiAIJBBeGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoXhIBQSIgCCQQXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKF4SJ7oCJAogCCkQXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKF4QARogCCkQXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKF4SIAgxEF4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyheGiqyDCcKIAgxEF4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyheEgNvbmUKoAIKzwHCAssBCn6KAXsKLRorCgcKBQoDY29sEiAIPxBeGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIDcoXhoosgwlCiAIPxBeGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIDcoXhIBQSIgCD8QXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSA3KF4SJ7oCJAogCEQQXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSA3KF4QAhogCEQQXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSA3KF4SIAhMEF4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyheGiqyDCcKIAhMEF4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyheEgN0d28KUBIgCF8QXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKF4aLLIMKQogCF8QXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKF4SBW90aGVyEiAIMRBeGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoXhIHggIECgIIAhogCGAQXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKF4gARIECgJkZhgDIgIIAwqxBQquBQqfBfoImwUK6wTCBOcECp0DCvgBugT0AQp+igF7Ci0aKwoHCgUKA2NvbBIgCCQQYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKGAaKLIMJQogCCQQYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKGASAUEiIAgkEGAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChgEie6AiQKIAg0EGAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChgECUaIAg0EGAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChgIie6AiQKIAg0EGAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChgECoSIAg/EGAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhgGn6KAXsKLRorCgcKBQoDY29sEiAIPhBgGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIDYoYBoosgwlCiAIPhBgGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIDYoYBIBQiIgCD4QYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSA2KGAKogESIAhTEGAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhgGn6KAXsKLRorCgcKBQoDY29sEiAIUhBgGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIEooYBoosgwlCiAIUhBgGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIEooYBIBQyIgCFIQYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSBKKGASIAg/EGAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhgEgeCAgQKAggDGiAIVBBgGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oYCABEgQKAmRmGAQiAggECrgDCrUDCqYD+giiAwryAsIE7gIK9wEKpgHaBKIBCn6KAXsKLRorCgcKBQoDY29sEiAIJBBiGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoYhoosgwlCiAIJBBiGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoYhIBQSIgCCQQYhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKGISIAgwEGIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChiEiAIORBiGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoYhoqsgwnCiAIORBiGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoYhIDb25lClASIAhMEGIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhiGiyyDCkKIAhMEGIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhiEgVvdGhlchIgCDkQYhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGISB4ICBAoCCAQaIAhNEGIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShiIAESBAoCZGYYBSICCAUK0wcK0AcKwQf6CL0HCo0HwgSJBwrKAgqmAYIFogEKfooBewotGisKBwoFCgNjb2wSIAgkEGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChkGiiyDCUKIAgkEGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChkEgFhIiAIJBBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoZBIgCC4QZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKGQSIAg3EGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhkGn2KAXoKLRorCgcKBQoDbGl0EiAINhBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIDAoZBonugIkCiAINhBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIDAoZBABIiAINhBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIDAoZArzAgrPAfIBywEKfooBewotGisKBwoFCgNjb2wSIAhFEGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgPShkGiiyDCUKIAhFEGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgPShkEgFhIiAIRRBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFID0oZBInugIkCiAIShBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFID0oZBABGiAIShBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFID0oZBIgCFMQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGQafYoBegotGisKBwoFCgNsaXQSIAhSEGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgTChkGie6AiQKIAhSEGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgTChkEAIiIAhSEGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgTChkCqEBEiAIZRBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoZBp9igF6Ci0aKwoHCgUKA2xpdBIgCGQQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSBeKGQaJ7oCJAogCGQQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSBeKGQQAyIgCGQQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSBeKGQSIAg3EGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhkEgeCAgQKAggFGiAIZhBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oZCABEgQKAmRmGAYiAggGCokGCoYGCvcF+gjzBQrDBcIEvwUKowIK0gGyBc4BCn6KAXsKLRorCgcKBQoDY29sEiAIJBBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoZxoosgwlCiAIJBBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoZxIBYSIgCCQQZxoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKGcSKrIMJwogCDQQZxoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKGcSA2ZvbxogCDQQZxoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKGcSIAg8EGcaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhnGiqyDCcKIAg8EGcaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhnEgNmb28KTxIgCE4QZxoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGcaK7IMKAogCE4QZxoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGcSBG51bGwKowIK0gGyBc4BCn6KAXsKLRorCgcKBQoDY29sEiAIXBBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIFQoZxoosgwlCiAIXBBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIFQoZxIBYSIgCFwQZxoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSBUKGcSKrIMJwogCGwQZxoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSBUKGcSA2JhchogCGwQZxoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSBUKGcSIAh0EGcaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhnGiqyDCcKIAh0EGcaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhnEgNiYXISIAg8EGcaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhnEgeCAgQKAggGGiAIdRBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oZyABEgQKAmRmGAciAggHCrkECrYECqcE+gijBArzA8IE7wMK+AIKpgKCAaICCn6KAXsKLRorCgcKBQoDY29sEiAIJBBpGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoaRoosgwlCiAIJBBpGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoaRIBYSIgCCQQaRoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKGkSfooBewotGisKBwoFCgNjb2wSIAgvEGkaFlNSQ19QT1NJVElPTl9URVNUX01PREUgJyhpGiiyDCUKIAgvEGkaFlNSQ19QT1NJVElPTl9URVNUX01PREUgJyhpEgFiIiAILxBpGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFICcoaRogCC8QaRoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKGkSIAg4EGkaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhpGiuyDCgKIAg4EGkaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhpEgRib3RoClASIAhLEGkaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhpGiyyDCkKIAhLEGkaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhpEgVvdGhlchIgCDgQaRoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGkSB4ICBAoCCAcaIAhMEGkaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShpIAESBAoCZGYYCCICCAgK0Q8Kzg8Kvw/6CLsPCosPwgSHDwqgAgrPAfIBywEKfooBewotGisKBwoFCgNjb2wSIAgZEGwaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEShsGiiyDCUKIAgZEGwaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEShsEgFhIiAIGRBsGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBEobBInugIkCiAIHhBsGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBEobBABGiAIHhBsGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBEobBIgCCYQbBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAMKGwaKrIMJwogCCYQbBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAMKGwSA29uZQpUEiAIIxBtGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0obRowsgwtCiAIIxBtGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0obRIJb3RoZXJfb25lCqACCs8B8gHLAQp+igF7Ci0aKwoHCgUKA2NvbBIgCBoQbhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKG4aKLIMJQogCBoQbhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKG4SAWEiIAgaEG4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihuEie6AiQKIAgfEG4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihuEAIaIAgfEG4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihuEiAIJxBuGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0obhoqsgwnCiAIJxBuGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0obhIDdHdvClQSIAgjEG8aFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShvGjCyDC0KIAgjEG8aFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShvEglvdGhlcl90d28KogIKzwHyAcsBCn6KAXsKLRorCgcKBQoDY29sEiAIGhBwGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIocBoosgwlCiAIGhBwGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIocBIBYSIgCBoQcBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHASJ7oCJAogCB8QcBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHAQAxogCB8QcBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHASIAgpEHAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShwGiyyDCkKIAgpEHAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShwEgV0aHJlZQpWEiAIJRBxGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0ocRoysgwvCiAIJRBxGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0ocRILb3RoZXJfdGhyZWUKoQIKzwHyAcsBCn6KAXsKLRorCgcKBQoDY29sEiAIGhByGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIochoosgwlCiAIGhByGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIochIBYSIgCBoQchoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHISJ7oCJAogCB8QchoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHIQBBogCB8QchoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHISIAgoEHIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShyGiuyDCgKIAgoEHIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShyEgRmb3VyClUSIAgkEHMaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShzGjGyDC4KIAgkEHMaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShzEgpvdGhlcl9mb3VyCqECCs8B8gHLAQp+igF7Ci0aKwoHCgUKA2NvbBIgCBoQdBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHQaKLIMJQogCBoQdBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHQSAWEiIAgaEHQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEih0Eie6AiQKIAgfEHQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEih0EAUaIAgfEHQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEih0EiAIKBB0GhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0odBorsgwoCiAIKBB0GhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0odBIEZml2ZQpVEiAIJBB1GhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0odRoxsgwuCiAIJBB1GhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0odRIKb3RoZXJfZml2ZRIgCCYQbBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAMKGwSB4ICBAoCCAgaIAgJEHYaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShrIAESBAoCZGYYCSICCAkQARoREg8KDQoFZmluYWwQAxgLIAkiBBABGBU=
