## TEST CASE

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan() , "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

# TODO: SNOW-1546550 fix multiple otherwise calls.
df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(
    when(col("a") == 1, "one")
    .otherwise("other_one")
    .when(col("a") == 2, "two")
    .otherwise("other_two")
    .when(col("a") == 3, "three")
    .otherwise("other_three")
    .when(col("a") == 4, "four")
    .otherwise("other_four")
    .when(col("a") == 5, "five")
    .otherwise("other_five")
)

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan(), "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(when(col("a") == 1, "one").otherwise("other_one").when(col("a") == 2, "two").otherwise("other_two").when(col("a") == 3, "three").otherwise("other_three").when(col("a") == 4, "four").otherwise("other_four").when(col("a") == 5, "five").otherwise("other_five"))

## EXPECTED ENCODED AST

CkkKRwo5wgs2Eg4KDAoKdGVzdF90YWJsZRogCCgQWhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKFoiAggBEgQKAmRmGAEiAggBCsYCCsMCCrQC4giwAgqAAqIE/AEK1wEKhQF6ggEKLQorCgcKBQoDY29sEiAIKxBcGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoXBovigwsCiAIKxBcGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoXBIIYm9vbF9jb2wiIAgrEFwaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChcEiAINBBcGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoXBorigwoCiAINBBcGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoXBIEdHJ1ZRIgCDQQXBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKFwSB4oCBAoCCAEaIAg1EFwaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShcIAESBAoCZGYYAiICCAIKggYK/wUK8AXiCOwFCrwFogS4BQqfAgrOAdoBygEKfXp7Ci0KKwoHCgUKA2NvbBIgCCQQXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKF4aKIoMJQogCCQQXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKF4SAUEiIAgkEF4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgHCheEieSAiQKIAgpEF4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgHCheEAEaIAgpEF4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgHCheEiAIMRBeGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoXhoqigwnCiAIMRBeGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoXhIDb25lCp8CCs4BmgLKAQp9ensKLQorCgcKBQoDY29sEiAIPxBeGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIDcoXhooigwlCiAIPxBeGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIDcoXhIBQSIgCD8QXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSA3KF4SJ5ICJAogCEQQXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSA3KF4QAhogCEQQXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSA3KF4SIAhMEF4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyheGiqKDCcKIAhMEF4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyheEgN0d28KUBIgCF8QXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKF4aLIoMKQogCF8QXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKF4SBW90aGVyEiAIMRBeGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoXhIHigIECgIIAhogCGAQXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKF4gARIECgJkZhgDIgIIAwquBQqrBQqcBeIImAUK6ASiBOQECpsDCvcBmgTzAQp9ensKLQorCgcKBQoDY29sEiAIJBBgGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoYBooigwlCiAIJBBgGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoYBIBQSIgCCQQYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKGASJ5ICJAogCDQQYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKGAQJRogCDQQYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKGAiJ5ICJAogCDQQYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKGAQKhIgCD8QYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGAafXp7Ci0KKwoHCgUKA2NvbBIgCD4QYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSA2KGAaKIoMJQogCD4QYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSA2KGASAUIiIAg+EGAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgNihgCqEBEiAIUxBgGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoYBp9ensKLQorCgcKBQoDY29sEiAIUhBgGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIEooYBooigwlCiAIUhBgGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIEooYBIBQyIgCFIQYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSBKKGASIAg/EGAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhgEgeKAgQKAggDGiAIVBBgGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oYCABEgQKAmRmGAQiAggECrcDCrQDCqUD4gihAwrxAqIE7QIK9gEKpQG6BKEBCn16ewotCisKBwoFCgNjb2wSIAgkEGIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChiGiiKDCUKIAgkEGIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChiEgFBIiAIJBBiGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoYhIgCDAQYhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKGISIAg5EGIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhiGiqKDCcKIAg5EGIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhiEgNvbmUKUBIgCEwQYhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGIaLIoMKQogCEwQYhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGISBW90aGVyEiAIORBiGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoYhIHigIECgIIBBogCE0QYhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKGIgARIECgJkZhgFIgIIBQrOBwrLBwq8B+IIuAcKiAeiBIQHCsgCCqUB4gShAQp9ensKLQorCgcKBQoDY29sEiAIJBBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoZBooigwlCiAIJBBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoZBIBYSIgCCQQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAcKGQSIAguEGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChkEiAINxBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoZBp8enoKLQorCgcKBQoDbGl0EiAINhBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIDAoZBonkgIkCiAINhBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIDAoZBABIiAINhBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIDAoZArxAgrOAdoBygEKfXp7Ci0KKwoHCgUKA2NvbBIgCEUQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSA9KGQaKIoMJQogCEUQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSA9KGQSAWEiIAhFEGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgPShkEieSAiQKIAhKEGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgPShkEAEaIAhKEGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgPShkEiAIUxBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoZBp8enoKLQorCgcKBQoDbGl0EiAIUhBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIEwoZBonkgIkCiAIUhBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIEwoZBACIiAIUhBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIEwoZAqgARIgCGUQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGQafHp6Ci0KKwoHCgUKA2xpdBIgCGQQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSBeKGQaJ5ICJAogCGQQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSBeKGQQAyIgCGQQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSBeKGQSIAg3EGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhkEgeKAgQKAggFGiAIZhBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oZCABEgQKAmRmGAYiAggGCocGCoQGCvUF4gjxBQrBBaIEvQUKogIK0QGSBc0BCn16ewotCisKBwoFCgNjb2wSIAgkEGcaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChnGiiKDCUKIAgkEGcaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChnEgFhIiAIJBBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoZxIqigwnCiAINBBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoZxIDZm9vGiAINBBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoZxIgCDwQZxoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGcaKooMJwogCDwQZxoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGcSA2ZvbwpPEiAIThBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoZxorigwoCiAIThBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoZxIEbnVsbAqiAgrRAZIFzQEKfXp7Ci0KKwoHCgUKA2NvbBIgCFwQZxoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSBUKGcaKIoMJQogCFwQZxoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSBUKGcSAWEiIAhcEGcaFlNSQ19QT1NJVElPTl9URVNUX01PREUgVChnEiqKDCcKIAhsEGcaFlNSQ19QT1NJVElPTl9URVNUX01PREUgVChnEgNiYXIaIAhsEGcaFlNSQ19QT1NJVElPTl9URVNUX01PREUgVChnEiAIdBBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoZxoqigwnCiAIdBBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoZxIDYmFyEiAIPBBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoZxIHigIECgIIBhogCHUQZxoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKGcgARIECgJkZhgHIgIIBwq2BAqzBAqkBOIIoAQK8AOiBOwDCvUCCqMCcqACCn16ewotCisKBwoFCgNjb2wSIAgkEGkaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChpGiiKDCUKIAgkEGkaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChpEgFhIiAIJBBpGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBwoaRJ9ensKLQorCgcKBQoDY29sEiAILxBpGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFICcoaRooigwlCiAILxBpGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFICcoaRIBYiIgCC8QaRoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAnKGkaIAgvEGkaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHChpEiAIOBBpGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoaRorigwoCiAIOBBpGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoaRIEYm90aApQEiAISxBpGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoaRosigwpCiAISxBpGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBcoaRIFb3RoZXISIAg4EGkaFlNSQ19QT1NJVElPTl9URVNUX01PREUgFyhpEgeKAgQKAggHGiAITBBpGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oaSABEgQKAmRmGAgiAggICswPCskPCroP4gi2DwqGD6IEgg8KnwIKzgHaAcoBCn16ewotCisKBwoFCgNjb2wSIAgZEGwaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEShsGiiKDCUKIAgZEGwaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEShsEgFhIiAIGRBsGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBEobBInkgIkCiAIHhBsGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBEobBABGiAIHhBsGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBEobBIgCCYQbBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAMKGwaKooMJwogCCYQbBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAMKGwSA29uZQpUEiAIIxBtGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0obRowigwtCiAIIxBtGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0obRIJb3RoZXJfb25lCp8CCs4B2gHKAQp9ensKLQorCgcKBQoDY29sEiAIGhBuGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIobhooigwlCiAIGhBuGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIobhIBYSIgCBoQbhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKG4SJ5ICJAogCB8QbhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKG4QAhogCB8QbhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKG4SIAgnEG4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShuGiqKDCcKIAgnEG4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShuEgN0d28KVBIgCCMQbxoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKG8aMIoMLQogCCMQbxoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKG8SCW90aGVyX3R3bwqhAgrOAdoBygEKfXp7Ci0KKwoHCgUKA2NvbBIgCBoQcBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHAaKIoMJQogCBoQcBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHASAWEiIAgaEHAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihwEieSAiQKIAgfEHAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihwEAMaIAgfEHAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihwEiAIKRBwGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0ocBosigwpCiAIKRBwGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0ocBIFdGhyZWUKVhIgCCUQcRoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKHEaMooMLwogCCUQcRoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKHESC290aGVyX3RocmVlCqACCs4B2gHKAQp9ensKLQorCgcKBQoDY29sEiAIGhByGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIochooigwlCiAIGhByGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIochIBYSIgCBoQchoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHISJ5ICJAogCB8QchoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHIQBBogCB8QchoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHISIAgoEHIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShyGiuKDCgKIAgoEHIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShyEgRmb3VyClUSIAgkEHMaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShzGjGKDC4KIAgkEHMaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShzEgpvdGhlcl9mb3VyCqACCs4B2gHKAQp9ensKLQorCgcKBQoDY29sEiAIGhB0GhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIodBooigwlCiAIGhB0GhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIodBIBYSIgCBoQdBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHQSJ5ICJAogCB8QdBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHQQBRogCB8QdBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKHQSIAgoEHQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDSh0GiuKDCgKIAgoEHQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDSh0EgRmaXZlClUSIAgkEHUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDSh1GjGKDC4KIAgkEHUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDSh1EgpvdGhlcl9maXZlEiAIJhBsGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIAwobBIHigIECgIICBogCAkQdhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKGsgARIECgJkZhgJIgIICRABGhESDwoNCgVmaW5hbBADGAsgCSIEEAEYFQ==
