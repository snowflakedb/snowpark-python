## TEST CASE

df = session.table(tables.table1)

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan() , "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

# TODO: SNOW-1546550 fix multiple otherwise calls.
df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(
    when(col("a") == 1, "one")
    .otherwise("other_one")
    .when(col("a") == 2, "two")
    .otherwise("other_two")
    .when(col("a") == 3, "three")
    .otherwise("other_three")
    .when(col("a") == 4, "four")
    .otherwise("other_four")
    .when(col("a") == 5, "five")
    .otherwise("other_five")
)

## EXPECTED UNPARSER OUTPUT

df = session.table("table1")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan(), "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(when(col("a") == 1, "one").otherwise("other_one").when(col("a") == 2, "two").otherwise("other_two").when(col("a") == 3, "three").otherwise("other_three").when(col("a") == 4, "four").otherwise("other_four").when(col("a") == 5, "five").otherwise("other_five"))

## EXPECTED ENCODED AST

<<<<<<< HEAD
Cj8KPQovggwsEgoKCAoGdGFibGUxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoGSICCAESBAoCZGYYASICCAEK/wEK/AEK7QGCCekBCr8BygS7AQqcAQpXkgFUCgsaCQoHCgUKA2NvbBop+gwmChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoGxIIYm9vbF9jb2wiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgbEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoGxol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoGxIEdHJ1ZRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKBsSB4ICBAoCCAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgbIAESBAoCZGYYAiICCAIK4AQK3QQKzgSCCcoECqAEygScBAraAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB0SAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgdEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgdEAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgdEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHRok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHRIDb25lCtoBCpUBygKRAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHRIBQSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB0SIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB0QAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB0SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgdGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgdEgN0d28KRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB0aJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB0SBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHRIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB0gARIECgJkZhgDIgIIAwr8Awr5AwrqA4IJ5gMKvAPKBLgDCqkCCrgBwgS0AQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHxIBQSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8SIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8QJRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8iIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8QKhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8aUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8SAUIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgfCm4SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgfGlCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgfEgFDIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8SB4ICBAoCCAMaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgfIAESBAoCZGYYBCICCAQK3gIK2wIKzAKCCcgCCp4CygSaAgq1AQpx4gRuClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSghEgFBIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSghGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSghEgNvbmUKRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCEaJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCESBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIRIHggIECgIIBBoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCEgARIECgJkZhgFIgIIBQq6BQq3BQqoBYIJpAUK+gTKBPYECuABCnGKBW4KUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgjEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMaT5IBTAoLGgkKBwoFCgNsaXQaIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMQASIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMKhQIKlQH6AZEBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgjEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIxIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIxABGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMaT5IBTAoLGgkKBwoFCgNsaXQaIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMQAiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMKbRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMaT5IBTAoLGgkKBwoFCgNsaXQaIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMQAyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgjEgeCAgQKAggFGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIyABEgQKAmRmGAYiAggGCuUECuIECtMEggnPBAqlBMoEoQQK3QEKmAG6BZQBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgmEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhIk+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhIDZm9vGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCYaJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCYSA2ZvbwpDEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhIEbnVsbArdAQqYAboFlAEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCYSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgmEiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgmEgNiYXIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgmEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhIDYmFyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhIHggIECgIIBhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCYgARIECgJkZhgHIgIIBwqzAwqwAwqhA4IJnQMK8wLKBO8CCooCCsQBigHAAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKBIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCgSUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCgSAWIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgoGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCgaJfoMIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCgSBGJvdGgKRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCgaJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCgSBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKBIHggIECgIIBxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCggARIECgJkZhgIIgIICAqrDAqoDAqZDIIJlQwK6wvKBOcLCtoBCpUB+gGRAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsSIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsQARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgrGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgrEgNvbmUKSBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsaKvoMJwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsSCW90aGVyX29uZQraAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKC0SAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgtEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgtEAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgtEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxIDdHdvCkgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgrGir6DCcKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgrEglvdGhlcl90d28K3AEKlQH6AZEBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgvEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoLxIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoLxADGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoLxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsaJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsSBXRocmVlCkoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgrGiz6DCkKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgrEgtvdGhlcl90aHJlZQrbAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDESAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgxEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgxEAQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgxEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxIEZm91cgpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxor+gwoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxIKb3RoZXJfZm91cgrbAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDMSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgzEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgzEAUaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgzEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxIEZml2ZQpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxor+gwoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxIKb3RoZXJfZml2ZRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsSB4ICBAoCCAgaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgqIAESBAoCZGYYCSICCAkQARoREg8KDQoFZmluYWwQAxgJIBIiBBABGBc=
=======
{
  "body": [
    {
      "assign": {
        "expr": {
          "sp_table": {
            "name": {
              "sp_table_name_flat": {
                "name": "test_table"
              }
            },
            "src": {
              "file": "SRC_POSITION_TEST_MODE",
              "start_line": "90"
            },
            "variant": {
              "sp_session_table": true
            }
          }
        },
        "symbol": "df",
        "uid": "1",
        "var_id": {
          "bitfield1": "1"
        }
      }
    },
    {
      "assign": {
        "expr": {
          "sp_dataframe_select__columns": {
            "cols": [
              {
                "sp_column_case_when": {
                  "cases": [
                    {
                      "condition": {
                        "apply_expr": {
                          "fn": {
                            "builtin_fn": {
                              "name": {
                                "fn_name_flat": {
                                  "name": "col"
                                }
                              }
                            }
                          },
                          "pos_args": [
                            {
                              "string_val": {
                                "src": {
                                  "file": "SRC_POSITION_TEST_MODE",
                                  "start_line": "92"
                                },
                                "v": "bool_col"
                              }
                            }
                          ],
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "92"
                          }
                        }
                      },
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "92"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "92"
                          },
                          "v": "true"
                        }
                      }
                    }
                  ],
                  "src": {
                    "file": "SRC_POSITION_TEST_MODE",
                    "start_line": "92"
                  }
                }
              }
            ],
            "df": {
              "sp_dataframe_ref": {
                "id": {
                  "bitfield1": "1"
                }
              }
            },
            "src": {
              "file": "SRC_POSITION_TEST_MODE",
              "start_line": "92"
            },
            "variadic": true
          }
        },
        "symbol": "df",
        "uid": "2",
        "var_id": {
          "bitfield1": "2"
        }
      }
    },
    {
      "assign": {
        "expr": {
          "sp_dataframe_select__columns": {
            "cols": [
              {
                "sp_column_case_when": {
                  "cases": [
                    {
                      "condition": {
                        "eq": {
                          "lhs": {
                            "apply_expr": {
                              "fn": {
                                "builtin_fn": {
                                  "name": {
                                    "fn_name_flat": {
                                      "name": "col"
                                    }
                                  }
                                }
                              },
                              "pos_args": [
                                {
                                  "string_val": {
                                    "src": {
                                      "file": "SRC_POSITION_TEST_MODE",
                                      "start_line": "94"
                                    },
                                    "v": "A"
                                  }
                                }
                              ],
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "94"
                              }
                            }
                          },
                          "rhs": {
                            "int64_val": {
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "94"
                              },
                              "v": "1"
                            }
                          },
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "94"
                          }
                        }
                      },
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "94"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "94"
                          },
                          "v": "one"
                        }
                      }
                    },
                    {
                      "condition": {
                        "leq": {
                          "lhs": {
                            "apply_expr": {
                              "fn": {
                                "builtin_fn": {
                                  "name": {
                                    "fn_name_flat": {
                                      "name": "col"
                                    }
                                  }
                                }
                              },
                              "pos_args": [
                                {
                                  "string_val": {
                                    "src": {
                                      "file": "SRC_POSITION_TEST_MODE",
                                      "start_line": "94"
                                    },
                                    "v": "A"
                                  }
                                }
                              ],
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "94"
                              }
                            }
                          },
                          "rhs": {
                            "int64_val": {
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "94"
                              },
                              "v": "2"
                            }
                          },
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "94"
                          }
                        }
                      },
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "94"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "94"
                          },
                          "v": "two"
                        }
                      }
                    },
                    {
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "94"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "94"
                          },
                          "v": "other"
                        }
                      }
                    }
                  ],
                  "src": {
                    "file": "SRC_POSITION_TEST_MODE",
                    "start_line": "94"
                  }
                }
              }
            ],
            "df": {
              "sp_dataframe_ref": {
                "id": {
                  "bitfield1": "2"
                }
              }
            },
            "src": {
              "file": "SRC_POSITION_TEST_MODE",
              "start_line": "94"
            },
            "variadic": true
          }
        },
        "symbol": "df",
        "uid": "3",
        "var_id": {
          "bitfield1": "3"
        }
      }
    },
    {
      "assign": {
        "expr": {
          "sp_dataframe_select__columns": {
            "cols": [
              {
                "sp_column_case_when": {
                  "cases": [
                    {
                      "condition": {
                        "sp_column_between": {
                          "col": {
                            "apply_expr": {
                              "fn": {
                                "builtin_fn": {
                                  "name": {
                                    "fn_name_flat": {
                                      "name": "col"
                                    }
                                  }
                                }
                              },
                              "pos_args": [
                                {
                                  "string_val": {
                                    "src": {
                                      "file": "SRC_POSITION_TEST_MODE",
                                      "start_line": "96"
                                    },
                                    "v": "A"
                                  }
                                }
                              ],
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "96"
                              }
                            }
                          },
                          "lower_bound": {
                            "int64_val": {
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "96"
                              },
                              "v": "37"
                            }
                          },
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "96"
                          },
                          "upper_bound": {
                            "int64_val": {
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "96"
                              },
                              "v": "42"
                            }
                          }
                        }
                      },
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "96"
                      },
                      "value": {
                        "apply_expr": {
                          "fn": {
                            "builtin_fn": {
                              "name": {
                                "fn_name_flat": {
                                  "name": "col"
                                }
                              }
                            }
                          },
                          "pos_args": [
                            {
                              "string_val": {
                                "src": {
                                  "file": "SRC_POSITION_TEST_MODE",
                                  "start_line": "96"
                                },
                                "v": "B"
                              }
                            }
                          ],
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "96"
                          }
                        }
                      }
                    },
                    {
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "96"
                      },
                      "value": {
                        "apply_expr": {
                          "fn": {
                            "builtin_fn": {
                              "name": {
                                "fn_name_flat": {
                                  "name": "col"
                                }
                              }
                            }
                          },
                          "pos_args": [
                            {
                              "string_val": {
                                "src": {
                                  "file": "SRC_POSITION_TEST_MODE",
                                  "start_line": "96"
                                },
                                "v": "C"
                              }
                            }
                          ],
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "96"
                          }
                        }
                      }
                    }
                  ],
                  "src": {
                    "file": "SRC_POSITION_TEST_MODE",
                    "start_line": "96"
                  }
                }
              }
            ],
            "df": {
              "sp_dataframe_ref": {
                "id": {
                  "bitfield1": "3"
                }
              }
            },
            "src": {
              "file": "SRC_POSITION_TEST_MODE",
              "start_line": "96"
            },
            "variadic": true
          }
        },
        "symbol": "df",
        "uid": "4",
        "var_id": {
          "bitfield1": "4"
        }
      }
    },
    {
      "assign": {
        "expr": {
          "sp_dataframe_select__columns": {
            "cols": [
              {
                "sp_column_case_when": {
                  "cases": [
                    {
                      "condition": {
                        "sp_column_equal_nan": {
                          "col": {
                            "apply_expr": {
                              "fn": {
                                "builtin_fn": {
                                  "name": {
                                    "fn_name_flat": {
                                      "name": "col"
                                    }
                                  }
                                }
                              },
                              "pos_args": [
                                {
                                  "string_val": {
                                    "src": {
                                      "file": "SRC_POSITION_TEST_MODE",
                                      "start_line": "98"
                                    },
                                    "v": "A"
                                  }
                                }
                              ],
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "98"
                              }
                            }
                          },
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "98"
                          }
                        }
                      },
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "98"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "98"
                          },
                          "v": "one"
                        }
                      }
                    },
                    {
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "98"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "98"
                          },
                          "v": "other"
                        }
                      }
                    }
                  ],
                  "src": {
                    "file": "SRC_POSITION_TEST_MODE",
                    "start_line": "98"
                  }
                }
              }
            ],
            "df": {
              "sp_dataframe_ref": {
                "id": {
                  "bitfield1": "4"
                }
              }
            },
            "src": {
              "file": "SRC_POSITION_TEST_MODE",
              "start_line": "98"
            },
            "variadic": true
          }
        },
        "symbol": "df",
        "uid": "5",
        "var_id": {
          "bitfield1": "5"
        }
      }
    },
    {
      "assign": {
        "expr": {
          "sp_dataframe_select__columns": {
            "cols": [
              {
                "sp_column_case_when": {
                  "cases": [
                    {
                      "condition": {
                        "sp_column_is_null": {
                          "col": {
                            "apply_expr": {
                              "fn": {
                                "builtin_fn": {
                                  "name": {
                                    "fn_name_flat": {
                                      "name": "col"
                                    }
                                  }
                                }
                              },
                              "pos_args": [
                                {
                                  "string_val": {
                                    "src": {
                                      "file": "SRC_POSITION_TEST_MODE",
                                      "start_line": "100"
                                    },
                                    "v": "a"
                                  }
                                }
                              ],
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "100"
                              }
                            }
                          },
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "100"
                          }
                        }
                      },
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "100"
                      },
                      "value": {
                        "apply_expr": {
                          "fn": {
                            "builtin_fn": {
                              "name": {
                                "fn_name_flat": {
                                  "name": "lit"
                                }
                              }
                            }
                          },
                          "pos_args": [
                            {
                              "int64_val": {
                                "src": {
                                  "file": "SRC_POSITION_TEST_MODE",
                                  "start_line": "100"
                                },
                                "v": "1"
                              }
                            }
                          ],
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "100"
                          }
                        }
                      }
                    },
                    {
                      "condition": {
                        "eq": {
                          "lhs": {
                            "apply_expr": {
                              "fn": {
                                "builtin_fn": {
                                  "name": {
                                    "fn_name_flat": {
                                      "name": "col"
                                    }
                                  }
                                }
                              },
                              "pos_args": [
                                {
                                  "string_val": {
                                    "src": {
                                      "file": "SRC_POSITION_TEST_MODE",
                                      "start_line": "100"
                                    },
                                    "v": "a"
                                  }
                                }
                              ],
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "100"
                              }
                            }
                          },
                          "rhs": {
                            "int64_val": {
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "100"
                              },
                              "v": "1"
                            }
                          },
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "100"
                          }
                        }
                      },
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "100"
                      },
                      "value": {
                        "apply_expr": {
                          "fn": {
                            "builtin_fn": {
                              "name": {
                                "fn_name_flat": {
                                  "name": "lit"
                                }
                              }
                            }
                          },
                          "pos_args": [
                            {
                              "int64_val": {
                                "src": {
                                  "file": "SRC_POSITION_TEST_MODE",
                                  "start_line": "100"
                                },
                                "v": "2"
                              }
                            }
                          ],
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "100"
                          }
                        }
                      }
                    },
                    {
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "100"
                      },
                      "value": {
                        "apply_expr": {
                          "fn": {
                            "builtin_fn": {
                              "name": {
                                "fn_name_flat": {
                                  "name": "lit"
                                }
                              }
                            }
                          },
                          "pos_args": [
                            {
                              "int64_val": {
                                "src": {
                                  "file": "SRC_POSITION_TEST_MODE",
                                  "start_line": "100"
                                },
                                "v": "3"
                              }
                            }
                          ],
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "100"
                          }
                        }
                      }
                    }
                  ],
                  "src": {
                    "file": "SRC_POSITION_TEST_MODE",
                    "start_line": "100"
                  }
                }
              }
            ],
            "df": {
              "sp_dataframe_ref": {
                "id": {
                  "bitfield1": "5"
                }
              }
            },
            "src": {
              "file": "SRC_POSITION_TEST_MODE",
              "start_line": "100"
            },
            "variadic": true
          }
        },
        "symbol": "df",
        "uid": "6",
        "var_id": {
          "bitfield1": "6"
        }
      }
    },
    {
      "assign": {
        "expr": {
          "sp_dataframe_select__columns": {
            "cols": [
              {
                "sp_column_case_when": {
                  "cases": [
                    {
                      "condition": {
                        "sp_column_string_contains": {
                          "col": {
                            "apply_expr": {
                              "fn": {
                                "builtin_fn": {
                                  "name": {
                                    "fn_name_flat": {
                                      "name": "col"
                                    }
                                  }
                                }
                              },
                              "pos_args": [
                                {
                                  "string_val": {
                                    "src": {
                                      "file": "SRC_POSITION_TEST_MODE",
                                      "start_line": "103"
                                    },
                                    "v": "a"
                                  }
                                }
                              ],
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "103"
                              }
                            }
                          },
                          "pattern": {
                            "string_val": {
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "103"
                              },
                              "v": "foo"
                            }
                          },
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "103"
                          }
                        }
                      },
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "103"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "103"
                          },
                          "v": "foo"
                        }
                      }
                    },
                    {
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "103"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "103"
                          },
                          "v": "null"
                        }
                      }
                    },
                    {
                      "condition": {
                        "sp_column_string_contains": {
                          "col": {
                            "apply_expr": {
                              "fn": {
                                "builtin_fn": {
                                  "name": {
                                    "fn_name_flat": {
                                      "name": "col"
                                    }
                                  }
                                }
                              },
                              "pos_args": [
                                {
                                  "string_val": {
                                    "src": {
                                      "file": "SRC_POSITION_TEST_MODE",
                                      "start_line": "103"
                                    },
                                    "v": "a"
                                  }
                                }
                              ],
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "103"
                              }
                            }
                          },
                          "pattern": {
                            "string_val": {
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "103"
                              },
                              "v": "bar"
                            }
                          },
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "103"
                          }
                        }
                      },
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "103"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "103"
                          },
                          "v": "bar"
                        }
                      }
                    }
                  ],
                  "src": {
                    "file": "SRC_POSITION_TEST_MODE",
                    "start_line": "103"
                  }
                }
              }
            ],
            "df": {
              "sp_dataframe_ref": {
                "id": {
                  "bitfield1": "6"
                }
              }
            },
            "src": {
              "file": "SRC_POSITION_TEST_MODE",
              "start_line": "103"
            },
            "variadic": true
          }
        },
        "symbol": "df",
        "uid": "7",
        "var_id": {
          "bitfield1": "7"
        }
      }
    },
    {
      "assign": {
        "expr": {
          "sp_dataframe_select__columns": {
            "cols": [
              {
                "sp_column_case_when": {
                  "cases": [
                    {
                      "condition": {
                        "and": {
                          "lhs": {
                            "apply_expr": {
                              "fn": {
                                "builtin_fn": {
                                  "name": {
                                    "fn_name_flat": {
                                      "name": "col"
                                    }
                                  }
                                }
                              },
                              "pos_args": [
                                {
                                  "string_val": {
                                    "src": {
                                      "file": "SRC_POSITION_TEST_MODE",
                                      "start_line": "105"
                                    },
                                    "v": "a"
                                  }
                                }
                              ],
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "105"
                              }
                            }
                          },
                          "rhs": {
                            "apply_expr": {
                              "fn": {
                                "builtin_fn": {
                                  "name": {
                                    "fn_name_flat": {
                                      "name": "col"
                                    }
                                  }
                                }
                              },
                              "pos_args": [
                                {
                                  "string_val": {
                                    "src": {
                                      "file": "SRC_POSITION_TEST_MODE",
                                      "start_line": "105"
                                    },
                                    "v": "b"
                                  }
                                }
                              ],
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "105"
                              }
                            }
                          },
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "105"
                          }
                        }
                      },
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "105"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "105"
                          },
                          "v": "both"
                        }
                      }
                    },
                    {
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "105"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "105"
                          },
                          "v": "other"
                        }
                      }
                    }
                  ],
                  "src": {
                    "file": "SRC_POSITION_TEST_MODE",
                    "start_line": "105"
                  }
                }
              }
            ],
            "df": {
              "sp_dataframe_ref": {
                "id": {
                  "bitfield1": "7"
                }
              }
            },
            "src": {
              "file": "SRC_POSITION_TEST_MODE",
              "start_line": "105"
            },
            "variadic": true
          }
        },
        "symbol": "df",
        "uid": "8",
        "var_id": {
          "bitfield1": "8"
        }
      }
    },
    {
      "assign": {
        "expr": {
          "sp_dataframe_select__columns": {
            "cols": [
              {
                "sp_column_case_when": {
                  "cases": [
                    {
                      "condition": {
                        "eq": {
                          "lhs": {
                            "apply_expr": {
                              "fn": {
                                "builtin_fn": {
                                  "name": {
                                    "fn_name_flat": {
                                      "name": "col"
                                    }
                                  }
                                }
                              },
                              "pos_args": [
                                {
                                  "string_val": {
                                    "src": {
                                      "file": "SRC_POSITION_TEST_MODE",
                                      "start_line": "108"
                                    },
                                    "v": "a"
                                  }
                                }
                              ],
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "108"
                              }
                            }
                          },
                          "rhs": {
                            "int64_val": {
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "108"
                              },
                              "v": "1"
                            }
                          },
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "108"
                          }
                        }
                      },
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "108"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "108"
                          },
                          "v": "one"
                        }
                      }
                    },
                    {
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "108"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "108"
                          },
                          "v": "other_one"
                        }
                      }
                    },
                    {
                      "condition": {
                        "eq": {
                          "lhs": {
                            "apply_expr": {
                              "fn": {
                                "builtin_fn": {
                                  "name": {
                                    "fn_name_flat": {
                                      "name": "col"
                                    }
                                  }
                                }
                              },
                              "pos_args": [
                                {
                                  "string_val": {
                                    "src": {
                                      "file": "SRC_POSITION_TEST_MODE",
                                      "start_line": "110"
                                    },
                                    "v": "a"
                                  }
                                }
                              ],
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "110"
                              }
                            }
                          },
                          "rhs": {
                            "int64_val": {
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "110"
                              },
                              "v": "2"
                            }
                          },
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "110"
                          }
                        }
                      },
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "108"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "108"
                          },
                          "v": "two"
                        }
                      }
                    },
                    {
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "108"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "108"
                          },
                          "v": "other_two"
                        }
                      }
                    },
                    {
                      "condition": {
                        "eq": {
                          "lhs": {
                            "apply_expr": {
                              "fn": {
                                "builtin_fn": {
                                  "name": {
                                    "fn_name_flat": {
                                      "name": "col"
                                    }
                                  }
                                }
                              },
                              "pos_args": [
                                {
                                  "string_val": {
                                    "src": {
                                      "file": "SRC_POSITION_TEST_MODE",
                                      "start_line": "112"
                                    },
                                    "v": "a"
                                  }
                                }
                              ],
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "112"
                              }
                            }
                          },
                          "rhs": {
                            "int64_val": {
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "112"
                              },
                              "v": "3"
                            }
                          },
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "112"
                          }
                        }
                      },
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "108"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "108"
                          },
                          "v": "three"
                        }
                      }
                    },
                    {
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "108"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "108"
                          },
                          "v": "other_three"
                        }
                      }
                    },
                    {
                      "condition": {
                        "eq": {
                          "lhs": {
                            "apply_expr": {
                              "fn": {
                                "builtin_fn": {
                                  "name": {
                                    "fn_name_flat": {
                                      "name": "col"
                                    }
                                  }
                                }
                              },
                              "pos_args": [
                                {
                                  "string_val": {
                                    "src": {
                                      "file": "SRC_POSITION_TEST_MODE",
                                      "start_line": "114"
                                    },
                                    "v": "a"
                                  }
                                }
                              ],
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "114"
                              }
                            }
                          },
                          "rhs": {
                            "int64_val": {
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "114"
                              },
                              "v": "4"
                            }
                          },
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "114"
                          }
                        }
                      },
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "108"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "108"
                          },
                          "v": "four"
                        }
                      }
                    },
                    {
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "108"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "108"
                          },
                          "v": "other_four"
                        }
                      }
                    },
                    {
                      "condition": {
                        "eq": {
                          "lhs": {
                            "apply_expr": {
                              "fn": {
                                "builtin_fn": {
                                  "name": {
                                    "fn_name_flat": {
                                      "name": "col"
                                    }
                                  }
                                }
                              },
                              "pos_args": [
                                {
                                  "string_val": {
                                    "src": {
                                      "file": "SRC_POSITION_TEST_MODE",
                                      "start_line": "116"
                                    },
                                    "v": "a"
                                  }
                                }
                              ],
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "116"
                              }
                            }
                          },
                          "rhs": {
                            "int64_val": {
                              "src": {
                                "file": "SRC_POSITION_TEST_MODE",
                                "start_line": "116"
                              },
                              "v": "5"
                            }
                          },
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "116"
                          }
                        }
                      },
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "108"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "108"
                          },
                          "v": "five"
                        }
                      }
                    },
                    {
                      "src": {
                        "file": "SRC_POSITION_TEST_MODE",
                        "start_line": "108"
                      },
                      "value": {
                        "string_val": {
                          "src": {
                            "file": "SRC_POSITION_TEST_MODE",
                            "start_line": "108"
                          },
                          "v": "other_five"
                        }
                      }
                    }
                  ],
                  "src": {
                    "file": "SRC_POSITION_TEST_MODE",
                    "start_line": "108"
                  }
                }
              }
            ],
            "df": {
              "sp_dataframe_ref": {
                "id": {
                  "bitfield1": "8"
                }
              }
            },
            "src": {
              "file": "SRC_POSITION_TEST_MODE",
              "start_line": "107"
            },
            "variadic": true
          }
        },
        "symbol": "df",
        "uid": "9",
        "var_id": {
          "bitfield1": "9"
        }
      }
    }
  ],
  "client_ast_version": "1",
  "client_language": {
    "python_language": {
      "version": {
        "label": "final",
        "major": "3",
        "minor": "9",
        "patch": "20"
      }
    }
  },
  "client_version": {
    "major": "1",
    "minor": "23"
  }
}
>>>>>>> 66d50cff3 (SNOW-1738538 Update expectation files to json ast output so more stable & readable)
