## TEST CASE

df = session.table(tables.table1)

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan() , "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

# TODO: SNOW-1546550 fix multiple otherwise calls.
df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(
    when(col("a") == 1, "one")
    .otherwise("other_one")
    .when(col("a") == 2, "two")
    .otherwise("other_two")
    .when(col("a") == 3, "three")
    .otherwise("other_three")
    .when(col("a") == 4, "four")
    .otherwise("other_four")
    .when(col("a") == 5, "five")
    .otherwise("other_five")
)

## EXPECTED UNPARSER OUTPUT

df = session.table("table1")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan(), "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(when(col("a") == 1, "one").otherwise("other_one").when(col("a") == 2, "two").otherwise("other_two").when(col("a") == 3, "three").otherwise("other_three").when(col("a") == 4, "four").otherwise("other_four").when(col("a") == 5, "five").otherwise("other_five"))

## EXPECTED ENCODED AST

Cj8KPQovggwsEgoKCAoGdGFibGUxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRiICCAESBAoCZGYYASICCAEK/wEK/AEK7QGCCekBCr8BygS7AQqcAQpXkgFUCgsaCQoHCgUKA2NvbBop+gwmChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSBIIYm9vbF9jb2wiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShIEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSBol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSBIEdHJ1ZRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEgSB4ICBAoCCAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShIIAESBAoCZGYYAiICCAIK4AQK3QQKzgSCCcoECqAEygScBAraAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEoSAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShKEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShKEAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShKEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoShok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoShIDb25lCtoBCpUBygKRAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoShIBQSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEoSIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEoQAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShKGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShKEgN0d28KRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEoaJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEoSBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoShIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEogARIECgJkZhgDIgIIAwr8Awr5AwrqA4IJ5gMKvAPKBLgDCqkCCrgBwgS0AQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBIBQSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEwSIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEwQJRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEwiIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEwQKhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEwaUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEwSAUIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShMCm4SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShMGlCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShMEgFDIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEwSB4ICBAoCCAMaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShMIAESBAoCZGYYBCICCAQK3gIK2wIKzAKCCcgCCp4CygSaAgq1AQpx4gRuClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShOEgFBIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoThIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE4SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShOGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShOEgNvbmUKRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE4aJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE4SBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoThIHggIECgIIBBoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE4gARIECgJkZhgFIgIIBQq6BQq3BQqoBYIJpAUK+gTKBPYECuABCnGKBW4KUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFASAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShQEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFAaT5IBTAoLGgkKBwoFCgNsaXQaIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFAQASIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFAKhQIKlQH6AZEBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShQEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUBIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUBABGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFAaT5IBTAoLGgkKBwoFCgNsaXQaIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFAQAiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFAKbRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFAaT5IBTAoLGgkKBwoFCgNsaXQaIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFAQAyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFASGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShQEgeCAgQKAggFGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUCABEgQKAmRmGAYiAggGCuUECuIECtMEggnPBAqlBMoEoQQK3QEKmAG6BZQBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShTEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUxIk+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUxIDZm9vGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFMaJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFMSA2ZvbwpDEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUxol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUxIEbnVsbArdAQqYAboFlAEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFMSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShTEiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShTEgNiYXIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShTEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUxok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUxIDYmFyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUxIHggIECgIIBhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFMgARIECgJkZhgHIgIIBwqzAwqwAwqhA4IJnQMK8wLKBO8CCooCCsQBigHAAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVRIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFUSUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFUSAWIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShVGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFUaJfoMIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFUSBGJvdGgKRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFUaJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFUSBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVRIHggIECgIIBxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFUgARIECgJkZhgIIgIICAqrDAqoDAqZDIIJlQwK6wvKBOcLCtoBCpUB+gGRAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgSIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgQARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEgNvbmUKSBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgaKvoMJwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgSCW90aGVyX29uZQraAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBIDdHdvCkgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYGir6DCcKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEglvdGhlcl90d28K3AEKlQH6AZEBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBADGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgaJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgSBXRocmVlCkoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYGiz6DCkKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEgtvdGhlcl90aHJlZQrbAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEAQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBIEZm91cgpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBor+gwoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBIKb3RoZXJfZm91cgrbAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGASAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEAUaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBIEZml2ZQpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBor+gwoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBIKb3RoZXJfZml2ZRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgSB4ICBAoCCAgaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShXIAESBAoCZGYYCSICCAkQARoREg8KDQoFZmluYWwQAxgJIBQiBBABGBc=
