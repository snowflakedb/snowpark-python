## TEST CASE

df = session.table(tables.table1)

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan() , "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

# TODO: SNOW-1546550 fix multiple otherwise calls.
df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(
    when(col("a") == 1, "one")
    .otherwise("other_one")
    .when(col("a") == 2, "two")
    .otherwise("other_two")
    .when(col("a") == 3, "three")
    .otherwise("other_three")
    .when(col("a") == 4, "four")
    .otherwise("other_four")
    .when(col("a") == 5, "five")
    .otherwise("other_five")
)

## EXPECTED UNPARSER OUTPUT

df = session.table("table1")

df = df.select(when(col("bool_col"), "true"))

df = df.select(when(col("A") == 1, "one").when(col("A") <= 2, "two").otherwise("other"))

df = df.select(when(col("A").between(37, 42), col("B")).otherwise(col("C")))

df = df.select(when(col("A").equal_nan(), "one").otherwise("other"))

df = df.select(when(col("a").is_null(), lit(1)).when(col("a") == 1, lit(2)).otherwise(lit(3)))

df = df.select(when(col("a").contains("foo"), "foo").otherwise("null").when(col("a").contains("bar"), "bar"))

df = df.select(when(col("a") & col("b"), "both").otherwise("other"))

df = df.select(when(col("a") == 1, "one").otherwise("other_one").when(col("a") == 2, "two").otherwise("other_two").when(col("a") == 3, "three").otherwise("other_three").when(col("a") == 4, "four").otherwise("other_four").when(col("a") == 5, "five").otherwise("other_five"))

## EXPECTED ENCODED AST

Cj8KPQovggwsEgoKCAoGdGFibGUxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoGSICCAESBAoCZGYYASICCAEK/wEK/AEK7QGCCekBCr8BygS7AQqcAQpXkgFUCgsaCQoHCgUKA2NvbBop+gwmChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoGxIIYm9vbF9jb2wiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgbEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoGxol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoGxIEdHJ1ZRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKBsSB4ICBAoCCAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgbIAESBAoCZGYYAiICCAIK4AQK3QQKzgSCCcoECqAEygScBAraAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB0SAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgdEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgdEAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgdEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHRok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHRIDb25lCtoBCpUBygKRAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHRIBQSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB0SIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB0QAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB0SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgdGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgdEgN0d28KRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB0aJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB0SBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHRIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB0gARIECgJkZhgDIgIIAwr8Awr5AwrqA4IJ5gMKvAPKBLgDCqkCCrgBwgS0AQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHxIBQSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8SIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8QJRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8iIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8QKhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8aUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8SAUIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgfCm4SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgfGlCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgfEgFDIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8SB4ICBAoCCAMaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgfIAESBAoCZGYYBCICCAQK3gIK2wIKzAKCCcgCCp4CygSaAgq1AQpx4gRuClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSghEgFBIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSghGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSghEgNvbmUKRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCEaJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCESBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIRIHggIECgIIBBoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCEgARIECgJkZhgFIgIIBQq6BQq3BQqoBYIJpAUK+gTKBPYECuABCnGKBW4KUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgjEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMaT5IBTAoLGgkKBwoFCgNsaXQaIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMQASIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMKhQIKlQH6AZEBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgjEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIxIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIxABGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMaT5IBTAoLGgkKBwoFCgNsaXQaIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMQAiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMKbRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMaT5IBTAoLGgkKBwoFCgNsaXQaIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMQAyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgjEgeCAgQKAggFGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIyABEgQKAmRmGAYiAggGCuUECuIECtMEggnPBAqlBMoEoQQK3QEKmAG6BZQBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgmEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhIk+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhIDZm9vGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCYaJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCYSA2ZvbwpDEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhIEbnVsbArdAQqYAboFlAEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCYSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgmEiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgmEgNiYXIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgmEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhIDYmFyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhIHggIECgIIBhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCYgARIECgJkZhgHIgIIBwqzAwqwAwqhA4IJnQMK8wLKBO8CCooCCsQBigHAAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKBIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCgSUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCgSAWIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgoGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCgaJfoMIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCgSBGJvdGgKRBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCgaJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCgSBW90aGVyEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKBIHggIECgIIBxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCggARIECgJkZhgIIgIICAqrDAqoDAqZDIIJlQwK6wvKBOcLCtoBCpUB+gGRAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxIBYSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsSIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsQARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgrGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgrEgNvbmUKSBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsaKvoMJwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsSCW90aGVyX29uZQraAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKC0SAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgtEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgtEAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgtEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxIDdHdvCkgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgrGir6DCcKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgrEglvdGhlcl90d28K3AEKlQH6AZEBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgvEgFhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoLxIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoLxADGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoLxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsaJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsSBXRocmVlCkoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgrGiz6DCkKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgrEgtvdGhlcl90aHJlZQrbAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDESAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgxEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgxEAQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgxEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxIEZm91cgpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxor+gwoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxIKb3RoZXJfZm91cgrbAQqVAfoBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDMSAWEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgzEiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgzEAUaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgzEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxol+gwiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxIEZml2ZQpJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxor+gwoChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxIKb3RoZXJfZml2ZRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsSB4ICBAoCCAgaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgqIAESBAoCZGYYCSICCAkQARoREg8KDQoFZmluYWwQAxgJIBIiBBABGBc=
