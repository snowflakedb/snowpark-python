## TEST CASE

df1 = session.create_dataframe([['A', 1, 15, 3.21],
                               ['A', 2, 16, 3.22],
                               ['B', 1, 17, 3.23],
                               ['B', 2, 18, 4.23]],
                              schema=["c1", "c2", "c3", "c4"])
df2 = session.create_dataframe([['A', 1, 14, 3.19],
                                ['B', 2, 16, 3.04]],
                               schema=["c1", "c2", "c3", "c4"])

df1.join(df2, on=(df1.c1 == df2.c1) & (df1.c2 == df2.c2), how="asof",
         match_condition=(df1.c3 >= df2.c3), lsuffix="_L", rsuffix="_R") \
         .order_by("C1_L", "C2_L").collect()

## EXPECTED UNPARSER OUTPUT

res1 = session.create_dataframe([["A", 1, 15, 3.21], ["A", 2, 16, 3.22], ["B", 1, 17, 3.23], ["B", 2, 18, 4.23]], schema=["c1", "c2", "c3", "c4"])

res2 = session.create_dataframe([["A", 1, 14, 3.19], ["B", 2, 16, 3.04]], schema=["c1", "c2", "c3", "c4"])

res1.join(res2, on=(res1["c1"] == res2["c1"]) & (res1["c2"] == res2["c2"]), how="asof").sort("C1_L", "C2_L").collect()

## EXPECTED ENCODED AST

CqQGCqEGCpYG0gWSBgrfBQrcBQq0AaICsAEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiLyCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgFBEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAESIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQDxIo4gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhGuR+F6FK4JQAq0AaICsAEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiLyCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgFBEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAISIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQEBIo4gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhHD9Shcj8IJQAq0AaICsAEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiLyCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgFCEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAESIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQERIo4gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhHXo3A9CtcJQAq0AaICsAEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiLyCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgFCEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAISIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQEhIo4gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhHsUbgehesQQBISChAKAmMxCgJjMgoCYzMKAmM0GhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIAGAEiAggBCrYDCrMDCqgD0gWkAwrxAgruAgq0AaICsAEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShfEiLyCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShfEgFBEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShfEAESIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF8QDhIo4gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXxGF61G4HoUJQAq0AaICsAEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShfEiLyCx8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShfEgFCEiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShfEAISIZICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF8QEBIo4gElChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXxFSuB6F61EIQBISChAKAmMxCgJjMgoCYzMKAmM0GhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXxIAGAIiAggCCukDCuYDCtsDygfXAwqZAnKWAgp72gF4CiyiBikKAmMxEgeKAgQKAggBGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYxIsogYpCgJjMRIHigIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGMaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShjEnvaAXgKLKIGKQoCYzISB4oCBAoCCAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShjEiyiBikKAmMyEgeKAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGMaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShjEgIIARoHigIECgIIASIECgJfTCp78gF4CiyiBikKAmMzEgeKAgQKAggBGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIsogYpCgJjMxIHigIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkMgeKAgQKAggCOgQKAl9SQhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYxIAGAMiAggDCoUBCoIBCniCCXUSJfILIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGMSBEMxX0wSJfILIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGMSBEMyX0wYASIHigIECgIIAyoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGMSABgEIgIIBAozCjEKJ6oGJAgBEAEaAggEMhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYxIAGAUiAggFCggSBggGEgIIBRABGhESDwoNCgVmaW5hbBADGAggEyIEEAEYFQ==
EAEaERIPCg0KBWZpbmFsEAMYCCATIgQQARgV
