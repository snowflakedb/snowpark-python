## TEST CASE

df1 = session.create_dataframe([['A', 1, 15, 3.21],
                               ['A', 2, 16, 3.22],
                               ['B', 1, 17, 3.23],
                               ['B', 2, 18, 4.23]],
                              schema=["c1", "c2", "c3", "c4"])
df2 = session.create_dataframe([['A', 1, 14, 3.19],
                                ['B', 2, 16, 3.04]],
                               schema=["c1", "c2", "c3", "c4"])

df1.join(df2, on=(df1.c1 == df2.c1) & (df1.c2 == df2.c2), how="asof",
         match_condition=(df1.c3 >= df2.c3), lsuffix="_L", rsuffix="_R") \
         .order_by("C1_L", "C2_L").collect()

## EXPECTED UNPARSER OUTPUT

df1 = session.create_dataframe([["A", 1, 15, 3.21], ["A", 2, 16, 3.22], ["B", 1, 17, 3.23], ["B", 2, 18, 4.23]], schema=["c1", "c2", "c3", "c4"])

df2 = session.create_dataframe([["A", 1, 14, 3.19], ["B", 2, 16, 3.04]], schema=["c1", "c2", "c3", "c4"])

df1.join(df2, on=(df1["c1"] == df2["c1"]) & (df1["c2"] == df2["c2"]), how="asof", lsuffix="_L", rsuffix="_R", match_condition=df1["c3"] >= df2["c3"]).sort("C1_L", "C2_L").collect()

## EXPECTED ENCODED AST

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
EAEaERIPCg0KBWZpbmFsEAMYCyAJIgQQARgV
