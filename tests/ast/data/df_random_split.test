## TEST CASE

df = session.table("test_table")

# Single weight means returning the dataframe itself.

# df, = df.random_split([0.7])

weights = [0.1, 0.2, 0.3]

df1, df2, df3 = df.random_split(weights)

# One more time, with different symbol order.

df3, df1, df2 = df.random_split(weights, seed=24)

df1.select(col("NUM") > lit(10)).collect()

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df1_res1 = df.random_split([0.1, 0.2, 0.3], None)

df1 = df1_res1[0]

df2 = df1_res1[1]

df3 = df1_res1[2]

df3_res2 = df.random_split([0.1, 0.2, 0.3], 24)

df3 = df3_res2[0]

df1 = df3_res2[1]

df2 = df3_res2[2]

df1.select(col("NUM") > lit(10)).collect()

## EXPECTED ENCODED AST

CkMKQQozqgswEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoiAggBEgQKAmRmGAEiAggBClMKUQpCsgg/CgeKAgQKAggBGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYioYmpmZmZmZuT+amZmZmZnJPzMzMzMzM9M/EgUKA2RmMRgCIgIIAgpVClMKROoCQQofkgIcChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhICCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgUKA2RmMRgDIgIIAwpXClUKRuoCQwohkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhABEgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISBQoDZGYyGAQiAggEClcKVQpG6gJDCiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEAISAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIFCgNkZjMYBSICCAUKVwpVCkayCEMKB4oCBAoCCAESAggYGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZioYmpmZmZmZuT+amZmZmZnJPzMzMzMzM9M/EgUKA2RmMxgGIgIIBgpVClMKROoCQQofkgIcChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhICCAYaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEgUKA2RmMxgHIgIIBwpXClUKRuoCQwohkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhABEgIIBhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYSBQoDZGYxGAgiAggIClcKVQpG6gJDCiGSAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEAISAggGGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIFCgNkZjIYCSICCAkKtwIKtAIKqQLqCKUCCvsB+gH3AQptemsKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBok8gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBIDTlVNIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBJqemgKJwolCgcKBQoDbGl0EhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBohkgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBAKIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSB4oCBAoCCAgaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoIAESABgKIgIICgozCjEKJ6oGJAgBEAEaAggKMhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBIAGAsiAggLCggSBggMEgIICxABGhESDwoNCgVmaW5hbBADGAggEyIEEAEYFQ==
EAEaERIPCg0KBWZpbmFsEAMYCCATIgQQARgV
