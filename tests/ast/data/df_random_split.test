## TEST CASE

df = session.table(tables.table1)

# Single weight means returning the dataframe itself.

# df, = df.random_split([0.7])

weights = [0.1, 0.2, 0.3]

df1, df2, df3 = df.random_split(weights)

# One more time, with different symbol order.

df3, df1, df2 = df.random_split(weights, seed=24)

df1.select(col("NUM") > lit(10)).collect()

t = df.random_split([0.1, 0.2, 0.3], 24)

t[0].collect()

## EXPECTED UNPARSER OUTPUT

df = session.table("table1")

res1 = df.random_split([0.1, 0.2, 0.3], None)

df1 = res1[0]

df2 = res1[1]

df3 = res1[2]

res2 = df.random_split([0.1, 0.2, 0.3], 24)

df3 = res2[0]

df1 = res2[1]

df2 = res2[2]

df1.select(col("NUM") > lit(10)).collect()

t = df.random_split([0.1, 0.2, 0.3], 24)

res6 = t[1]

res7 = t[2]

t[0].collect()

## EXPECTED ENCODED AST

Cj8KPQovggwsEgoKCAoGdGFibGUxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoGSICCAESBAoCZGYYASICCAEKTgpMCkLKCD8KB4ICBAoCCAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSghKhiamZmZmZm5P5qZmZmZmck/MzMzMzMz0z8SABgCIgIIAgpVClMKRJoDQQofwgIcChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIRICCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSghEgUKA2RmMRgDIgIIAwpXClUKRpoDQwohwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIRABEgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCESBQoDZGYyGAQiAggEClcKVQpGmgNDCiHCAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSghEAISAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIRIFCgNkZjMYBSICCAUKUgpQCkbKCEMKB4ICBAoCCAESAggYGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJSoYmpmZmZmZuT+amZmZmZnJPzMzMzMzM9M/EgAYBiICCAYKVQpTCkSaA0EKH8ICHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCUSAggGGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJRIFCgNkZjMYByICCAcKVwpVCkaaA0MKIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCUQARICCAYaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSglEgUKA2RmMRgIIgIICApXClUKRpoDQwohwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJRACEgIIBhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCUSBQoDZGYyGAkiAggJCoECCv4BCvMBggnvAQrFAZoCwQEKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCcSA05VTSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCcST5IBTAoLGgkKBwoFCgNsaXQaIcICHgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCcQCiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCcaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgnEgeCAgQKAggIGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJyABEgAYCiICCAoKMwoxCifSBiQIARABGgIICjIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCcSABgLIgIICwoIEgYIDBICCAsQARoREg8KDQoFZmluYWwQAxgJIBQiBBABGBc=
ClUKUwpGyghDCgeCAgQKAggBEgIIGBoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCkqGJqZmZmZmbk/mpmZmZmZyT8zMzMzMzPTPxIDCgF0GA0iAggNClAKTgpEmgNBCh/CAhwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgpEgIIDRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCkSABgOIgIIDgpSClAKRpoDQwohwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKRABEgIIDRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCkSABgPIgIIDwpSClAKRpoDQwohwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKRACEgIIDRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCkSABgQIgIIEAozCjEKJ9IGJAgBEAEaAggOMhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxIAGBEiAggRCggSBggSEgIIERABGhESDwoNCgVmaW5hbBADGAkgFCIEEAEYFw==
EAEaERIPCg0KBWZpbmFsEAMYCSAUIgQQARgX
