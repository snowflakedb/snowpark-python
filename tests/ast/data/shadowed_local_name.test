## TEST CASE

df = session.table(tables.table1).drop(col("NUM"))

def foo(p):
  df = p.distinct()
  return df

df3 = foo(df)

df4 = df.flatten("STR", "path", True, False)

## EXPECTED UNPARSER OUTPUT

df = session.table("table1")

df_res1 = df.drop(col("NUM"))

df = df_res1.distinct()

df4 = df_res1.flatten("STR", Some("path"), True, False, "BOTH")

## EXPECTED ENCODED AST

Cj8KPQovggwsEgoKCAoGdGFibGUxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUCICCAESBAoCZGYYASICCAEKkgEKjwEKgAGaB30KVgpSkgFPCgsaCQoHCgUKA2NvbBok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUBIDTlVNIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUBABEgeCAgQKAggBGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUBIECgJkZhgCIgIIAgo4CjYKKJIHJQoHggIECgIIAhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFMSBAoCZGYYAyICCAMKbQprClzCB1kKB4ICBAoCCAISJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgSA1NUUhoCEAEgASoGCgRwYXRoOhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBIFCgNkZjQYBCICCAQQARoREg8KDQoFZmluYWwQAxgJIBMiBBABGBc=
