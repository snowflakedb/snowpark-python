## TEST CASE

df = session.table("test_table").drop(col("NUM"))

def foo(p):
  df = p.distinct()
  return df

df3 = foo(df)

df4 = df.flatten("STR", "path", True, False)

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df_res1 = df.drop(col("NUM"))

df = df_res1.distinct()

df4 = df_res1.flatten("STR", Some("path"), True, False, "BOTH")

## EXPECTED ENCODED AST

CkkKRwo5sgs2Eg4KDAoKdGVzdF90YWJsZRogCCgQWhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKFoiAggBEgQKAmRmGAEiAggBCscBCsQBCrUB8gaxAQqDAQp/en0KLQorCgcKBQoDY29sEiAIOBBaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIC4oWhoq+gsnCiAIOBBaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIC4oWhIDTlVNIiAIOBBaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIC4oWhABEgeKAgQKAggBGiAIORBaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oWhIECgJkZhgCIgIIAgo+CjwKLuoGKwoHigIECgIIAhIgCBsQXRoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAPKF0SBAoCZGYYAyICCAMKeQp3CmiaB2UKB4oCBAoCCAISKvoLJwogCDQQYhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAOKGISA1NUUhoCEAEgASoGCgRwYXRoOiAINBBiGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oYhIFCgNkZjQYBCICCAQQARoREg8KDQoFZmluYWwQAxgLIAkiBBABGBU=
