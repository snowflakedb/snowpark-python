## TEST CASE

import datetime
import decimal

df = session.table(tables.table1)

df = df.select(col("A") + None)

df = df.select(col("A") + True)

df = df.select(col("A") + False)

df = df.select(col("A") + 42)

df = df.select(col("A") + 42.24)

df = df.select(col("A") + "test")

df = df.select(col("A") + bytearray("test", 'utf-8'))

df = df.select(col("A") + bytes("test", 'utf-8'))

df = df.select(col("A") + datetime.datetime(2024, 6, 7, 23, 15, 33, 403587))

df = df.select(col("A") + datetime.datetime(2024, 6, 7, 23, 15, 33, 403587, datetime.timezone(datetime.timedelta(hours=3, minutes=15), name="test")))

df = df.select(col("A") + datetime.datetime(2024, 6, 7, 23, 15, 33, 403587, datetime.timezone(datetime.timedelta(hours=-3, minutes=-15))))

df = df.select(col("A") + datetime.date(2024, 6, 7))

df = df.select(col("A") + datetime.time(5, 42, 23, 403587))

df = df.select(col("A") + datetime.time(5, 42, 23, 403587, datetime.timezone(datetime.timedelta(hours=3, minutes=15), name="test")))

df = df.select(col("A") + datetime.time(5, 42, 23, 403587, datetime.timezone(datetime.timedelta(hours=-3, minutes=-15))))

df = df.select(col("A") + decimal.Decimal("403487.436973"))

df = df.select(col("A") + decimal.Decimal("-403487.436973"))

df = df.select(col("A") + decimal.Decimal(403487))

df = df.select(col("A") + decimal.Decimal(403487000))

df = df.select(col("A") + {0: "test", 42.24: None, "hello": bytes("test", 'utf-8'), True: decimal.Decimal("-403487.436973"), None: datetime.date(2024, 6, 7)})

df = df.select(col("A") + [(0, "test", 42.24), None, "hello", bytes("test", 'utf-8'), {True: decimal.Decimal("-403487.436973"), None: datetime.date(2024, 6, 7)}])

df = df.select(col("A") + (0, ("test", 42.24, {None: ("hello", bytes("test", 'utf-8'))}), [True, decimal.Decimal("-403487.436973"), {None: datetime.date(2024, 6, 7)}]))


## EXPECTED UNPARSER OUTPUT

df = session.table("table1")

df = df.select(col("A") + None)

df = df.select(col("A") + True)

df = df.select(col("A") + False)

df = df.select(col("A") + 42)

df = df.select(col("A") + 42.24)

df = df.select(col("A") + "test")

df = df.select(col("A") + bytes("test", "utf-8"))

df = df.select(col("A") + bytes("test", "utf-8"))

df = df.select(col("A") + datetime.datetime(2024, 6, 7, 23, 15, 33, 403587, tzinfo=datetime.timezone(datetime.timedelta(seconds=-18000), name="EST")))

df = df.select(col("A") + datetime.datetime(2024, 6, 7, 23, 15, 33, 403587, tzinfo=datetime.timezone(datetime.timedelta(seconds=11700), name="test")))

df = df.select(col("A") + datetime.datetime(2024, 6, 7, 23, 15, 33, 403587, tzinfo=datetime.timezone(datetime.timedelta(seconds=-11700), name="UTC-03:15")))

df = df.select(col("A") + datetime.date(2024, 6, 7))

df = df.select(col("A") + datetime.time(5, 42, 23, 403587, tzinfo=datetime.timezone(datetime.timedelta(seconds=-18000), name="EST")))

df = df.select(col("A") + datetime.time(5, 42, 23, 403587, tzinfo=datetime.timezone(datetime.timedelta(seconds=11700), name="test")))

df = df.select(col("A") + datetime.time(5, 42, 23, 403587, tzinfo=datetime.timezone(datetime.timedelta(seconds=-11700), name="UTC-03:15")))

df = df.select(col("A") + decimal.Decimal("403487.436973"))

df = df.select(col("A") + decimal.Decimal("-403487.436973"))

df = df.select(col("A") + decimal.Decimal("403487"))

df = df.select(col("A") + decimal.Decimal("403487000"))

df = df.select(col("A") + {0: "test", 42.24: None, "hello": bytes("test", "utf-8"), True: decimal.Decimal("-403487.436973"), None: datetime.date(2024, 6, 7)})

df = df.select(col("A") + [(0, "test", 42.24), None, "hello", bytes("test", "utf-8"), {True: decimal.Decimal("-403487.436973"), None: datetime.date(2024, 6, 7)}])

df = df.select(col("A") + (0, ("test", 42.24, {None: ("hello", bytes("test", "utf-8"))}), [True, decimal.Decimal("-403487.436973"), {None: datetime.date(2024, 6, 7)}]))

## EXPECTED ENCODED AST

Cj8KPQovggwsEgoKCAoGdGFibGUxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHCICCAESBAoCZGYYASICCAEK0wEK0AEKwQGCCb0BCpMBggGPAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHhIBQSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB4SH5IDHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB4aGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgeEgeCAgQKAggBGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHiABEgQKAmRmGAIiAggCCtUBCtIBCsMBggm/AQqVAYIBkQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCASAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSggEiHKAR4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSggEAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSggEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoICABEgQKAmRmGAMiAggDCtMBCtABCsEBggm9AQqTAYIBjwEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCISAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgiEh/KARwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgiGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIhIHggIECgIIAxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCIgARIECgJkZhgEIgIIBArVAQrSAQrDAYIJvwEKlQGCAZEBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgkEgFBIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJBIhwgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJBAqGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJBIHggIECgIIBBoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCQgARIECgJkZhgFIgIIBQrcAQrZAQrKAYIJxgEKnAGCAZgBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgmEgFBIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhIoggIlChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJhEfhetRuB5FQBoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCYSB4ICBAoCCAUaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgmIAESBAoCZGYYBiICCAYK2QEK1gEKxwGCCcMBCpkBggGVAQpQkgFNCgsaCQoHCgUKA2NvbBoi+gwfChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKBIBQSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCgSJfoMIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCgSBHRlc3QaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgoEgeCAgQKAggGGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKCABEgQKAmRmGAciAggHCtkBCtYBCscBggnDAQqZAYIBlQEKUJIBTQoLGgkKBwoFCgNjb2waIvoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCoSAUEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgqEiWqASIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgqEgR0ZXN0GhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKhIHggIECgIIBxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCogARIECgJkZhgIIgIICArZAQrWAQrHAYIJwwEKmQGCAZUBClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgsEgFBIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoLBIlqgEiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoLBIEdGVzdBoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCwSB4ICBAoCCAgaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgsIAESBAoC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SVRJT05fVEVTVF9NT0RFKEQSqwOSBKcDCkgSH8ICHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEQSJfoMIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEQSBHRlc3QKSxIoggIlChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRBEfhetRuB5FQBIfkgMcChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRApPEib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShEEgVoZWxsbxIlqgEiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRBIEdGVzdApWEiHKAR4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShEEAESMZoBLgj6//////////8BEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRBoFog5GT1MKSRIfkgMcChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRBIm6gMjCAcQBhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEQg6A8SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShEGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRBIHggIECgIIFBoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEQgARIECgJkZhgVIgIIFQqgBQqdBQqOBYIJigUK4ASCAdwEClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShGEgFBIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRhLrA9IC5wMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShGEpIBmg2OAQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEYSH8ICHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEYSJfoMIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEYSBHRlc3QSKIICJQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEYRH4XrUbgeRUASH5IDHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEYSJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEYSBWhlbGxvEiWqASIKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShGEgR0ZXN0EsMBkgS/AQpWEiHKAR4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShGEAESMZoBLgj6//////////8BEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRhoFog5GT1MKSRIfkgMcChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRhIm6gMjCAcQBhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEYg6A8SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShGGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRhIHggIECgIIFRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEYgARIECgJkZhgWIgIIFgqGBgqDBgr0BYIJ8AUKxgWCAcIFClCSAU0KCxoJCgcKBQoDY29sGiL6DB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShIEgFBIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSBLRBJoNzQQKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShIEh/CAhwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShIEqgCmg2kAgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEgSJfoMIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEgSBHRlc3QSKIICJQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEgRH4XrUbgeRUAStAGSBLABCpEBEh+SAxwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShIEm6aDWsKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShIEib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShIEgVoZWxsbxIlqgEiChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSBIEdGVzdBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEgS4gHSAt4BChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSBIhygEeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSBABEjGaAS4I+v//////////ARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEgaBaIORk9TEmqSBGcKSRIfkgMcChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSBIm6gMjCAcQBhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEgg6A8SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShIGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSBIHggIECgIIFhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEggARIECgJkZhgXIgIIFxABGhESDwoNCgVmaW5hbBADGAkgEiIEEAEYFw==
