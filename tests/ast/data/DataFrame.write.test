## TEST CASE

from snowflake.snowpark.functions import col

df = session.table(tables.table1)

df.write.save_as_table("saved_table")

df.write.mode("overwrite").save_as_table("saved_table", table_type="temporary")

df.write.mode("overwrite").save_as_table("saved_table", table_type="temporary", mode="ignore")

df.write.mode("truncate").save_as_table("test_destination", column_order="name", create_temp_table=False, table_type="transient", clustering_keys=['STR', col('num1')], comment="test", block=True, statement_params={"k":"v"})

stage_created_result = session.sql("create temp stage if not exists test_stage").collect()

df.write.copy_into_location("@test_stage/copied_from_dataframe")

remote_file_path = "@test_stage/copied_from_dataframe"

df.write.copy_into_location(remote_file_path, file_format_type="parquet", header=True, overwrite=True, single=True)

df.write.copy_into_location(remote_file_path, file_format_name="csv", format_type_options={"compression":"bzip2"}, block=False, INCLUDE_QUERY_ID=True, DETAILED_OUTPUT=False)

df.write.copy_into_location(remote_file_path, file_format_name="csv", format_type_options={"compression":"bzip2", "binary_format":"base64"}, block=False, INCLUDE_QUERY_ID=True, DETAILED_OUTPUT=False)

remote_file_path = "@test_stage/test.csv"

df.write.csv(remote_file_path, header=True, format_type_options={"compression":"bzip2"}, overwrite=True, single=True)

remote_file_path = "@test_stage/test.json"

df.write.json(remote_file_path, overwrite=True, single=True, format_type_options={"compression":"bzip2"},)

remote_file_path = "@test_stage/test.parquet"

df.write.parquet(remote_file_path, format_type_options={"compression":"bzip2"}, header=False, overwrite=True, single=True)

## EXPECTED UNPARSER OUTPUT

df = session.table("table1")

df.write.save_as_table("saved_table")

df.write.mode("overwrite").save_as_table("saved_table", table_type="temporary")

df.write.mode("overwrite").save_as_table("saved_table", mode="ignore", table_type="temporary")

df.write.mode("truncate").save_as_table("test_destination", column_order="name", table_type="transient", clustering_keys=["STR", col("num1")], statement_params={"k": "v"}, comment="test")

stage_created_result = session.sql("create temp stage if not exists test_stage")

stage_created_result.collect()

df.write.copy_into_location("@test_stage/copied_from_dataframe")

df.write.copy_into_location("@test_stage/copied_from_dataframe", file_format_type="parquet", header=True, overwrite=True, single=True)

df.write.copy_into_location("@test_stage/copied_from_dataframe", file_format_name="csv", format_type_options={"compression": "bzip2"}, block=False, INCLUDE_QUERY_ID=True, DETAILED_OUTPUT=False)

df.write.copy_into_location("@test_stage/copied_from_dataframe", file_format_name="csv", format_type_options={"compression": "bzip2", "binary_format": "base64"}, block=False, INCLUDE_QUERY_ID=True, DETAILED_OUTPUT=False)

df.write.csv("@test_stage/test.csv", format_type_options={"compression": "bzip2"}, header=True, overwrite=True, single=True)

df.write.json("@test_stage/test.json", format_type_options={"compression": "bzip2"}, overwrite=True, single=True)

df.write.parquet("@test_stage/test.parquet", format_type_options={"compression": "bzip2"}, overwrite=True, single=True)

## EXPECTED ENCODED AST

Cj8KPQovggwsEgoKCAoGdGFibGUxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoGyICCAESBAoCZGYYASICCAEKNAoyCiiyCiUKB4ICBAoCCAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgdEgAYAiICCAIKSgpICj7qDDsIASIFaW5kZXhaAggCchoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHYIBDwoNCgtzYXZlZF90YWJsZRIAGAMiAggDCggSBggEEgIIAxABGhESDwoNCgVmaW5hbBADGAkgEiIEEAEYFw==
CjgKNgossgopCgeCAgQKAggBEgIgARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8SABgFIgIIBQpWClQKSuoMRwgBIgVpbmRleFoCCAVyGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgfggEPCg0KC3NhdmVkX3RhYmxligEJdGVtcG9yYXJ5EgAYBiICCAYKCBIGCAcSAggGEAEaERIPCg0KBWZpbmFsEAMYCSASIgQQARgX
CjgKNgossgopCgeCAgQKAggBEgIgARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCESABgIIgIICApaClgKTuoMSwgBIgVpbmRleFoCCAhqAhgBchoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIYIBDwoNCgtzYXZlZF90YWJsZYoBCXRlbXBvcmFyeRIAGAkiAggJCggSBggKEgIICRABGhESDwoNCgVmaW5hbBADGAkgEiIEEAEYFw==
CjgKNgossgopCgeCAgQKAggBEgIoARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMSABgLIgIICwrqAQrnAQrcAeoM2AEIARp7CiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgjEgNTVFIKU5IBUAoLGgkKBwoFCgNjb2waJfoMIgoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMSBG51bTEiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgjIgRuYW1lKgYKBHRlc3RaAggLchoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoI3oGCgFrEgF2ggEUChIKEHRlc3RfZGVzdGluYXRpb26KAQl0cmFuc2llbnQSABgMIgIIDAoIEgYIDRICCAwQARoREg8KDQoFZmluYWwQAxgJIBIiBBABGBc=
Cm0KawpL8gtIEipjcmVhdGUgdGVtcCBzdGFnZSBpZiBub3QgZXhpc3RzIHRlc3Rfc3RhZ2UaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSglEhYKFHN0YWdlX2NyZWF0ZWRfcmVzdWx0GA4iAggOCjMKMQon0gYkCAEQARoCCA4yGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSglEgAYDyICCA8KCBIGCBASAggPEAEaERIPCg0KBWZpbmFsEAMYCSASIgQQARgX
CjQKMgoosgolCgeCAgQKAggBGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJxIAGBEiAggRClQKUgpIwgxFCAE6AggRQiFAdGVzdF9zdGFnZS9jb3BpZWRfZnJvbV9kYXRhZnJhbWVSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgnEgAYEiICCBIKCBIGCBMSAggSEAEaERIPCg0KBWZpbmFsEAMYCSASIgQQARgX
CjQKMgoosgolCgeCAgQKAggBGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxIAGBQiAggUCsEBCr4BCrMBwgyvAQgBEi4KCW92ZXJ3cml0ZRIhygEeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxABEisKBnNpbmdsZRIhygEeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxABIgkKB3BhcnF1ZXQwAToCCBRCIUB0ZXN0X3N0YWdlL2NvcGllZF9mcm9tX2RhdGFmcmFtZVIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsSABgVIgIIFQoIEgYIFhICCBUQARoREg8KDQoFZmluYWwQAxgJIBIiBBABGBc=
CjQKMgoosgolCgeCAgQKAggBGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoLRIAGBciAggXCt0BCtoBCs8BwgzLARI1ChBJTkNMVURFX1FVRVJZX0lEEiHKAR4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgtEAESMgoPREVUQUlMRURfT1VUUFVUEh/KARwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgtGgUKA2NzdioUCgtjb21wcmVzc2lvbhIFYnppcDI6AggXQiFAdGVzdF9zdGFnZS9jb3BpZWRfZnJvbV9kYXRhZnJhbWVSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgtEgAYGCICCBgKCBIGCBkSAggYEAEaERIPCg0KBWZpbmFsEAMYCSASIgQQARgX
CjQKMgoosgolCgeCAgQKAggBGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoLxIAGBoiAggaCvYBCvMBCugBwgzkARI1ChBJTkNMVURFX1FVRVJZX0lEEiHKAR4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgvEAESMgoPREVUQUlMRURfT1VUUFVUEh/KARwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgvGgUKA2NzdioUCgtjb21wcmVzc2lvbhIFYnppcDIqFwoNYmluYXJ5X2Zvcm1hdBIGYmFzZTY0OgIIGkIhQHRlc3Rfc3RhZ2UvY29waWVkX2Zyb21fZGF0YWZyYW1lUhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoLxIAGBsiAggbCggSBggcEgIIGxABGhESDwoNCgVmaW5hbBADGAkgEiIEEAEYFw==
CjQKMgoosgolCgeCAgQKAggBGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoMxIAGB0iAggdCr8BCrwBCrEBygytAQgBEi4KCW92ZXJ3cml0ZRIhygEeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoMxABEisKBnNpbmdsZRIhygEeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoMxABGhQKC2NvbXByZXNzaW9uEgViemlwMiABKgIIHTIUQHRlc3Rfc3RhZ2UvdGVzdC5jc3ZCGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgzEgAYHiICCB4KCBIGCB8SAggeCjQKMgoosgolCgeCAgQKAggBGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoNxIAGCAiAgggCr4BCrsBCrAB0gysAQgBEi4KCW92ZXJ3cml0ZRIhygEeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoNxABEisKBnNpbmdsZRIhygEeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoNxABGhQKC2NvbXByZXNzaW9uEgViemlwMioCCCAyFUB0ZXN0X3N0YWdlL3Rlc3QuanNvbkIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDcSABghIgIIIQoIEgYIIhICCCEKNAoyCiiyCiUKB4ICBAoCCAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSg7EgAYIyICCCMKwQEKvgEKswHiDK8BCAESLgoJb3ZlcndyaXRlEiHKAR4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSg7EAESKwoGc2luZ2xlEiHKAR4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSg7EAEaFAoLY29tcHJlc3Npb24SBWJ6aXAyKgIIIzIYQHRlc3Rfc3RhZ2UvdGVzdC5wYXJxdWV0QhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoOxIAGCQiAggkCggSBgglEgIIJBABGhESDwoNCgVmaW5hbBADGAkgEiIEEAEYFw==
