## TEST CASE

from snowflake.snowpark.functions import col, truncate, bucket, day, year, month, hour

df = session.table(tables.table1)

df.write.save_as_table("saved_table")

df.write.mode("overwrite").save_as_table("saved_table", table_type="temporary")

df.write.mode("overwrite").save_as_table("saved_table", table_type="temporary", mode="ignore")

df.write.mode("overwrite").save_as_table("saved_table", mode="ignore", iceberg_config={"external_volume": "example_volume", "catalog": "example_catalog", "base_location": "/root", "catalog_sync": "integration_name", "storage_serialization_policy": "OPTIMIZED", "iceberg_version": 3})

df.write.mode("overwrite").save_as_table("iceberg_table_with_bucket", iceberg_config={"external_volume": "example_volume", "partition_by": [bucket(10, "A")]})

df.write.mode("overwrite").save_as_table("iceberg_table_with_truncate", iceberg_config={"external_volume": "example_volume", "partition_by": [truncate(5, "B")]})

df.write.mode("overwrite").save_as_table("iceberg_table_with_transforms", iceberg_config={"external_volume": "example_volume", "partition_by": [year("date_col"), month("date_col"), day("date_col"), hour("timestamp_col")]})

df.write.mode("overwrite").save_as_table("iceberg_table_mixed", iceberg_config={"external_volume": "example_volume", "partition_by": [col("A"), bucket(20, "B"), truncate(3, col("C"))]})

df.write.mode("overwrite").save_as_table("iceberg_table_target_size", iceberg_config={"external_volume": "example_volume", "target_file_size": "64MB"})

df.write.mode("overwrite").save_as_table("iceberg_table_full", iceberg_config={"external_volume": "example_volume", "partition_by": [bucket(10, "A"), year("date_col")], "target_file_size": "AUTO", "catalog": "my_catalog"})

df.write.mode("overwrite").save_as_table("saved_table", table_type="temporary", table_exists=True, overwrite_condition=(col("A") > 4) | (col("B") == "c"))

df.write.mode("overwrite").save_as_table("saved_table", table_type="temporary", table_exists=True, overwrite_condition="A = 1 or B = 'b'")

df.write.mode("truncate").save_as_table("test_destination", column_order="name", create_temp_table=False, table_type="transient", clustering_keys=['STR', col('num1')], comment="test", block=True, statement_params={"k":"v"})

df.write.partition_by("value").mode("overwrite").save_as_table("saved_table", table_type="temporary")

df.write.partition_by(col("value")).mode("overwrite").save_as_table("saved_table", table_type="temporary")

df.write.option("copy_into_location", "abcd").partition_by(col("value")).mode("overwrite").save_as_table("saved_table", table_type="temporary")

df.write.option("copy_into_location", "abcd").option("copy_into_location", "pqrs").option("overwrite", True).option("mode", "append").partition_by(col("value")).mode("overwrite").save_as_table("saved_table", table_type="temporary")

stage_created_result = session.sql("create temp stage if not exists test_stage").collect()

df.write.copy_into_location("@test_stage/copied_from_dataframe")

remote_file_path = "@test_stage/copied_from_dataframe"

df.write.copy_into_location(remote_file_path, file_format_type="parquet", header=True, overwrite=True, single=True)

df.write.copy_into_location(remote_file_path, file_format_name="csv", format_type_options={"compression":"bzip2"}, block=False, INCLUDE_QUERY_ID=True, DETAILED_OUTPUT=False)

df.write.copy_into_location(remote_file_path, file_format_name="csv", format_type_options={"compression":"bzip2", "binary_format":"base64"}, block=False, INCLUDE_QUERY_ID=True, DETAILED_OUTPUT=False)

remote_file_path = "@test_stage/test.csv"

df.write.csv(remote_file_path, header=True, format_type_options={"compression":"bzip2"}, overwrite=True, single=True)

df.write.format("csv").option("header", True).mode("overwrite").save(remote_file_path, format_type_options={"compression":"bzip2"})

remote_file_path = "@test_stage/test.json"

df.write.json(remote_file_path, overwrite=True, single=True, format_type_options={"compression":"bzip2"},)

df.write.format("json").mode("overwrite").save(remote_file_path, format_type_options={"compression":"bzip2"})

remote_file_path = "@test_stage/test.parquet"

df.write.parquet(remote_file_path, format_type_options={"compression":"bzip2"}, header=False, overwrite=True, single=True)

df.write.format("parquet").mode("overwrite").save(remote_file_path, format_type_options={"compression":"bzip2"})

df.write.insert_into("saved_table", overwrite=True)

df.write.insert_into("saved_table", overwrite=False)

df = session.table(tables.table2)

df.write.copy_into_location("s3://testbucket", storage_integration="test_integration")

df.write.copy_into_location("azure://testcontainer", validation_mode="RETURN_ROWS", storage_integration="test_integration")

df.write.copy_into_location("gcp://teststorage", credentials={}, encryption={})

df.write.copy_into_location("gcp://teststorage", credentials={"AWS_KEY_ID": "awsid", "AWS_SECRET_KEY": "!23@"}, encryption={"TYPE": None, "MASTER_KEY": "master key"})

df.write.parquet("azure://testcontainer", validation_mode="RETURN_3_ROWS", storage_integration="test_integration")

df.write.json("s3://testbucket", credentials={"AWS_KEY_ID": "awsid", "AWS_SECRET_KEY": "!23@"}, encryption={"TYPE": None, "MASTER_KEY": "master key"})

df.write.csv("azure://testcontainer", validation_mode="RETURN_3_ROWS", storage_integration="test_integration", credentials={}, encryption={})

df.write.format("json").save("gcp://teststorage", partition_by="value", storage_integration="test_integration", credentials={"AWS_KEY_ID": "awsid", "AWS_SECRET_KEY": "!23@"}, encryption={"TYPE": None, "MASTER_KEY": "master key"})

## EXPECTED UNPARSER OUTPUT

df = session.table("table1")

df.write.save_as_table("saved_table")

df = session.table("table1")

df.write.mode("overwrite").save_as_table("saved_table", table_type="temporary")

df = session.table("table1")

df.write.mode("overwrite").save_as_table("saved_table", mode="ignore", table_type="temporary")

df = session.table("table1")

df.write.mode("overwrite").save_as_table("saved_table", mode="ignore", iceberg_config={"external_volume": "example_volume", "catalog": "example_catalog", "base_location": "/root", "catalog_sync": "integration_name", "storage_serialization_policy": "OPTIMIZED", "iceberg_version": 3})

df = session.table("table1")

df.write.mode("overwrite").save_as_table("iceberg_table_with_bucket", iceberg_config={"external_volume": "example_volume", "partition_by": [bucket(10, "A")]})

df = session.table("table1")

df.write.mode("overwrite").save_as_table("iceberg_table_with_truncate", iceberg_config={"external_volume": "example_volume", "partition_by": [truncate(5, "B")]})

df = session.table("table1")

df.write.mode("overwrite").save_as_table("iceberg_table_with_transforms", iceberg_config={"external_volume": "example_volume", "partition_by": [year("date_col"), month("date_col"), day("date_col"), hour("timestamp_col")]})

df = session.table("table1")

df.write.mode("overwrite").save_as_table("iceberg_table_mixed", iceberg_config={"external_volume": "example_volume", "partition_by": [col("A"), bucket(20, "B"), truncate(3, col("C"))]})

df = session.table("table1")

df.write.mode("overwrite").save_as_table("iceberg_table_target_size", iceberg_config={"external_volume": "example_volume", "target_file_size": "64MB"})

df = session.table("table1")

df.write.mode("overwrite").save_as_table("iceberg_table_full", iceberg_config={"external_volume": "example_volume", "partition_by": [bucket(10, "A"), year("date_col")], "target_file_size": "AUTO", "catalog": "my_catalog"})

df = session.table("table1")

df.write.mode("overwrite").save_as_table("saved_table", table_type="temporary", table_exists=True, overwrite_condition=(col("A") > 4) | (col("B") == "c"))

df = session.table("table1")

df.write.mode("overwrite").save_as_table("saved_table", table_type="temporary", table_exists=True, overwrite_condition="A = 1 or B = 'b'")

df = session.table("table1")

df.write.mode("truncate").save_as_table("test_destination", column_order="name", table_type="transient", clustering_keys=["STR", col("num1")], statement_params={"k": "v"}, comment="test")

df = session.table("table1")

df.write.mode("overwrite").partition_by("value").save_as_table("saved_table", table_type="temporary")

df = session.table("table1")

df.write.mode("overwrite").partition_by(col("value")).save_as_table("saved_table", table_type="temporary")

df = session.table("table1")

df.write.mode("overwrite").partition_by(col("value")).options({"COPY_INTO_LOCATION": "abcd"}).save_as_table("saved_table", table_type="temporary")

df = session.table("table1")

df.write.mode("overwrite").partition_by(col("value")).options({"COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "pqrs", "OVERWRITE": True, "MODE": "append"}).save_as_table("saved_table", table_type="temporary")

stage_created_result = session.sql("create temp stage if not exists test_stage")

stage_created_result.collect()

df = session.table("table1")

df.write.mode("overwrite").partition_by(col("value")).options({"COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "pqrs", "OVERWRITE": True, "MODE": "append"}).copy_into_location("@test_stage/copied_from_dataframe")

df = session.table("table1")

df.write.mode("overwrite").partition_by(col("value")).options({"COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "pqrs", "OVERWRITE": True, "MODE": "append"}).copy_into_location("@test_stage/copied_from_dataframe", file_format_type="parquet", header=True, overwrite=True, single=True)

df = session.table("table1")

df.write.mode("overwrite").partition_by(col("value")).options({"COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "pqrs", "OVERWRITE": True, "MODE": "append"}).copy_into_location("@test_stage/copied_from_dataframe", file_format_name="csv", format_type_options={"compression": "bzip2"}, block=False, INCLUDE_QUERY_ID=True, DETAILED_OUTPUT=False)

df = session.table("table1")

df.write.mode("overwrite").partition_by(col("value")).options({"COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "pqrs", "OVERWRITE": True, "MODE": "append"}).copy_into_location("@test_stage/copied_from_dataframe", file_format_name="csv", format_type_options={"compression": "bzip2", "binary_format": "base64"}, block=False, INCLUDE_QUERY_ID=True, DETAILED_OUTPUT=False)

df = session.table("table1")

df.write.mode("overwrite").partition_by(col("value")).options({"COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "pqrs", "OVERWRITE": True, "MODE": "append"}).csv("@test_stage/test.csv", format_type_options={"compression": "bzip2"}, header=True, overwrite=True, single=True)

df = session.table("table1")

df.write.mode("overwrite").partition_by(col("value")).options({"COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "pqrs", "OVERWRITE": True, "MODE": "append", "HEADER": True}).format("csv").save("@test_stage/test.csv", format_type_options={"compression": "bzip2"})

df = session.table("table1")

df.write.mode("overwrite").partition_by(col("value")).options({"COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "pqrs", "OVERWRITE": True, "MODE": "append", "HEADER": True}).format("csv").json("@test_stage/test.json", format_type_options={"compression": "bzip2"}, overwrite=True, single=True)

df = session.table("table1")

df.write.mode("overwrite").partition_by(col("value")).options({"COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "pqrs", "OVERWRITE": True, "MODE": "append", "HEADER": True}).format("json").save("@test_stage/test.json", format_type_options={"compression": "bzip2"})

df = session.table("table1")

df.write.mode("overwrite").partition_by(col("value")).options({"COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "pqrs", "OVERWRITE": True, "MODE": "append", "HEADER": True}).format("json").parquet("@test_stage/test.parquet", format_type_options={"compression": "bzip2"}, overwrite=True, single=True)

df = session.table("table1")

df.write.mode("overwrite").partition_by(col("value")).options({"COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "pqrs", "OVERWRITE": True, "MODE": "append", "HEADER": True}).format("parquet").save("@test_stage/test.parquet", format_type_options={"compression": "bzip2"})

df = session.table("table1")

df.write.mode("overwrite").partition_by(col("value")).options({"COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "pqrs", "OVERWRITE": True, "MODE": "append", "HEADER": True}).format("parquet").insert_into("saved_table", overwrite=True)

df = session.table("table1")

df.write.mode("overwrite").partition_by(col("value")).options({"COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "abcd", "COPY_INTO_LOCATION": "pqrs", "OVERWRITE": True, "MODE": "append", "HEADER": True}).format("parquet").insert_into("saved_table", overwrite=False)

df = session.table("table2")

df.write.copy_into_location("s3://testbucket", storage_integration="test_integration")

df = session.table("table2")

df.write.copy_into_location("azure://testcontainer", validation_mode="RETURN_ROWS", storage_integration="test_integration")

df = session.table("table2")

df.write.copy_into_location("gcp://teststorage")

df = session.table("table2")

df.write.copy_into_location("gcp://teststorage", credentials={"AWS_KEY_ID": "awsid", "AWS_SECRET_KEY": "!23@"}, encryption={"TYPE": None, "MASTER_KEY": "master key"})

df = session.table("table2")

df.write.parquet("azure://testcontainer", validation_mode="RETURN_3_ROWS", storage_integration="test_integration")

df = session.table("table2")

df.write.json("s3://testbucket", credentials={"AWS_KEY_ID": "awsid", "AWS_SECRET_KEY": "!23@"}, encryption={"TYPE": None, "MASTER_KEY": "master key"})

df = session.table("table2")

df.write.csv("azure://testcontainer", validation_mode="RETURN_3_ROWS", storage_integration="test_integration")

df = session.table("table2")

df.write.format("json").save("gcp://teststorage", partition_by="value", storage_integration="test_integration", credentials={"AWS_KEY_ID": "awsid", "AWS_SECRET_KEY": "!23@"}, encryption={"TYPE": None, "MASTER_KEY": "master key"})

## EXPECTED ENCODED AST

interned_value_table {
  string_values {
    key: -1
  }
  string_values {
    key: 2
    value: "SRC_POSITION_TEST_MODE"
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        column_order: "index"
        src {
          end_column: 45
          end_line: 29
          file: 2
          start_column: 8
          start_line: 29
        }
        table_name {
          name {
            name_flat {
              name: "saved_table"
            }
          }
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 2
  }
}
body {
  eval {
    bind_id: 2
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        column_order: "index"
        src {
          end_column: 87
          end_line: 31
          file: 2
          start_column: 8
          start_line: 31
        }
        table_name {
          name {
            name_flat {
              name: "saved_table"
            }
          }
        }
        table_type: "temporary"
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 3
  }
}
body {
  eval {
    bind_id: 3
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        column_order: "index"
        mode {
          save_mode_ignore: true
        }
        src {
          end_column: 102
          end_line: 33
          file: 2
          start_column: 8
          start_line: 33
        }
        table_name {
          name {
            name_flat {
              name: "saved_table"
            }
          }
        }
        table_type: "temporary"
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 4
  }
}
body {
  eval {
    bind_id: 4
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        column_order: "index"
        iceberg_config {
          _1: "external_volume"
          _2 {
            string_val {
              src {
                end_column: 291
                end_line: 35
                file: 2
                start_column: 8
                start_line: 35
              }
              v: "example_volume"
            }
          }
        }
        iceberg_config {
          _1: "catalog"
          _2 {
            string_val {
              src {
                end_column: 291
                end_line: 35
                file: 2
                start_column: 8
                start_line: 35
              }
              v: "example_catalog"
            }
          }
        }
        iceberg_config {
          _1: "base_location"
          _2 {
            string_val {
              src {
                end_column: 291
                end_line: 35
                file: 2
                start_column: 8
                start_line: 35
              }
              v: "/root"
            }
          }
        }
        iceberg_config {
          _1: "catalog_sync"
          _2 {
            string_val {
              src {
                end_column: 291
                end_line: 35
                file: 2
                start_column: 8
                start_line: 35
              }
              v: "integration_name"
            }
          }
        }
        iceberg_config {
          _1: "storage_serialization_policy"
          _2 {
            string_val {
              src {
                end_column: 291
                end_line: 35
                file: 2
                start_column: 8
                start_line: 35
              }
              v: "OPTIMIZED"
            }
          }
        }
        iceberg_config {
          _1: "iceberg_version"
          _2 {
            int64_val {
              src {
                end_column: 291
                end_line: 35
                file: 2
                start_column: 8
                start_line: 35
              }
              v: 3
            }
          }
        }
        mode {
          save_mode_ignore: true
        }
        src {
          end_column: 291
          end_line: 35
          file: 2
          start_column: 8
          start_line: 35
        }
        table_name {
          name {
            name_flat {
              name: "saved_table"
            }
          }
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 5
  }
}
body {
  eval {
    bind_id: 5
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        column_order: "index"
        iceberg_config {
          _1: "external_volume"
          _2 {
            string_val {
              src {
                end_column: 166
                end_line: 37
                file: 2
                start_column: 8
                start_line: 37
              }
              v: "example_volume"
            }
          }
        }
        iceberg_config {
          _1: "partition_by"
          _2 {
            list_val {
              src {
                end_column: 166
                end_line: 37
                file: 2
                start_column: 8
                start_line: 37
              }
              vs {
                apply_expr {
                  fn {
                    builtin_fn {
                      name {
                        name {
                          name_flat {
                            name: "bucket"
                          }
                        }
                      }
                    }
                  }
                  pos_args {
                    int64_val {
                      src {
                        end_column: 163
                        end_line: 37
                        file: 2
                        start_column: 148
                        start_line: 37
                      }
                      v: 10
                    }
                  }
                  pos_args {
                    string_val {
                      src {
                        end_column: 163
                        end_line: 37
                        file: 2
                        start_column: 148
                        start_line: 37
                      }
                      v: "A"
                    }
                  }
                  src {
                    end_column: 163
                    end_line: 37
                    file: 2
                    start_column: 148
                    start_line: 37
                  }
                }
              }
            }
          }
        }
        src {
          end_column: 166
          end_line: 37
          file: 2
          start_column: 8
          start_line: 37
        }
        table_name {
          name {
            name_flat {
              name: "iceberg_table_with_bucket"
            }
          }
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 6
  }
}
body {
  eval {
    bind_id: 6
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        column_order: "index"
        iceberg_config {
          _1: "external_volume"
          _2 {
            string_val {
              src {
                end_column: 169
                end_line: 39
                file: 2
                start_column: 8
                start_line: 39
              }
              v: "example_volume"
            }
          }
        }
        iceberg_config {
          _1: "partition_by"
          _2 {
            list_val {
              src {
                end_column: 169
                end_line: 39
                file: 2
                start_column: 8
                start_line: 39
              }
              vs {
                apply_expr {
                  fn {
                    builtin_fn {
                      name {
                        name {
                          name_flat {
                            name: "truncate"
                          }
                        }
                      }
                    }
                  }
                  pos_args {
                    int64_val {
                      src {
                        end_column: 166
                        end_line: 39
                        file: 2
                        start_column: 150
                        start_line: 39
                      }
                      v: 5
                    }
                  }
                  pos_args {
                    string_val {
                      src {
                        end_column: 166
                        end_line: 39
                        file: 2
                        start_column: 150
                        start_line: 39
                      }
                      v: "B"
                    }
                  }
                  src {
                    end_column: 166
                    end_line: 39
                    file: 2
                    start_column: 150
                    start_line: 39
                  }
                }
              }
            }
          }
        }
        src {
          end_column: 169
          end_line: 39
          file: 2
          start_column: 8
          start_line: 39
        }
        table_name {
          name {
            name_flat {
              name: "iceberg_table_with_truncate"
            }
          }
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 7
  }
}
body {
  eval {
    bind_id: 7
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        column_order: "index"
        iceberg_config {
          _1: "external_volume"
          _2 {
            string_val {
              src {
                end_column: 230
                end_line: 41
                file: 2
                start_column: 8
                start_line: 41
              }
              v: "example_volume"
            }
          }
        }
        iceberg_config {
          _1: "partition_by"
          _2 {
            list_val {
              src {
                end_column: 230
                end_line: 41
                file: 2
                start_column: 8
                start_line: 41
              }
              vs {
                apply_expr {
                  fn {
                    builtin_fn {
                      name {
                        name {
                          name_flat {
                            name: "year"
                          }
                        }
                      }
                    }
                  }
                  pos_args {
                    string_val {
                      src {
                        end_column: 168
                        end_line: 41
                        file: 2
                        start_column: 152
                        start_line: 41
                      }
                      v: "date_col"
                    }
                  }
                  src {
                    end_column: 168
                    end_line: 41
                    file: 2
                    start_column: 152
                    start_line: 41
                  }
                }
              }
              vs {
                apply_expr {
                  fn {
                    builtin_fn {
                      name {
                        name {
                          name_flat {
                            name: "month"
                          }
                        }
                      }
                    }
                  }
                  pos_args {
                    string_val {
                      src {
                        end_column: 187
                        end_line: 41
                        file: 2
                        start_column: 170
                        start_line: 41
                      }
                      v: "date_col"
                    }
                  }
                  src {
                    end_column: 187
                    end_line: 41
                    file: 2
                    start_column: 170
                    start_line: 41
                  }
                }
              }
              vs {
                apply_expr {
                  fn {
                    builtin_fn {
                      name {
                        name {
                          name_flat {
                            name: "day"
                          }
                        }
                      }
                    }
                  }
                  pos_args {
                    string_val {
                      src {
                        end_column: 204
                        end_line: 41
                        file: 2
                        start_column: 189
                        start_line: 41
                      }
                      v: "date_col"
                    }
                  }
                  src {
                    end_column: 204
                    end_line: 41
                    file: 2
                    start_column: 189
                    start_line: 41
                  }
                }
              }
              vs {
                apply_expr {
                  fn {
                    builtin_fn {
                      name {
                        name {
                          name_flat {
                            name: "hour"
                          }
                        }
                      }
                    }
                  }
                  pos_args {
                    string_val {
                      src {
                        end_column: 227
                        end_line: 41
                        file: 2
                        start_column: 206
                        start_line: 41
                      }
                      v: "timestamp_col"
                    }
                  }
                  src {
                    end_column: 227
                    end_line: 41
                    file: 2
                    start_column: 206
                    start_line: 41
                  }
                }
              }
            }
          }
        }
        src {
          end_column: 230
          end_line: 41
          file: 2
          start_column: 8
          start_line: 41
        }
        table_name {
          name {
            name_flat {
              name: "iceberg_table_with_transforms"
            }
          }
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 8
  }
}
body {
  eval {
    bind_id: 8
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        column_order: "index"
        iceberg_config {
          _1: "external_volume"
          _2 {
            string_val {
              src {
                end_column: 193
                end_line: 43
                file: 2
                start_column: 8
                start_line: 43
              }
              v: "example_volume"
            }
          }
        }
        iceberg_config {
          _1: "partition_by"
          _2 {
            list_val {
              src {
                end_column: 193
                end_line: 43
                file: 2
                start_column: 8
                start_line: 43
              }
              vs {
                apply_expr {
                  fn {
                    builtin_fn {
                      name {
                        name {
                          name_flat {
                            name: "col"
                          }
                        }
                      }
                    }
                  }
                  pos_args {
                    string_val {
                      src {
                        end_column: 150
                        end_line: 43
                        file: 2
                        start_column: 142
                        start_line: 43
                      }
                      v: "A"
                    }
                  }
                  src {
                    end_column: 150
                    end_line: 43
                    file: 2
                    start_column: 142
                    start_line: 43
                  }
                }
              }
              vs {
                apply_expr {
                  fn {
                    builtin_fn {
                      name {
                        name {
                          name_flat {
                            name: "bucket"
                          }
                        }
                      }
                    }
                  }
                  pos_args {
                    int64_val {
                      src {
                        end_column: 167
                        end_line: 43
                        file: 2
                        start_column: 152
                        start_line: 43
                      }
                      v: 20
                    }
                  }
                  pos_args {
                    string_val {
                      src {
                        end_column: 167
                        end_line: 43
                        file: 2
                        start_column: 152
                        start_line: 43
                      }
                      v: "B"
                    }
                  }
                  src {
                    end_column: 167
                    end_line: 43
                    file: 2
                    start_column: 152
                    start_line: 43
                  }
                }
              }
              vs {
                apply_expr {
                  fn {
                    builtin_fn {
                      name {
                        name {
                          name_flat {
                            name: "truncate"
                          }
                        }
                      }
                    }
                  }
                  pos_args {
                    int64_val {
                      src {
                        end_column: 190
                        end_line: 43
                        file: 2
                        start_column: 169
                        start_line: 43
                      }
                      v: 3
                    }
                  }
                  pos_args {
                    apply_expr {
                      fn {
                        builtin_fn {
                          name {
                            name {
                              name_flat {
                                name: "col"
                              }
                            }
                          }
                        }
                      }
                      pos_args {
                        string_val {
                          src {
                            end_column: 189
                            end_line: 43
                            file: 2
                            start_column: 181
                            start_line: 43
                          }
                          v: "C"
                        }
                      }
                      src {
                        end_column: 189
                        end_line: 43
                        file: 2
                        start_column: 181
                        start_line: 43
                      }
                    }
                  }
                  src {
                    end_column: 190
                    end_line: 43
                    file: 2
                    start_column: 169
                    start_line: 43
                  }
                }
              }
            }
          }
        }
        src {
          end_column: 193
          end_line: 43
          file: 2
          start_column: 8
          start_line: 43
        }
        table_name {
          name {
            name_flat {
              name: "iceberg_table_mixed"
            }
          }
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 9
  }
}
body {
  eval {
    bind_id: 9
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        column_order: "index"
        iceberg_config {
          _1: "external_volume"
          _2 {
            string_val {
              src {
                end_column: 159
                end_line: 45
                file: 2
                start_column: 8
                start_line: 45
              }
              v: "example_volume"
            }
          }
        }
        iceberg_config {
          _1: "target_file_size"
          _2 {
            string_val {
              src {
                end_column: 159
                end_line: 45
                file: 2
                start_column: 8
                start_line: 45
              }
              v: "64MB"
            }
          }
        }
        src {
          end_column: 159
          end_line: 45
          file: 2
          start_column: 8
          start_line: 45
        }
        table_name {
          name {
            name_flat {
              name: "iceberg_table_target_size"
            }
          }
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 10
  }
}
body {
  eval {
    bind_id: 10
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        column_order: "index"
        iceberg_config {
          _1: "external_volume"
          _2 {
            string_val {
              src {
                end_column: 230
                end_line: 47
                file: 2
                start_column: 8
                start_line: 47
              }
              v: "example_volume"
            }
          }
        }
        iceberg_config {
          _1: "partition_by"
          _2 {
            list_val {
              src {
                end_column: 230
                end_line: 47
                file: 2
                start_column: 8
                start_line: 47
              }
              vs {
                apply_expr {
                  fn {
                    builtin_fn {
                      name {
                        name {
                          name_flat {
                            name: "bucket"
                          }
                        }
                      }
                    }
                  }
                  pos_args {
                    int64_val {
                      src {
                        end_column: 156
                        end_line: 47
                        file: 2
                        start_column: 141
                        start_line: 47
                      }
                      v: 10
                    }
                  }
                  pos_args {
                    string_val {
                      src {
                        end_column: 156
                        end_line: 47
                        file: 2
                        start_column: 141
                        start_line: 47
                      }
                      v: "A"
                    }
                  }
                  src {
                    end_column: 156
                    end_line: 47
                    file: 2
                    start_column: 141
                    start_line: 47
                  }
                }
              }
              vs {
                apply_expr {
                  fn {
                    builtin_fn {
                      name {
                        name {
                          name_flat {
                            name: "year"
                          }
                        }
                      }
                    }
                  }
                  pos_args {
                    string_val {
                      src {
                        end_column: 174
                        end_line: 47
                        file: 2
                        start_column: 158
                        start_line: 47
                      }
                      v: "date_col"
                    }
                  }
                  src {
                    end_column: 174
                    end_line: 47
                    file: 2
                    start_column: 158
                    start_line: 47
                  }
                }
              }
            }
          }
        }
        iceberg_config {
          _1: "target_file_size"
          _2 {
            string_val {
              src {
                end_column: 230
                end_line: 47
                file: 2
                start_column: 8
                start_line: 47
              }
              v: "AUTO"
            }
          }
        }
        iceberg_config {
          _1: "catalog"
          _2 {
            string_val {
              src {
                end_column: 230
                end_line: 47
                file: 2
                start_column: 8
                start_line: 47
              }
              v: "my_catalog"
            }
          }
        }
        src {
          end_column: 230
          end_line: 47
          file: 2
          start_column: 8
          start_line: 47
        }
        table_name {
          name {
            name_flat {
              name: "iceberg_table_full"
            }
          }
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 11
  }
}
body {
  eval {
    bind_id: 11
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        column_order: "index"
        overwrite_condition {
          or {
            lhs {
              gt {
                lhs {
                  apply_expr {
                    fn {
                      builtin_fn {
                        name {
                          name {
                            name_flat {
                              name: "col"
                            }
                          }
                        }
                      }
                    }
                    pos_args {
                      string_val {
                        src {
                          end_column: 136
                          end_line: 49
                          file: 2
                          start_column: 128
                          start_line: 49
                        }
                        v: "A"
                      }
                    }
                    src {
                      end_column: 136
                      end_line: 49
                      file: 2
                      start_column: 128
                      start_line: 49
                    }
                  }
                }
                rhs {
                  int64_val {
                    src {
                      end_column: 140
                      end_line: 49
                      file: 2
                      start_column: 128
                      start_line: 49
                    }
                    v: 4
                  }
                }
                src {
                  end_column: 140
                  end_line: 49
                  file: 2
                  start_column: 128
                  start_line: 49
                }
              }
            }
            rhs {
              eq {
                lhs {
                  apply_expr {
                    fn {
                      builtin_fn {
                        name {
                          name {
                            name_flat {
                              name: "col"
                            }
                          }
                        }
                      }
                    }
                    pos_args {
                      string_val {
                        src {
                          end_column: 153
                          end_line: 49
                          file: 2
                          start_column: 145
                          start_line: 49
                        }
                        v: "B"
                      }
                    }
                    src {
                      end_column: 153
                      end_line: 49
                      file: 2
                      start_column: 145
                      start_line: 49
                    }
                  }
                }
                rhs {
                  string_val {
                    src {
                      end_column: 160
                      end_line: 49
                      file: 2
                      start_column: 145
                      start_line: 49
                    }
                    v: "c"
                  }
                }
                src {
                  end_column: 160
                  end_line: 49
                  file: 2
                  start_column: 145
                  start_line: 49
                }
              }
            }
            src {
              end_column: 161
              end_line: 49
              file: 2
              start_column: 127
              start_line: 49
            }
          }
        }
        src {
          end_column: 162
          end_line: 49
          file: 2
          start_column: 8
          start_line: 49
        }
        table_exists {
          value: true
        }
        table_name {
          name {
            name_flat {
              name: "saved_table"
            }
          }
        }
        table_type: "temporary"
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 12
  }
}
body {
  eval {
    bind_id: 12
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        column_order: "index"
        overwrite_condition {
          sql_expr {
            sql: "A = 1 or B = \'b\'"
            src {
              end_column: 146
              end_line: 51
              file: 2
              start_column: 8
              start_line: 51
            }
          }
        }
        src {
          end_column: 146
          end_line: 51
          file: 2
          start_column: 8
          start_line: 51
        }
        table_exists {
          value: true
        }
        table_name {
          name {
            name_flat {
              name: "saved_table"
            }
          }
        }
        table_type: "temporary"
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 13
  }
}
body {
  eval {
    bind_id: 13
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        clustering_keys {
          string_val {
            src {
              end_column: 231
              end_line: 53
              file: 2
              start_column: 8
              start_line: 53
            }
            v: "STR"
          }
        }
        clustering_keys {
          apply_expr {
            fn {
              builtin_fn {
                name {
                  name {
                    name_flat {
                      name: "col"
                    }
                  }
                }
              }
            }
            pos_args {
              string_val {
                src {
                  end_column: 173
                  end_line: 53
                  file: 2
                  start_column: 162
                  start_line: 53
                }
                v: "num1"
              }
            }
            src {
              end_column: 173
              end_line: 53
              file: 2
              start_column: 162
              start_line: 53
            }
          }
        }
        column_order: "name"
        comment {
          value: "test"
        }
        src {
          end_column: 231
          end_line: 53
          file: 2
          start_column: 8
          start_line: 53
        }
        statement_params {
          _1: "k"
          _2: "v"
        }
        table_name {
          name {
            name_flat {
              name: "test_destination"
            }
          }
        }
        table_type: "transient"
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            save_mode {
              save_mode_truncate: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 14
  }
}
body {
  eval {
    bind_id: 14
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        column_order: "index"
        src {
          end_column: 109
          end_line: 55
          file: 2
          start_column: 8
          start_line: 55
        }
        table_name {
          name {
            name_flat {
              name: "saved_table"
            }
          }
        }
        table_type: "temporary"
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            partition_by {
              sql_expr {
                sql: "value"
                src {
                  end_column: 38
                  end_line: 55
                  file: 2
                  start_column: 8
                  start_line: 55
                }
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 15
  }
}
body {
  eval {
    bind_id: 15
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        column_order: "index"
        src {
          end_column: 114
          end_line: 57
          file: 2
          start_column: 8
          start_line: 57
        }
        table_name {
          name {
            name_flat {
              name: "saved_table"
            }
          }
        }
        table_type: "temporary"
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            partition_by {
              apply_expr {
                fn {
                  builtin_fn {
                    name {
                      name {
                        name_flat {
                          name: "col"
                        }
                      }
                    }
                  }
                }
                pos_args {
                  string_val {
                    src {
                      end_column: 42
                      end_line: 57
                      file: 2
                      start_column: 30
                      start_line: 57
                    }
                    v: "value"
                  }
                }
                src {
                  end_column: 42
                  end_line: 57
                  file: 2
                  start_column: 30
                  start_line: 57
                }
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 16
  }
}
body {
  eval {
    bind_id: 16
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        column_order: "index"
        src {
          end_column: 151
          end_line: 59
          file: 2
          start_column: 8
          start_line: 59
        }
        table_name {
          name {
            name_flat {
              name: "saved_table"
            }
          }
        }
        table_type: "temporary"
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 59
                    file: 2
                    start_column: 8
                    start_line: 59
                  }
                  v: "abcd"
                }
              }
            }
            partition_by {
              apply_expr {
                fn {
                  builtin_fn {
                    name {
                      name {
                        name_flat {
                          name: "col"
                        }
                      }
                    }
                  }
                }
                pos_args {
                  string_val {
                    src {
                      end_column: 79
                      end_line: 59
                      file: 2
                      start_column: 67
                      start_line: 59
                    }
                    v: "value"
                  }
                }
                src {
                  end_column: 79
                  end_line: 59
                  file: 2
                  start_column: 67
                  start_line: 59
                }
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 17
  }
}
body {
  eval {
    bind_id: 17
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_table {
        block: true
        column_order: "index"
        src {
          end_column: 239
          end_line: 61
          file: 2
          start_column: 8
          start_line: 61
        }
        table_name {
          name {
            name_flat {
              name: "saved_table"
            }
          }
        }
        table_type: "temporary"
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 59
                    file: 2
                    start_column: 8
                    start_line: 59
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 90
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "pqrs"
                }
              }
            }
            options {
              _1: "OVERWRITE"
              _2 {
                bool_val {
                  src {
                    end_column: 116
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: true
                }
              }
            }
            options {
              _1: "MODE"
              _2 {
                string_val {
                  src {
                    end_column: 141
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "append"
                }
              }
            }
            partition_by {
              apply_expr {
                fn {
                  builtin_fn {
                    name {
                      name {
                        name_flat {
                          name: "col"
                        }
                      }
                    }
                  }
                }
                pos_args {
                  string_val {
                    src {
                      end_column: 167
                      end_line: 61
                      file: 2
                      start_column: 155
                      start_line: 61
                    }
                    v: "value"
                  }
                }
                src {
                  end_column: 167
                  end_line: 61
                  file: 2
                  start_column: 155
                  start_line: 61
                }
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 18
  }
}
body {
  eval {
    bind_id: 18
  }
}
body {
  bind {
    expr {
      sql {
        query: "create temp stage if not exists test_stage"
        src {
          end_column: 88
          end_line: 63
          file: 2
          start_column: 31
          start_line: 63
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "stage_created_result"
    }
    uid: 19
  }
}
body {
  bind {
    expr {
      dataframe_collect {
        block: true
        case_sensitive: true
        df {
          dataframe_ref {
            id: 19
          }
        }
        src {
          end_column: 98
          end_line: 63
          file: 2
          start_column: 31
          start_line: 63
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 20
  }
}
body {
  eval {
    bind_id: 20
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_copy_into_location {
        block: true
        location: "@test_stage/copied_from_dataframe"
        src {
          end_column: 72
          end_line: 65
          file: 2
          start_column: 8
          start_line: 65
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 59
                    file: 2
                    start_column: 8
                    start_line: 59
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 90
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "pqrs"
                }
              }
            }
            options {
              _1: "OVERWRITE"
              _2 {
                bool_val {
                  src {
                    end_column: 116
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: true
                }
              }
            }
            options {
              _1: "MODE"
              _2 {
                string_val {
                  src {
                    end_column: 141
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "append"
                }
              }
            }
            partition_by {
              apply_expr {
                fn {
                  builtin_fn {
                    name {
                      name {
                        name_flat {
                          name: "col"
                        }
                      }
                    }
                  }
                }
                pos_args {
                  string_val {
                    src {
                      end_column: 167
                      end_line: 61
                      file: 2
                      start_column: 155
                      start_line: 61
                    }
                    v: "value"
                  }
                }
                src {
                  end_column: 167
                  end_line: 61
                  file: 2
                  start_column: 155
                  start_line: 61
                }
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 21
  }
}
body {
  eval {
    bind_id: 21
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_copy_into_location {
        block: true
        copy_options {
          _1: "overwrite"
          _2 {
            bool_val {
              src {
                end_column: 123
                end_line: 69
                file: 2
                start_column: 8
                start_line: 69
              }
              v: true
            }
          }
        }
        copy_options {
          _1: "single"
          _2 {
            bool_val {
              src {
                end_column: 123
                end_line: 69
                file: 2
                start_column: 8
                start_line: 69
              }
              v: true
            }
          }
        }
        file_format_type {
          value: "parquet"
        }
        header: true
        location: "@test_stage/copied_from_dataframe"
        src {
          end_column: 123
          end_line: 69
          file: 2
          start_column: 8
          start_line: 69
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 59
                    file: 2
                    start_column: 8
                    start_line: 59
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 90
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "pqrs"
                }
              }
            }
            options {
              _1: "OVERWRITE"
              _2 {
                bool_val {
                  src {
                    end_column: 116
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: true
                }
              }
            }
            options {
              _1: "MODE"
              _2 {
                string_val {
                  src {
                    end_column: 141
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "append"
                }
              }
            }
            partition_by {
              apply_expr {
                fn {
                  builtin_fn {
                    name {
                      name {
                        name_flat {
                          name: "col"
                        }
                      }
                    }
                  }
                }
                pos_args {
                  string_val {
                    src {
                      end_column: 167
                      end_line: 61
                      file: 2
                      start_column: 155
                      start_line: 61
                    }
                    v: "value"
                  }
                }
                src {
                  end_column: 167
                  end_line: 61
                  file: 2
                  start_column: 155
                  start_line: 61
                }
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 22
  }
}
body {
  eval {
    bind_id: 22
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_copy_into_location {
        copy_options {
          _1: "INCLUDE_QUERY_ID"
          _2 {
            bool_val {
              src {
                end_column: 181
                end_line: 71
                file: 2
                start_column: 8
                start_line: 71
              }
              v: true
            }
          }
        }
        copy_options {
          _1: "DETAILED_OUTPUT"
          _2 {
            bool_val {
              src {
                end_column: 181
                end_line: 71
                file: 2
                start_column: 8
                start_line: 71
              }
            }
          }
        }
        file_format_name {
          value: "csv"
        }
        format_type_options {
          _1: "compression"
          _2: "bzip2"
        }
        location: "@test_stage/copied_from_dataframe"
        src {
          end_column: 181
          end_line: 71
          file: 2
          start_column: 8
          start_line: 71
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 59
                    file: 2
                    start_column: 8
                    start_line: 59
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 90
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "pqrs"
                }
              }
            }
            options {
              _1: "OVERWRITE"
              _2 {
                bool_val {
                  src {
                    end_column: 116
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: true
                }
              }
            }
            options {
              _1: "MODE"
              _2 {
                string_val {
                  src {
                    end_column: 141
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "append"
                }
              }
            }
            partition_by {
              apply_expr {
                fn {
                  builtin_fn {
                    name {
                      name {
                        name_flat {
                          name: "col"
                        }
                      }
                    }
                  }
                }
                pos_args {
                  string_val {
                    src {
                      end_column: 167
                      end_line: 61
                      file: 2
                      start_column: 155
                      start_line: 61
                    }
                    v: "value"
                  }
                }
                src {
                  end_column: 167
                  end_line: 61
                  file: 2
                  start_column: 155
                  start_line: 61
                }
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 23
  }
}
body {
  eval {
    bind_id: 23
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_copy_into_location {
        copy_options {
          _1: "INCLUDE_QUERY_ID"
          _2 {
            bool_val {
              src {
                end_column: 207
                end_line: 73
                file: 2
                start_column: 8
                start_line: 73
              }
              v: true
            }
          }
        }
        copy_options {
          _1: "DETAILED_OUTPUT"
          _2 {
            bool_val {
              src {
                end_column: 207
                end_line: 73
                file: 2
                start_column: 8
                start_line: 73
              }
            }
          }
        }
        file_format_name {
          value: "csv"
        }
        format_type_options {
          _1: "compression"
          _2: "bzip2"
        }
        format_type_options {
          _1: "binary_format"
          _2: "base64"
        }
        location: "@test_stage/copied_from_dataframe"
        src {
          end_column: 207
          end_line: 73
          file: 2
          start_column: 8
          start_line: 73
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 59
                    file: 2
                    start_column: 8
                    start_line: 59
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 90
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "pqrs"
                }
              }
            }
            options {
              _1: "OVERWRITE"
              _2 {
                bool_val {
                  src {
                    end_column: 116
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: true
                }
              }
            }
            options {
              _1: "MODE"
              _2 {
                string_val {
                  src {
                    end_column: 141
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "append"
                }
              }
            }
            partition_by {
              apply_expr {
                fn {
                  builtin_fn {
                    name {
                      name {
                        name_flat {
                          name: "col"
                        }
                      }
                    }
                  }
                }
                pos_args {
                  string_val {
                    src {
                      end_column: 167
                      end_line: 61
                      file: 2
                      start_column: 155
                      start_line: 61
                    }
                    v: "value"
                  }
                }
                src {
                  end_column: 167
                  end_line: 61
                  file: 2
                  start_column: 155
                  start_line: 61
                }
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 24
  }
}
body {
  eval {
    bind_id: 24
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_csv {
        block: true
        copy_options {
          _1: "overwrite"
          _2 {
            bool_val {
              src {
                end_column: 125
                end_line: 77
                file: 2
                start_column: 8
                start_line: 77
              }
              v: true
            }
          }
        }
        copy_options {
          _1: "single"
          _2 {
            bool_val {
              src {
                end_column: 125
                end_line: 77
                file: 2
                start_column: 8
                start_line: 77
              }
              v: true
            }
          }
        }
        format_type_options {
          _1: "compression"
          _2: "bzip2"
        }
        header: true
        location: "@test_stage/test.csv"
        src {
          end_column: 125
          end_line: 77
          file: 2
          start_column: 8
          start_line: 77
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 59
                    file: 2
                    start_column: 8
                    start_line: 59
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 90
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "pqrs"
                }
              }
            }
            options {
              _1: "OVERWRITE"
              _2 {
                bool_val {
                  src {
                    end_column: 116
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: true
                }
              }
            }
            options {
              _1: "MODE"
              _2 {
                string_val {
                  src {
                    end_column: 141
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "append"
                }
              }
            }
            partition_by {
              apply_expr {
                fn {
                  builtin_fn {
                    name {
                      name {
                        name_flat {
                          name: "col"
                        }
                      }
                    }
                  }
                }
                pos_args {
                  string_val {
                    src {
                      end_column: 167
                      end_line: 61
                      file: 2
                      start_column: 155
                      start_line: 61
                    }
                    v: "value"
                  }
                }
                src {
                  end_column: 167
                  end_line: 61
                  file: 2
                  start_column: 155
                  start_line: 61
                }
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 25
  }
}
body {
  eval {
    bind_id: 25
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_save {
        block: true
        format_type_options {
          _1: "compression"
          _2: "bzip2"
        }
        location: "@test_stage/test.csv"
        src {
          end_column: 139
          end_line: 79
          file: 2
          start_column: 8
          start_line: 79
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            format {
              value: "csv"
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 59
                    file: 2
                    start_column: 8
                    start_line: 59
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 90
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "pqrs"
                }
              }
            }
            options {
              _1: "OVERWRITE"
              _2 {
                bool_val {
                  src {
                    end_column: 116
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: true
                }
              }
            }
            options {
              _1: "MODE"
              _2 {
                string_val {
                  src {
                    end_column: 141
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "append"
                }
              }
            }
            options {
              _1: "HEADER"
              _2 {
                bool_val {
                  src {
                    end_column: 53
                    end_line: 79
                    file: 2
                    start_column: 8
                    start_line: 79
                  }
                  v: true
                }
              }
            }
            partition_by {
              apply_expr {
                fn {
                  builtin_fn {
                    name {
                      name {
                        name_flat {
                          name: "col"
                        }
                      }
                    }
                  }
                }
                pos_args {
                  string_val {
                    src {
                      end_column: 167
                      end_line: 61
                      file: 2
                      start_column: 155
                      start_line: 61
                    }
                    v: "value"
                  }
                }
                src {
                  end_column: 167
                  end_line: 61
                  file: 2
                  start_column: 155
                  start_line: 61
                }
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 26
  }
}
body {
  eval {
    bind_id: 26
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_json {
        block: true
        copy_options {
          _1: "overwrite"
          _2 {
            bool_val {
              src {
                end_column: 114
                end_line: 83
                file: 2
                start_column: 8
                start_line: 83
              }
              v: true
            }
          }
        }
        copy_options {
          _1: "single"
          _2 {
            bool_val {
              src {
                end_column: 114
                end_line: 83
                file: 2
                start_column: 8
                start_line: 83
              }
              v: true
            }
          }
        }
        format_type_options {
          _1: "compression"
          _2: "bzip2"
        }
        location: "@test_stage/test.json"
        src {
          end_column: 114
          end_line: 83
          file: 2
          start_column: 8
          start_line: 83
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            format {
              value: "csv"
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 59
                    file: 2
                    start_column: 8
                    start_line: 59
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 90
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "pqrs"
                }
              }
            }
            options {
              _1: "OVERWRITE"
              _2 {
                bool_val {
                  src {
                    end_column: 116
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: true
                }
              }
            }
            options {
              _1: "MODE"
              _2 {
                string_val {
                  src {
                    end_column: 141
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "append"
                }
              }
            }
            options {
              _1: "HEADER"
              _2 {
                bool_val {
                  src {
                    end_column: 53
                    end_line: 79
                    file: 2
                    start_column: 8
                    start_line: 79
                  }
                  v: true
                }
              }
            }
            partition_by {
              apply_expr {
                fn {
                  builtin_fn {
                    name {
                      name {
                        name_flat {
                          name: "col"
                        }
                      }
                    }
                  }
                }
                pos_args {
                  string_val {
                    src {
                      end_column: 167
                      end_line: 61
                      file: 2
                      start_column: 155
                      start_line: 61
                    }
                    v: "value"
                  }
                }
                src {
                  end_column: 167
                  end_line: 61
                  file: 2
                  start_column: 155
                  start_line: 61
                }
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 27
  }
}
body {
  eval {
    bind_id: 27
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_save {
        block: true
        format_type_options {
          _1: "compression"
          _2: "bzip2"
        }
        location: "@test_stage/test.json"
        src {
          end_column: 117
          end_line: 85
          file: 2
          start_column: 8
          start_line: 85
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            format {
              value: "json"
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 59
                    file: 2
                    start_column: 8
                    start_line: 59
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 90
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "pqrs"
                }
              }
            }
            options {
              _1: "OVERWRITE"
              _2 {
                bool_val {
                  src {
                    end_column: 116
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: true
                }
              }
            }
            options {
              _1: "MODE"
              _2 {
                string_val {
                  src {
                    end_column: 141
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "append"
                }
              }
            }
            options {
              _1: "HEADER"
              _2 {
                bool_val {
                  src {
                    end_column: 53
                    end_line: 79
                    file: 2
                    start_column: 8
                    start_line: 79
                  }
                  v: true
                }
              }
            }
            partition_by {
              apply_expr {
                fn {
                  builtin_fn {
                    name {
                      name {
                        name_flat {
                          name: "col"
                        }
                      }
                    }
                  }
                }
                pos_args {
                  string_val {
                    src {
                      end_column: 167
                      end_line: 61
                      file: 2
                      start_column: 155
                      start_line: 61
                    }
                    v: "value"
                  }
                }
                src {
                  end_column: 167
                  end_line: 61
                  file: 2
                  start_column: 155
                  start_line: 61
                }
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 28
  }
}
body {
  eval {
    bind_id: 28
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_parquet {
        block: true
        copy_options {
          _1: "overwrite"
          _2 {
            bool_val {
              src {
                end_column: 130
                end_line: 89
                file: 2
                start_column: 8
                start_line: 89
              }
              v: true
            }
          }
        }
        copy_options {
          _1: "single"
          _2 {
            bool_val {
              src {
                end_column: 130
                end_line: 89
                file: 2
                start_column: 8
                start_line: 89
              }
              v: true
            }
          }
        }
        format_type_options {
          _1: "compression"
          _2: "bzip2"
        }
        location: "@test_stage/test.parquet"
        src {
          end_column: 130
          end_line: 89
          file: 2
          start_column: 8
          start_line: 89
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            format {
              value: "json"
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 59
                    file: 2
                    start_column: 8
                    start_line: 59
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 90
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "pqrs"
                }
              }
            }
            options {
              _1: "OVERWRITE"
              _2 {
                bool_val {
                  src {
                    end_column: 116
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: true
                }
              }
            }
            options {
              _1: "MODE"
              _2 {
                string_val {
                  src {
                    end_column: 141
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "append"
                }
              }
            }
            options {
              _1: "HEADER"
              _2 {
                bool_val {
                  src {
                    end_column: 53
                    end_line: 79
                    file: 2
                    start_column: 8
                    start_line: 79
                  }
                  v: true
                }
              }
            }
            partition_by {
              apply_expr {
                fn {
                  builtin_fn {
                    name {
                      name {
                        name_flat {
                          name: "col"
                        }
                      }
                    }
                  }
                }
                pos_args {
                  string_val {
                    src {
                      end_column: 167
                      end_line: 61
                      file: 2
                      start_column: 155
                      start_line: 61
                    }
                    v: "value"
                  }
                }
                src {
                  end_column: 167
                  end_line: 61
                  file: 2
                  start_column: 155
                  start_line: 61
                }
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 29
  }
}
body {
  eval {
    bind_id: 29
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_save {
        block: true
        format_type_options {
          _1: "compression"
          _2: "bzip2"
        }
        location: "@test_stage/test.parquet"
        src {
          end_column: 120
          end_line: 91
          file: 2
          start_column: 8
          start_line: 91
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            format {
              value: "parquet"
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 59
                    file: 2
                    start_column: 8
                    start_line: 59
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 90
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "pqrs"
                }
              }
            }
            options {
              _1: "OVERWRITE"
              _2 {
                bool_val {
                  src {
                    end_column: 116
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: true
                }
              }
            }
            options {
              _1: "MODE"
              _2 {
                string_val {
                  src {
                    end_column: 141
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "append"
                }
              }
            }
            options {
              _1: "HEADER"
              _2 {
                bool_val {
                  src {
                    end_column: 53
                    end_line: 79
                    file: 2
                    start_column: 8
                    start_line: 79
                  }
                  v: true
                }
              }
            }
            partition_by {
              apply_expr {
                fn {
                  builtin_fn {
                    name {
                      name {
                        name_flat {
                          name: "col"
                        }
                      }
                    }
                  }
                }
                pos_args {
                  string_val {
                    src {
                      end_column: 167
                      end_line: 61
                      file: 2
                      start_column: 155
                      start_line: 61
                    }
                    v: "value"
                  }
                }
                src {
                  end_column: 167
                  end_line: 61
                  file: 2
                  start_column: 155
                  start_line: 61
                }
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 30
  }
}
body {
  eval {
    bind_id: 30
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_insert_into {
        overwrite: true
        src {
          end_column: 59
          end_line: 93
          file: 2
          start_column: 8
          start_line: 93
        }
        table_name {
          name {
            name_flat {
              name: "saved_table"
            }
          }
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            format {
              value: "parquet"
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 59
                    file: 2
                    start_column: 8
                    start_line: 59
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 90
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "pqrs"
                }
              }
            }
            options {
              _1: "OVERWRITE"
              _2 {
                bool_val {
                  src {
                    end_column: 116
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: true
                }
              }
            }
            options {
              _1: "MODE"
              _2 {
                string_val {
                  src {
                    end_column: 141
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "append"
                }
              }
            }
            options {
              _1: "HEADER"
              _2 {
                bool_val {
                  src {
                    end_column: 53
                    end_line: 79
                    file: 2
                    start_column: 8
                    start_line: 79
                  }
                  v: true
                }
              }
            }
            partition_by {
              apply_expr {
                fn {
                  builtin_fn {
                    name {
                      name {
                        name_flat {
                          name: "col"
                        }
                      }
                    }
                  }
                }
                pos_args {
                  string_val {
                    src {
                      end_column: 167
                      end_line: 61
                      file: 2
                      start_column: 155
                      start_line: 61
                    }
                    v: "value"
                  }
                }
                src {
                  end_column: 167
                  end_line: 61
                  file: 2
                  start_column: 155
                  start_line: 61
                }
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 31
  }
}
body {
  eval {
    bind_id: 31
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table1"
            }
          }
        }
        src {
          end_column: 41
          end_line: 27
          file: 2
          start_column: 13
          start_line: 27
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      write_insert_into {
        src {
          end_column: 60
          end_line: 95
          file: 2
          start_column: 8
          start_line: 95
        }
        table_name {
          name {
            name_flat {
              name: "saved_table"
            }
          }
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 1
              }
            }
            format {
              value: "parquet"
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 59
                    file: 2
                    start_column: 8
                    start_line: 59
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 53
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "abcd"
                }
              }
            }
            options {
              _1: "COPY_INTO_LOCATION"
              _2 {
                string_val {
                  src {
                    end_column: 90
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "pqrs"
                }
              }
            }
            options {
              _1: "OVERWRITE"
              _2 {
                bool_val {
                  src {
                    end_column: 116
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: true
                }
              }
            }
            options {
              _1: "MODE"
              _2 {
                string_val {
                  src {
                    end_column: 141
                    end_line: 61
                    file: 2
                    start_column: 8
                    start_line: 61
                  }
                  v: "append"
                }
              }
            }
            options {
              _1: "HEADER"
              _2 {
                bool_val {
                  src {
                    end_column: 53
                    end_line: 79
                    file: 2
                    start_column: 8
                    start_line: 79
                  }
                  v: true
                }
              }
            }
            partition_by {
              apply_expr {
                fn {
                  builtin_fn {
                    name {
                      name {
                        name_flat {
                          name: "col"
                        }
                      }
                    }
                  }
                }
                pos_args {
                  string_val {
                    src {
                      end_column: 167
                      end_line: 61
                      file: 2
                      start_column: 155
                      start_line: 61
                    }
                    v: "value"
                  }
                }
                src {
                  end_column: 167
                  end_line: 61
                  file: 2
                  start_column: 155
                  start_line: 61
                }
              }
            }
            save_mode {
              save_mode_overwrite: true
            }
            src {
              end_column: 16
              end_line: 29
              file: 2
              start_column: 8
              start_line: 29
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 32
  }
}
body {
  eval {
    bind_id: 32
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table2"
            }
          }
        }
        src {
          end_column: 41
          end_line: 97
          file: 2
          start_column: 13
          start_line: 97
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 33
  }
}
body {
  bind {
    expr {
      write_copy_into_location {
        block: true
        location: "s3://testbucket"
        src {
          end_column: 94
          end_line: 99
          file: 2
          start_column: 8
          start_line: 99
        }
        storage_integration {
          value: "test_integration"
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 33
              }
            }
            src {
              end_column: 16
              end_line: 99
              file: 2
              start_column: 8
              start_line: 99
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 34
  }
}
body {
  eval {
    bind_id: 34
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table2"
            }
          }
        }
        src {
          end_column: 41
          end_line: 97
          file: 2
          start_column: 13
          start_line: 97
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 33
  }
}
body {
  bind {
    expr {
      write_copy_into_location {
        block: true
        location: "azure://testcontainer"
        src {
          end_column: 131
          end_line: 101
          file: 2
          start_column: 8
          start_line: 101
        }
        storage_integration {
          value: "test_integration"
        }
        validation_mode {
          value: "RETURN_ROWS"
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 33
              }
            }
            src {
              end_column: 16
              end_line: 99
              file: 2
              start_column: 8
              start_line: 99
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 35
  }
}
body {
  eval {
    bind_id: 35
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table2"
            }
          }
        }
        src {
          end_column: 41
          end_line: 97
          file: 2
          start_column: 13
          start_line: 97
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 33
  }
}
body {
  bind {
    expr {
      write_copy_into_location {
        block: true
        location: "gcp://teststorage"
        src {
          end_column: 87
          end_line: 103
          file: 2
          start_column: 8
          start_line: 103
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 33
              }
            }
            src {
              end_column: 16
              end_line: 99
              file: 2
              start_column: 8
              start_line: 99
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 36
  }
}
body {
  eval {
    bind_id: 36
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table2"
            }
          }
        }
        src {
          end_column: 41
          end_line: 97
          file: 2
          start_column: 13
          start_line: 97
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 33
  }
}
body {
  bind {
    expr {
      write_copy_into_location {
        block: true
        credentials {
          _1: "AWS_KEY_ID"
          _2 {
            string_val {
              src {
                end_column: 174
                end_line: 105
                file: 2
                start_column: 8
                start_line: 105
              }
              v: "awsid"
            }
          }
        }
        credentials {
          _1: "AWS_SECRET_KEY"
          _2 {
            string_val {
              src {
                end_column: 174
                end_line: 105
                file: 2
                start_column: 8
                start_line: 105
              }
              v: "!23@"
            }
          }
        }
        encryption {
          _1: "TYPE"
          _2 {
            null_val {
              src {
                end_column: 174
                end_line: 105
                file: 2
                start_column: 8
                start_line: 105
              }
            }
          }
        }
        encryption {
          _1: "MASTER_KEY"
          _2 {
            string_val {
              src {
                end_column: 174
                end_line: 105
                file: 2
                start_column: 8
                start_line: 105
              }
              v: "master key"
            }
          }
        }
        location: "gcp://teststorage"
        src {
          end_column: 174
          end_line: 105
          file: 2
          start_column: 8
          start_line: 105
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 33
              }
            }
            src {
              end_column: 16
              end_line: 99
              file: 2
              start_column: 8
              start_line: 99
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 37
  }
}
body {
  eval {
    bind_id: 37
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table2"
            }
          }
        }
        src {
          end_column: 41
          end_line: 97
          file: 2
          start_column: 13
          start_line: 97
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 33
  }
}
body {
  bind {
    expr {
      write_parquet {
        block: true
        location: "azure://testcontainer"
        src {
          end_column: 122
          end_line: 107
          file: 2
          start_column: 8
          start_line: 107
        }
        storage_integration {
          value: "test_integration"
        }
        validation_mode {
          value: "RETURN_3_ROWS"
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 33
              }
            }
            src {
              end_column: 16
              end_line: 99
              file: 2
              start_column: 8
              start_line: 99
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 38
  }
}
body {
  eval {
    bind_id: 38
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table2"
            }
          }
        }
        src {
          end_column: 41
          end_line: 97
          file: 2
          start_column: 13
          start_line: 97
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 33
  }
}
body {
  bind {
    expr {
      write_json {
        block: true
        credentials {
          _1: "AWS_KEY_ID"
          _2 {
            string_val {
              src {
                end_column: 158
                end_line: 109
                file: 2
                start_column: 8
                start_line: 109
              }
              v: "awsid"
            }
          }
        }
        credentials {
          _1: "AWS_SECRET_KEY"
          _2 {
            string_val {
              src {
                end_column: 158
                end_line: 109
                file: 2
                start_column: 8
                start_line: 109
              }
              v: "!23@"
            }
          }
        }
        encryption {
          _1: "TYPE"
          _2 {
            null_val {
              src {
                end_column: 158
                end_line: 109
                file: 2
                start_column: 8
                start_line: 109
              }
            }
          }
        }
        encryption {
          _1: "MASTER_KEY"
          _2 {
            string_val {
              src {
                end_column: 158
                end_line: 109
                file: 2
                start_column: 8
                start_line: 109
              }
              v: "master key"
            }
          }
        }
        location: "s3://testbucket"
        src {
          end_column: 158
          end_line: 109
          file: 2
          start_column: 8
          start_line: 109
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 33
              }
            }
            src {
              end_column: 16
              end_line: 99
              file: 2
              start_column: 8
              start_line: 99
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 39
  }
}
body {
  eval {
    bind_id: 39
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table2"
            }
          }
        }
        src {
          end_column: 41
          end_line: 97
          file: 2
          start_column: 13
          start_line: 97
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 33
  }
}
body {
  bind {
    expr {
      write_csv {
        block: true
        location: "azure://testcontainer"
        src {
          end_column: 149
          end_line: 111
          file: 2
          start_column: 8
          start_line: 111
        }
        storage_integration {
          value: "test_integration"
        }
        validation_mode {
          value: "RETURN_3_ROWS"
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 33
              }
            }
            src {
              end_column: 16
              end_line: 99
              file: 2
              start_column: 8
              start_line: 99
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 40
  }
}
body {
  eval {
    bind_id: 40
  }
}
body {
  bind {
    expr {
      table {
        name {
          name {
            name_flat {
              name: "table2"
            }
          }
        }
        src {
          end_column: 41
          end_line: 97
          file: 2
          start_column: 13
          start_line: 97
        }
        variant {
          session_table: true
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 33
  }
}
body {
  bind {
    expr {
      write_save {
        block: true
        credentials {
          _1: "AWS_KEY_ID"
          _2 {
            string_val {
              src {
                end_column: 237
                end_line: 113
                file: 2
                start_column: 8
                start_line: 113
              }
              v: "awsid"
            }
          }
        }
        credentials {
          _1: "AWS_SECRET_KEY"
          _2 {
            string_val {
              src {
                end_column: 237
                end_line: 113
                file: 2
                start_column: 8
                start_line: 113
              }
              v: "!23@"
            }
          }
        }
        encryption {
          _1: "TYPE"
          _2 {
            null_val {
              src {
                end_column: 237
                end_line: 113
                file: 2
                start_column: 8
                start_line: 113
              }
            }
          }
        }
        encryption {
          _1: "MASTER_KEY"
          _2 {
            string_val {
              src {
                end_column: 237
                end_line: 113
                file: 2
                start_column: 8
                start_line: 113
              }
              v: "master key"
            }
          }
        }
        location: "gcp://teststorage"
        partition_by {
          sql_expr {
            sql: "value"
            src {
              end_column: 237
              end_line: 113
              file: 2
              start_column: 8
              start_line: 113
            }
          }
        }
        src {
          end_column: 237
          end_line: 113
          file: 2
          start_column: 8
          start_line: 113
        }
        storage_integration {
          value: "test_integration"
        }
        writer {
          dataframe_writer {
            df {
              dataframe_ref {
                id: 33
              }
            }
            format {
              value: "json"
            }
            src {
              end_column: 16
              end_line: 99
              file: 2
              start_column: 8
              start_line: 99
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 41
  }
}
body {
  eval {
    bind_id: 41
  }
}
client_ast_version: 1
client_language {
  python_language {
    version {
      label: "final"
      major: 3
      minor: 9
      patch: 1
    }
  }
}
client_version {
  major: 1
  minor: 43
}
id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
