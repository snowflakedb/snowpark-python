## TEST CASE

df1 = session.flatten(parse_json(lit('{"a": [1,2]}')), "a", False, False, "BOTH")

df2 = session.flatten(col("NUM"), recursive=True, mode="ARRAY")

## EXPECTED UNPARSER OUTPUT

df1 = session.flatten(parse_json(lit("{\"a\": [1,2]}")), Some("a"), False, False, "BOTH")

df2 = session.flatten(col("NUM"), None, False, True, "ARRAY")

## EXPECTED ENCODED AST

Cq4CCqsCCpsCugqXAgrpAYoB5QEKNBoyCg4KDAoKcGFyc2VfanNvbhIgCD0QWhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAeKFoaigGKAYYBCi0aKwoHCgUKA2xpdBIgCDwQWhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSApKFoaM5oMMAogCDwQWhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSApKFoSDHsiYSI6IFsxLDJdfSIgCDwQWhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSApKFoiIAg9EFoaFlNSQ19QT1NJVElPTl9URVNUX01PREUgHihaEgIQASIDCgFhMiAIWRBaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oWhIFCgNkZjEYASICCAEKwgEKvwEKrwG6CqsBCoABigF9Ci0aKwoHCgUKA2NvbBIgCCgQXBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAeKFwaKpoMJwogCCgQXBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAeKFwSA05VTSIgCCgQXBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAeKFwSAggBKAEyIAhHEFwaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDihcEgUKA2RmMhgCIgIIAhABGhESDwoNCgVmaW5hbBADGAsgCSIEEAEYFQ==
