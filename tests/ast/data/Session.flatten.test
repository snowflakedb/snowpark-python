## TEST CASE

df1 = session.flatten(parse_json(lit('{"a": [1,2]}')), "a", False, False, "BOTH")

df2 = session.flatten(col("NUM"), recursive=True, mode="ARRAY")

## EXPECTED UNPARSER OUTPUT

df1 = session.flatten(parse_json(lit("{\"a\": [1,2]}")), Some("a"), False, False, "BOTH")

df2 = session.flatten(col("NUM"), None, False, True, "ARRAY")

## EXPECTED ENCODED AST

CoYCCoMCCvMBggrvAQrHAXrEAQouCiwKDgoMCgpwYXJzZV9qc29uEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVBp2enQKJwolCgcKBQoDbGl0EhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVBot6gsqChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVBIMeyJhIjogWzEsMl19IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVCIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFQSAhABIgMKAWEyGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShUEgUKA2RmMRgdIgIIHQqoAQqlAQqVAYIKkQEKbXprCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYaJOoLIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYSA05VTSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYSAggBKAEyGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShWEgUKA2RmMhgeIgIIHhABGhESDwoNCgVmaW5hbBADGAkgEyIEEAEYFQ==
