## TEST CASE

df1 = session.flatten(parse_json(lit('{"a": [1,2]}')), "a", False, False, "BOTH")

df2 = session.flatten(col("NUM"), recursive=True, mode="ARRAY")

## EXPECTED UNPARSER OUTPUT

df1 = session.flatten(parse_json(lit("{\"a\": [1,2]}")), Some("a"), False, False, "BOTH")

df2 = session.flatten(col("NUM"), None, False, True, "ARRAY")

## EXPECTED ENCODED AST

CqwCCqkCCpkCkgqVAgrnAXrkAQo0CjIKDgoMCgpwYXJzZV9qc29uEiAIPRBaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIB4oWhqJAXqGAQotCisKBwoFCgNsaXQSIAg8EFoaFlNSQ19QT1NJVElPTl9URVNUX01PREUgKShaGjP6CzAKIAg8EFoaFlNSQ19QT1NJVElPTl9URVNUX01PREUgKShaEgx7ImEiOiBbMSwyXX0iIAg8EFoaFlNSQ19QT1NJVElPTl9URVNUX01PREUgKShaIiAIPRBaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIB4oWhICEAEiAwoBYTIgCFkQWhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAOKFoSBQoDZGYxGAEiAggBCsABCr0BCq0BkgqpAQp/en0KLQorCgcKBQoDY29sEiAIKBBcGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIB4oXBoq+gsnCiAIKBBcGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIB4oXBIDTlVNIiAIKBBcGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIB4oXBICCAEoATIgCEcQXBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAOKFwSBQoDZGYyGAIiAggCEAEaERIPCg0KBWZpbmFsEAMYCyAJIgQQARgV
