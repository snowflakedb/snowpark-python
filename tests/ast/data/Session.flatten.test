## TEST CASE

df1 = session.flatten(parse_json(lit('{"a": [1,2]}')), "a", False, False, "BOTH")

df2 = session.flatten(col("NUM"), recursive=True, mode="ARRAY")

## EXPECTED UNPARSER OUTPUT



## EXPECTED ENCODED AST

CogCCoUCCvUBogrxAQrJAYoBxQEKLhosCg4KDAoKcGFyc2VfanNvbhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoad4oBdAonGiUKBwoFCgNsaXQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaGi2CDCoKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgx7ImEiOiBbMSwyXX0iGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhICEAEiAwoBYTIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSBQoDZGYxGAEiAggBCqkBCqYBCpYBogqSAQpuigFrCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwaJIIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSA05VTSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSAggBKAEyGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgUKA2RmMhgCIgIIAhABGhESDwoNCgVmaW5hbBADGAkgEyIEEAEYFQ==
