## TEST CASE

df = session.create_dataframe(
    [
        (1, 10000, "JAN"),
        (1, 400, "JAN"),
        (2, 4500, "JAN"),
        (2, 35000, "JAN"),
        (1, 5000, "FEB"),
        (1, 3000, "FEB"),
        (2, 200, "FEB"),
    ],
    schema=["k", "t", "mo"],
)

df1 = df.pivot("mo", ["JAN", "FEB"]).sum("t").sort("k")

df2 = df.pivot("mo", values=["JAN", "FEB"], default_on_null="Nothing").sum("t").sort("k")

## EXPECTED UNPARSER OUTPUT



## EXPECTED ENCODED AST

CrcICrQICqUI8gWhCAr0BwrxBwqNAaoMiQEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiGyAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAESIrICHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQkE4SJIIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSA0pBTgqNAaoMiQEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiGyAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAESIrICHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQkAMSJIIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSA0pBTgqNAaoMiQEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiGyAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAISIrICHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQlCMSJIIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSA0pBTgqOAaoMigEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiGyAh4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAISI7ICIAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQuJECEiSCDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgNKQU4KjQGqDIkBChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIhsgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhABEiKyAh8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEIgnEiSCDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgNGRUIKjQGqDIkBChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIhsgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhABEiKyAh8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaELgXEiSCDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgNGRUIKjQGqDIkBChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIhsgIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhACEiKyAh8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEMgBEiSCDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgNGRUISDAoKCgFrCgF0CgJtbxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSBAoCZGYYASICCAEK8wEK8AEK4AG6CNwBCh+CAxwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgeCAgQKAggBGiOCDCAKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgJtbyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcqbxJtCmvCAmgKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEiSCDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgNKQU4SJIIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSA0ZFQhIFCgNkZjEYAiICCAIKZQpjClSSC1EKA3N1bRImCiKCDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgF0EAEaBlIECgIIAiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSBQoDZGYxGAMiAggDCl8KXQpOkglLEiKCDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgFrGAEiB4ICBAoCCAMqGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgUKA2RmMRgEIgIIBAr8AQr5AQrpAboI5QEKKIIMJQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSB05vdGhpbmcSB4ICBAoCCAEaI4IMIAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSAm1vIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaSpvEm0Ka8ICaAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSJIIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSA0pBThIkggwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIDRkVCEgUKA2RmMhgFIgIIBQplCmMKVJILUQoDc3VtEiYKIoIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSAXQQARoGUgQKAggFIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIFCgNkZjIYBiICCAYKXwpdCk6SCUsSIoIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSAWsYASIHggIECgIIBioaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSBQoDZGYyGAciAggHEAEaERIPCg0KBWZpbmFsEAMYCSATIgQQARgV
