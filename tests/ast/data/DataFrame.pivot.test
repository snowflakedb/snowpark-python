## TEST CASE

df = session.create_dataframe(
    [
        (1, 10000, "JAN"),
        (1, 400, "JAN"),
        (2, 4500, "JAN"),
        (2, 35000, "JAN"),
        (1, 5000, "FEB"),
        (1, 3000, "FEB"),
        (2, 200, "FEB"),
    ],
    schema=["k", "t", "mo"],
)

df1 = df.pivot("mo", ["JAN", "FEB"]).sum("t").sort("k")

df2 = df.pivot("mo", values=["JAN", "FEB"], default_on_null="Nothing").sum("t").sort("k")

## EXPECTED UNPARSER OUTPUT

df = session.create_dataframe([(1, 10000, "JAN"), (1, 400, "JAN"), (2, 4500, "JAN"), (2, 35000, "JAN"), (1, 5000, "FEB"), (1, 3000, "FEB"), (2, 200, "FEB")], schema=["k", "t", "mo"])

df1 = df.pivot("mo", values=["JAN", "FEB"], default_on_null=None)

df1 = df1.sum("t")

df1 = df1.sort("k")

df2 = df.pivot("mo", values=["JAN", "FEB"], default_on_null="Nothing")

df2 = df2.sum("t")

df2 = df2.sort("k")

## EXPECTED ENCODED AST

<<<<<<< HEAD
CrcICrQICqUI8gWhCAr0BwrxBwqNAdIMiQEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAESIroCHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQkE4SJLIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSA0pBTgqNAdIMiQEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAESIroCHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQkAMSJLIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSA0pBTgqNAdIMiQEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAISIroCHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQlCMSJLIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSA0pBTgqOAdIMigEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAISI7oCIAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQuJECEiSyDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgNKQU4KjQHSDIkBChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhABEiK6Ah8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEIgnEiSyDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgNGRUIKjQHSDIkBChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhABEiK6Ah8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaELgXEiSyDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgNGRUIKjQHSDIkBChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhACEiK6Ah8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEMgBEiSyDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgNGRUISDAoKCgFrCgF0CgJtbxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSBAoCZGYYASICCAEK8wEK8AEK4AG6CNwBCh+KAxwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgeCAgQKAggBGiOyDCAKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgJtbyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcqbxJtCmvKAmgKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEiSyDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgNKQU4SJLIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSA0ZFQhIFCgNkZjEYAiICCAIKZQpjClSqC1EKA3N1bRImCiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgF0EAEaBlIECgIIAiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSBQoDZGYxGAMiAggDCl8KXQpOkglLEiKyDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgFrGAEiB4ICBAoCCAMqGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgUKA2RmMRgEIgIIBAr8AQr5AQrpAboI5QEKKLIMJQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSB05vdGhpbmcSB4ICBAoCCAEaI7IMIAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSAm1vIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaSpvEm0Ka8oCaAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSJLIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSA0pBThIksgwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIDRkVCEgUKA2RmMhgFIgIIBQplCmMKVKoLUQoDc3VtEiYKIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSAXQQARoGUgQKAggFIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIFCgNkZjIYBiICCAYKXwpdCk6SCUsSIrIMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSAWsYASIHggIECgIIBioaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSBQoDZGYyGAciAggHEAEaERIPCg0KBWZpbmFsEAMYCSAUIgQQARgX
=======
CrcICrQICqUI8gWhCAr0BwrxBwqNAfoMiQEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAESIroCHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQkE4SJNoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSA0pBTgqNAfoMiQEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAESIroCHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQkAMSJNoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSA0pBTgqNAfoMiQEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAISIroCHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQlCMSJNoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSA0pBTgqOAfoMigEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEiG6Ah4KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEAISI7oCIAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoQuJECEiTaDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgNKQU4KjQH6DIkBChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhABEiK6Ah8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEIgnEiTaDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgNGRUIKjQH6DIkBChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhABEiK6Ah8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaELgXEiTaDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgNGRUIKjQH6DIkBChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIhugIeChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhACEiK6Ah8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEMgBEiTaDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgNGRUISDAoKCgFrCgF0CgJtbxoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSBAoCZGYYASICCAEK8wEK8AEK4AG6CNwBCh+KAxwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgeCAgQKAggBGiPaDCAKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgJtbyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcqbxJtCmvKAmgKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEiTaDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgNKQU4SJNoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSA0ZFQhIFCgNkZjEYAiICCAIKZQpjClSqC1EKA3N1bRImCiLaDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgF0EAEaBlIECgIIAiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGcSBQoDZGYxGAMiAggDCl8KXQpOkglLEiLaDB8KGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgFrGAEiB4ICBAoCCAMqGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShnEgUKA2RmMRgEIgIIBAr8AQr5AQrpAboI5QEKKNoMJQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSB05vdGhpbmcSB4ICBAoCCAEaI9oMIAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSAm1vIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaSpvEm0Ka8oCaAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSJNoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSA0pBThIk2gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIDRkVCEgUKA2RmMhgFIgIIBQplCmMKVKoLUQoDc3VtEiYKItoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSAXQQARoGUgQKAggFIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaRIFCgNkZjIYBiICCAYKXwpdCk6SCUsSItoMHwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSAWsYASIHggIECgIIBioaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGkSBQoDZGYyGAciAggHEAEaERIPCg0KBWZpbmFsEAMYCSAUIgQQARgX
>>>>>>> 10efa4a6b (SNOW-1677859 Add table functions passthough dataframeAst)
