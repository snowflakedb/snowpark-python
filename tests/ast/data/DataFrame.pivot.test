## TEST CASE

df = session.create_dataframe(
    [
        (1, 10000, "JAN"),
        (1, 400, "JAN"),
        (2, 4500, "JAN"),
        (2, 35000, "JAN"),
        (1, 5000, "FEB"),
        (1, 3000, "FEB"),
        (2, 200, "FEB"),
    ],
    schema=["k", "t", "mo"],
)

df1 = df.pivot("mo", ["JAN", "FEB"]).sum("t").sort("k")

df2 = df.pivot("mo", values=["JAN", "FEB"], default_on_null="Nothing").sum("t").sort("k")

## EXPECTED UNPARSER OUTPUT

df = session.create_dataframe([(1, 10000, "JAN"), (1, 400, "JAN"), (2, 4500, "JAN"), (2, 35000, "JAN"), (1, 5000, "FEB"), (1, 3000, "FEB"), (2, 200, "FEB")], schema=["k", "t", "mo"])

df1 = df.pivot("mo", values=["JAN", "FEB"], default_on_null=None)

df1 = df1.sum("t")

df1 = df1.sort("k")

df2 = df.pivot("mo", values=["JAN", "FEB"], default_on_null="Nothing")

df2 = df2.sum("t")

df2 = df2.sort("k")

## EXPECTED ENCODED AST

CuUJCuIJCtMJ8gXPCQqcCQqZCQqlAdIMoQEKIAgJEGUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShaEie6AiQKIAgJEGUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShaEAESKLoCJQogCAkQZRoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKFoQkE4SKrIMJwogCAkQZRoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKFoSA0pBTgqlAdIMoQEKIAgJEGUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShaEie6AiQKIAgJEGUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShaEAESKLoCJQogCAkQZRoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKFoQkAMSKrIMJwogCAkQZRoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKFoSA0pBTgqlAdIMoQEKIAgJEGUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShaEie6AiQKIAgJEGUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShaEAISKLoCJQogCAkQZRoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKFoQlCMSKrIMJwogCAkQZRoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKFoSA0pBTgqmAdIMogEKIAgJEGUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShaEie6AiQKIAgJEGUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShaEAISKboCJgogCAkQZRoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKFoQuJECEiqyDCcKIAgJEGUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShaEgNKQU4KpQHSDKEBCiAICRBlGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oWhInugIkCiAICRBlGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oWhABEii6AiUKIAgJEGUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShaEIgnEiqyDCcKIAgJEGUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShaEgNGRUIKpQHSDKEBCiAICRBlGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oWhInugIkCiAICRBlGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oWhABEii6AiUKIAgJEGUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShaELgXEiqyDCcKIAgJEGUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShaEgNGRUIKpQHSDKEBCiAICRBlGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oWhInugIkCiAICRBlGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA0oWhACEii6AiUKIAgJEGUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShaEMgBEiqyDCcKIAgJEGUaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDShaEgNGRUISDAoKCgFrCgF0CgJtbxogCAkQZRoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKFoSBAoCZGYYASICCAEKmAIKlQIKhQK6CIECCiWKAyIKIAgsEGcaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDihnEgeCAgQKAggBGimyDCYKIAgsEGcaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDihnEgJtbyIgCCwQZxoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAOKGcqgQESfwp9ygJ6CiAILBBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oZxIqsgwnCiAILBBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oZxIDSkFOEiqyDCcKIAgsEGcaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDihnEgNGRUISBQoDZGYxGAIiAggCCnEKbwpgqgtdCgNzdW0SLAoosgwlCiAINRBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oZxIBdBABGgZSBAoCCAIiIAg1EGcaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDihnEgUKA2RmMRgDIgIIAwprCmkKWpIJVxIosgwlCiAIPxBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oZxIBaxgBIgeCAgQKAggDKiAIPxBnGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oZxIFCgNkZjEYBCICCAQKoQIKngIKjgK6CIoCCi6yDCsKIAhOEGkaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDihpEgdOb3RoaW5nEgeCAgQKAggBGimyDCYKIAhOEGkaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDihpEgJtbyIgCE4QaRoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAOKGkqgQESfwp9ygJ6CiAIThBpGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oaRIqsgwnCiAIThBpGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oaRIDSkFOEiqyDCcKIAhOEGkaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDihpEgNGRUISBQoDZGYyGAUiAggFCnEKbwpgqgtdCgNzdW0SLAoosgwlCiAIVxBpGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oaRIBdBABGgZSBAoCCAUiIAhXEGkaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDihpEgUKA2RmMhgGIgIIBgprCmkKWpIJVxIosgwlCiAIYRBpGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oaRIBaxgBIgeCAgQKAggGKiAIYRBpGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oaRIFCgNkZjIYByICCAcQARoREg8KDQoFZmluYWwQAxgLIAkiBBABGBU=
