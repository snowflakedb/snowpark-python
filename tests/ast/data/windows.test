## TEST CASE

from snowflake.snowpark.functions import col, avg, stddev

from snowflake.snowpark.window import Window

df = session.table(tables.table1)

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

window1 = Window.partition_by("value").order_by("key").rows_between(Window.CURRENT_ROW, 2)

window2 = Window.order_by(col("key").desc()).range_between(Window.UNBOUNDED_PRECEDING, Window.UNBOUNDED_FOLLOWING)

df3 = df.select(avg("value").over(window1).as_("window1"), avg("value").over(window2).as_("window2"))

df4 = df.select(stddev("value").over(Window.orderBy("key")))

df5 = df.select(stddev("value").over(Window.order_by("key", "value")))

df6 = df.select(avg("value").over(Window.partitionBy("key")))

df7 = df.select(avg("value").over(Window.partition_by("key")))

df8 = df.select(avg("value").over(Window.rangeBetween(0, 2)))

df9 = df.select(avg("value").over(Window.range_between(1, 2)))

df10 = df.select(avg("value").over(Window.rowsBetween(0, 2)))

df11 = df.select(avg("value").over(Window.rows_between(1, 2)))

df12 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.UNBOUNDED_FOLLOWING)))

df13 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.UNBOUNDED_PRECEDING)))

df14 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.unboundedFollowing)))

df15 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.unboundedPreceding)))

## EXPECTED UNPARSER OUTPUT

df = session.table("table1")

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

df3 = df.select(avg(col("value")).over(Window.partition_by(col("value")).order_by(col("key")).rows_between(Window.currentRow, 2)).as_("window1"), avg(col("value")).over(Window.order_by(col("key").desc()).range_between(Window.unboundedPreceding, Window.unboundedFollowing)).as_("window2"))

df4 = df.select(stddev(col("value")).over(Window.order_by(col("key"))))

df5 = df.select(stddev(col("value")).over(Window.order_by(col("key"), col("value"))))

df6 = df.select(avg(col("value")).over(Window.partition_by(col("key"))))

df7 = df.select(avg(col("value")).over(Window.partition_by(col("key"))))

df8 = df.select(avg(col("value")).over(Window.range_between(0, 2)))

df9 = df.select(avg(col("value")).over(Window.range_between(1, 2)))

df10 = df.select(avg(col("value")).over(Window.rows_between(0, 2)))

df11 = df.select(avg(col("value")).over(Window.rows_between(1, 2)))

df12 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedFollowing)))

df13 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedPreceding)))

df14 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedFollowing)))

df15 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedPreceding)))

## EXPECTED ENCODED AST

Cj8KPQovggwsEgoKCAoGdGFibGUxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHSICCAESBAoCZGYYASICCAEKuwIKuAIKqQKCCaUCCnyiBHkKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8SA05VTSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8SA2tleRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8iAggBCn6iBHsKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8SA1NUUiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKB8SBXZhbHVlGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoHyICCAESB4ICBAoCCAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgfIAESBAoCZGYYAiICCAIKiQgKhggK9geCCfIHCo8EogSLBArfA5oF2wMKggGSAX8KCxoJCgcKBQoDYXZnGlSSAVEKCxoJCgcKBQoDY29sGib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSglEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSglEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJRq3Aiq0AgoEEgIIAhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCEaAggBIosCEogCClKSAU8KCxoJCgcKBQoDY29sGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSghEgNrZXkiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSghEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIRqVARqSAQpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIRIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSghEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIRoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSghEgd3aW5kb3cxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJSICCAEKtgOiBLIDCoYDmgWCAwqCAZIBfwoLGgkKBwoFCgNhdmcaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCUSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCUSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSglGt4BItsBCgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMaAiABIrQBErEBCnPaBHAKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCMaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgjEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoIxoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgjEgd3aW5kb3cyGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJSICCAESB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSglIAESBQoDZGYzGAMiAggDCoADCv0CCu0CggnpAgq/ApoFuwIKhgGSAYIBCg4aDAoKCggKBnN0ZGRldhpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJxIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgnIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoJxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCcakwESkAEKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCcSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgnGh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCcSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgnIAESBQoDZGY0GAQiAggECtYDCtMDCsMDggm/AwqVA5oFkQMKhgGSAYIBCg4aDAoKCggKBnN0ZGRldhpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKRIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgpIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCka6QES5gEKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCkSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCkKVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCkSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCkaHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKRIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCkgARIFCgNkZjUYBSICCAUK/AIK+QIK6QKCCeUCCrsCmgW3AgqCAZIBfwoLGgkKBwoFCgNhdmcaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKCsSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgrGpMBGpABClKSAU8KCxoJCgcKBQoDY29sGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgrEgNrZXkiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgrEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKxoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgrEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoKyABEgUKA2RmNhgGIgIIBgr8Agr5AgrpAoIJ5QIKuwKaBbcCCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoLRIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgtIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoLRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKC0akwEakAEKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKC0SA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKC0SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgtGh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKC0SB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgtIAESBQoDZGY3GAciAggHCrACCq0CCp0CggmZAgrvAZoF6wEKggGSAX8KCxoJCgcKBQoDYXZnGlSSAVEKCxoJCgcKBQoDY29sGib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgvEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKC8iGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgvEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoLxpIIkYKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgvGgISACIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgvEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoLyABEgUKA2RmOBgIIgIICAqyAgqvAgqfAoIJmwIK8QGaBe0BCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoMRIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgxIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoMRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDEaSiJICgQSAggCEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoMRoEEgIIASIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgxEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoMSABEgUKA2RmORgJIgIICQqxAgquAgqdAoIJmQIK7wGaBesBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoMxIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSgzIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoMxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDMaSCpGCgQSAggCEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoMxoCEgAiHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoMxIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDMgARIGCgRkZjEwGAoiAggKCrMCCrACCp8CggmbAgrxAZoF7QEKggGSAX8KCxoJCgcKBQoDYXZnGlSSAVEKCxoJCgcKBQoDY29sGib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSg1EgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSg1EhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoNRpKKkgKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSg1GgQSAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDUSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSg1IAESBgoEZGYxMRgLIgIICwqvAgqsAgqbAoIJlwIK7QGaBekBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoNxIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSg3IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoNxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDcaRiJECgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDcaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDcSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSg3IAESBgoEZGYxMhgMIgIIDAqvAgqsAgqbAoIJlwIK7QGaBekBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoORIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSg5IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoORIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDkaRiJECgIgARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDkaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDkSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSg5IAESBgoEZGYxMxgNIgIIDQqvAgqsAgqbAoIJlwIK7QGaBekBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoOxIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSg7IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoOxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDsaRiJECgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDsaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKDsSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSg7IAESBgoEZGYxNBgOIgIIDgqvAgqsAgqbAoIJlwIK7QGaBekBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoPRIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSg9IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoPRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKD0aRiJECgIgARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKD0aAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKD0SB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSg9IAESBgoEZGYxNRgPIgIIDxABGhESDwoNCgVmaW5hbBADGAkgEiIEEAEYFw==
