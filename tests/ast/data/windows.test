## TEST CASE

from snowflake.snowpark.functions import col, avg, stddev

from snowflake.snowpark.window import Window

df = session.table("test_table")

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

window1 = Window.partition_by("value").order_by("key").rows_between(Window.CURRENT_ROW, 2)

window2 = Window.order_by(col("key").desc()).range_between(Window.UNBOUNDED_PRECEDING, Window.UNBOUNDED_FOLLOWING)

df3 = df.select(avg("value").over(window1).as_("window1"), avg("value").over(window2).as_("window2"))

df4 = df.select(stddev("value").over(Window.orderBy("key")))

df5 = df.select(stddev("value").over(Window.order_by("key", "value")))

df6 = df.select(avg("value").over(Window.partitionBy("key")))

df7 = df.select(avg("value").over(Window.partition_by("key")))

df8 = df.select(avg("value").over(Window.rangeBetween(0, 2)))

df9 = df.select(avg("value").over(Window.range_between(1, 2)))

df10 = df.select(avg("value").over(Window.rowsBetween(0, 2)))

df11 = df.select(avg("value").over(Window.rows_between(1, 2)))

df12 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.UNBOUNDED_FOLLOWING)))

df13 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.UNBOUNDED_PRECEDING)))

df14 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.unboundedFollowing)))

df15 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.unboundedPreceding)))

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

df3 = df.select(avg(col("value")).over(Window.partition_by(col("value")).order_by(col("key")).rows_between(Window.currentRow, 2)).as_("window1"), avg(col("value")).over(Window.order_by(col("key").desc()).range_between(Window.unboundedPreceding, Window.unboundedFollowing)).as_("window2"))

df4 = df.select(stddev(col("value")).over(Window.order_by(col("key"))))

df5 = df.select(stddev(col("value")).over(Window.order_by(col("key"), col("value"))))

df6 = df.select(avg(col("value")).over(Window.partition_by(col("key"))))

df7 = df.select(avg(col("value")).over(Window.partition_by(col("key"))))

df8 = df.select(avg(col("value")).over(Window.range_between(0, 2)))

df9 = df.select(avg(col("value")).over(Window.range_between(1, 2)))

df10 = df.select(avg(col("value")).over(Window.rows_between(0, 2)))

df11 = df.select(avg(col("value")).over(Window.rows_between(1, 2)))

df12 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedFollowing)))

df13 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedPreceding)))

df14 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedFollowing)))

df15 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedPreceding)))

## EXPECTED ENCODED AST

CkkKRwo54gs2Eg4KDAoKdGVzdF90YWJsZRogCCgQXhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKF4iAggBEgQKAmRmGAEiAggBCukCCuYCCtcC+gjTAgqPAZoEiwEKXooBWwoLGgkKBwoFCgNjb2waKrIMJwogCCEQYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGASA05VTSIgCCEQYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGASA2tleRogCCwQYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAXKGAiAggBCpEBmgSNAQpeigFbCgsaCQoHCgUKA2NvbBoqsgwnCiAIOBBgGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIC4oYBIDU1RSIiAIOBBgGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIC4oYBIFdmFsdWUaIAhFEGAaFlNSQ19QT1NJVElPTl9URVNUX01PREUgLihgIgIIARIHggIECgIIARogCEYQYBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKGAgARIECgJkZhgCIgIIAgqjCQqgCQqQCfoIjAkK3gSaBNoECqgEkgWkBAqVAYoBkQEKCxoJCgcKBQoDYXZnGmCKAV0KCxoJCgcKBQoDY29sGiyyDCkKIAgkEGYaFlNSQ19QT1NJVElPTl9URVNUX01PREUgGChmEgV2YWx1ZSIgCCQQZhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAYKGYiIAgkEGYaFlNSQ19QT1NJVElPTl9URVNUX01PREUgGChmEiAIMhBmGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBgoZhrnAirkAgoEEgIIAhIgCGIQYhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSASKGIaAggBIrUCErICCl6KAVsKCxoJCgcKBQoDY29sGiqyDCcKIAg+EGIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihiEgNrZXkiIAg+EGIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihiEiAIPhBiGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIoYhqtARqqAQpgigFdCgsaCQoHCgUKA2NvbBossgwpCiAILhBiGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIoYhIFdmFsdWUiIAguEGIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihiEiAILhBiGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIoYhokCiIKIAguEGIaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihiEgd3aW5kb3cxGiAIQRBmGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBgoZiICCAEK+wOaBPcDCsUDkgXBAwqVAYoBkQEKCxoJCgcKBQoDYXZnGmCKAV0KCxoJCgcKBQoDY29sGiyyDCkKIAhPEGYaFlNSQ19QT1NJVElPTl9URVNUX01PREUgQyhmEgV2YWx1ZSIgCE8QZhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSBDKGYiIAhPEGYaFlNSQ19QT1NJVElPTl9URVNUX01PREUgQyhmEiAIXRBmGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIEMoZhqEAiKBAgoCGAESIAh6EGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihkGgIgASLUARLRAQqGAdIEggEKXooBWwoLGgkKBwoFCgNjb2waKrIMJwogCCwQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAiKGQSA2tleSIgCCwQZBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAiKGQaIAgzEGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgIihkEiAINBBkGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBIoZBokCiIKIAg0EGQaFlNSQ19QT1NJVElPTl9URVNUX01PREUgEihkEgd3aW5kb3cyGiAIbBBmGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIEMoZiICCAESB4ICBAoCCAIaIAhtEGYaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDihmIAESBQoDZGYzGAMiAggDCrYDCrMDCqMD+gifAwrvApIF6wIKmAGKAZQBCg4aDAoKCggKBnN0ZGRldhpgigFdCgsaCQoHCgUKA2NvbBossgwpCiAIJxBoGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIBgoaBIFdmFsdWUiIAgnEGgaFlNSQ19QT1NJVElPTl9URVNUX01PREUgGChoIiAIJxBoGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RF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
