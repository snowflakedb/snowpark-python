## TEST CASE

from snowflake.snowpark.functions import col, avg, stddev

from snowflake.snowpark.window import Window

df = session.table("test_table")

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

window1 = Window.partition_by("value").order_by("key").rows_between(Window.CURRENT_ROW, 2)

window2 = Window.order_by(col("key").desc()).range_between(Window.UNBOUNDED_PRECEDING, Window.UNBOUNDED_FOLLOWING)

df3 = df.select(avg("value").over(window1).as_("window1"), avg("value").over(window2).as_("window2"))

df4 = df.select(stddev("value").over(Window.orderBy("key")))

df5 = df.select(stddev("value").over(Window.order_by("key", "value")))

df6 = df.select(avg("value").over(Window.partitionBy("key")))

df7 = df.select(avg("value").over(Window.partition_by("key")))

df8 = df.select(avg("value").over(Window.rangeBetween(0, 2)))

df9 = df.select(avg("value").over(Window.range_between(1, 2)))

df10 = df.select(avg("value").over(Window.rowsBetween(0, 2)))

df11 = df.select(avg("value").over(Window.rows_between(1, 2)))

df12 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.UNBOUNDED_FOLLOWING)))

df13 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.UNBOUNDED_PRECEDING)))

df14 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.unboundedFollowing)))

df15 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.unboundedPreceding)))

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

df3 = df.select(avg(col("value")).over(Window.partition_by(col("value")).order_by(col("key")).rows_between(Window.currentRow, 2)).as_("window1"), avg(col("value")).over(Window.order_by(col("key").desc()).range_between(Window.unboundedPreceding, Window.unboundedFollowing)).as_("window2"))

df4 = df.select(stddev(col("value")).over(Window.order_by(col("key"))))

df5 = df.select(stddev(col("value")).over(Window.order_by(col("key"), col("value"))))

df6 = df.select(avg(col("value")).over(Window.partition_by(col("key"))))

df7 = df.select(avg(col("value")).over(Window.partition_by(col("key"))))

df8 = df.select(avg(col("value")).over(Window.range_between(0, 2)))

df9 = df.select(avg(col("value")).over(Window.range_between(1, 2)))

df10 = df.select(avg(col("value")).over(Window.rows_between(0, 2)))

df11 = df.select(avg(col("value")).over(Window.rows_between(1, 2)))

df12 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedFollowing)))

df13 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedPreceding)))

df14 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedFollowing)))

df15 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedPreceding)))

## EXPECTED ENCODED AST

CkMKQQozqgswEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4iAggBEgQKAmRmGAEiAggBCvUCCvICCuMC6gjfAgqYAfoDlAEKbXprCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAaJPILIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGASA05VTSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGASA2tleRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAiAggBCpoB+gOWAQptemsKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBok8gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIDU1RSIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIFdmFsdWUaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgIgIIARIHigIECgIIARoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAgARIECgJkZhgCIgIIAgrKCQrHCQq3CeoIswkK/AT6A/gECswE8gTIBAq5AXq2AQonCiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmGm96bQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmGibyCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhrtAirqAgoEEgIIAhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGIaAggBIsECEr4CCm16awonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiGiTyCyEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgNrZXkiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhqwARqtAQpvem0KJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhom8gsjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgd3aW5kb3cxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZiICCAEKigT6A4YECtoD8gTWAwq5AXq2AQonCiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmGm96bQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmGibyCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhr7ASL4AQoCGAESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGgIgASLRARLOAQqPAbIEiwEKbXprCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaJPILIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEgd3aW5kb3cyGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZiICCAESB4oCBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmIAESBQoDZGYzGAMiAggDCtEDCs4DCr4D6gi6AwqQA/IEjAMKvAF6uQEKKgooCgoKCAoGc3RkZGV2EhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBpvem0KJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBom8gsjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgargESqwEKbXprCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgaJPILIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoGh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSB4oCBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoIAESBQoDZGY0GAQiAggECsIECr8ECq8E6girBAqBBPIE/QMKvAF6uQEKKgooCgoKCAoGc3RkZGV2EhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahpvem0KJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahom8gsjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoanwISnAIKbXprCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoaJPILIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoKb3ptCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoaJvILIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoaHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIHigIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGogARIFCgNkZjUYBSICCAUKzgMKywMKuwPqCLcDCo0D8gSJAwq5AXq2AQonCiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsGm96bQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsGibyCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBquARqrAQptemsKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBok8gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIDa2V5IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIHigIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwgARIFCgNkZjYYBiICCAYKzgMKywMKuwPqCLcDCo0D8gSJAwq5AXq2AQonCiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuGm96bQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuGibyCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4iGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhquARqrAQptemsKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhok8gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhIDa2V5IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4aHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhIHigIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4gARIFCgNkZjcYByICCAcK5wIK5AIK1ALqCNACCqYC8gSiAgq5AXq2AQonCiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwGm96bQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwGibyCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBpIIkYKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwGgISACIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEgeKAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocCABEgUKA2RmOBgIIgIICArpAgrmAgrWAuoI0gIKqALyBKQCCrkBerYBCicKJQoHCgUKA2F2ZxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHIab3ptCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHIaJvILIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHISBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUociIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyGkoiSAoEEgIIAhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHIaBBICCAEiHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUochIHigIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHIgARIFCgNkZjkYCSICCAkK6AIK5QIK1ALqCNACCqYC8gSiAgq5AXq2AQonCiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0Gm96bQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0GibyCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBpIKkYKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0GgISACIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EgeKAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodCABEgYKBGRmMTAYCiICCAoK6gIK5wIK1gLqCNICCqgC8gSkAgq5AXq2AQonCiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh2Gm96bQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh2GibyCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh2EgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHYiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh2EhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodhpKKkgKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh2GgQSAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHYSB4oCBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh2IAESBgoEZGYxMRgLIgIICwrmAgrjAgrSAuoIzgIKpALyBKACCrkBerYBCicKJQoHCgUKA2F2ZxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHgab3ptCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHgaJvILIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHgSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoeCIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh4GkYiRAoCGAESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh4GgIIASIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh4EgeKAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoeCABEgYKBGRmMTIYDCICCAwK5gIK4wIK0gLqCM4CCqQC8gSgAgq5AXq2AQonCiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh6Gm96bQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh6GibyCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh6EgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHoiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh6EhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoehpGIkQKAiABEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoehoCCAEiHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoehIHigIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHogARIGCgRkZjEzGA0iAggNCuYCCuMCCtIC6gjOAgqkAvIEoAIKuQF6tgEKJwolCgcKBQoDYXZnEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUofBpvem0KJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUofBom8gsjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUofBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh8IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUofBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHwaRiJECgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHwaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHwSB4oCBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh8IAESBgoEZGYxNBgOIgIIDgrmAgrjAgrSAuoIzgIKpALyBKACCrkBerYBCicKJQoHCgUKA2F2ZxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKH4ab3ptCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKH4aJvILIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKH4SBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUofiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKH4SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh+GkYiRAoCIAESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh+GgIIASIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh+EgeKAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUofiABEgYKBGRmMTUYDyICCA8QARoREg8KDQoFZmluYWwQAxgIIBMiBBABGBU=
