## TEST CASE

from snowflake.snowpark.functions import col, avg, stddev

from snowflake.snowpark.window import Window

df = session.table("test_table")

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

window1 = Window.partition_by("value").order_by("key").rows_between(Window.CURRENT_ROW, 2)

window2 = Window.order_by(col("key").desc()).range_between(Window.UNBOUNDED_PRECEDING, Window.UNBOUNDED_FOLLOWING)

df3 = df.select(avg("value").over(window1).as_("window1"), avg("value").over(window2).as_("window2"))

df4 = df.select(stddev("value").over(Window.orderBy("key")))

df5 = df.select(stddev("value").over(Window.order_by("key", "value")))

df6 = df.select(avg("value").over(Window.partitionBy("key")))

df7 = df.select(avg("value").over(Window.partition_by("key")))

df8 = df.select(avg("value").over(Window.rangeBetween(0, 2)))

df9 = df.select(avg("value").over(Window.range_between(1, 2)))

df10 = df.select(avg("value").over(Window.rowsBetween(0, 2)))

df11 = df.select(avg("value").over(Window.rows_between(1, 2)))

df12 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.UNBOUNDED_FOLLOWING)))

df13 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.UNBOUNDED_PRECEDING)))

df14 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.unboundedFollowing)))

df15 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.unboundedPreceding)))

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

df3 = df.select(avg(col("value")).over(Window.partition_by(col("value")).order_by(col("key")).rows_between(Window.currentRow, 2)).as_("window1"), avg(col("value")).over(Window.order_by(col("key").desc()).range_between(Window.unboundedPreceding, Window.unboundedFollowing)).as_("window2"))

df4 = df.select(stddev(col("value")).over(Window.order_by(col("key"))))

df5 = df.select(stddev(col("value")).over(Window.order_by(col("key"), col("value"))))

df6 = df.select(avg(col("value")).over(Window.partition_by(col("key"))))

df7 = df.select(avg(col("value")).over(Window.partition_by(col("key"))))

df8 = df.select(avg(col("value")).over(Window.range_between(0, 2)))

df9 = df.select(avg(col("value")).over(Window.range_between(1, 2)))

df10 = df.select(avg(col("value")).over(Window.rows_between(0, 2)))

df11 = df.select(avg(col("value")).over(Window.rows_between(1, 2)))

df12 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedFollowing)))

df13 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedPreceding)))

df14 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedFollowing)))

df15 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedPreceding)))

## EXPECTED ENCODED AST

CkMKQQozggwwEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4iAggBEgQKAmRmGAEiAggBCrsCCrgCCqkCggmlAgp8ogR5ClKSAU8KCxoJCgcKBQoDY29sGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgNOVU0iGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgNrZXkaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgIgIIAQp+ogR7ClKSAU8KCxoJCgcKBQoDY29sGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgNTVFIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgV2YWx1ZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAiAggBEgeCAgQKAggBGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYCABEgQKAmRmGAIiAggCCokICoYICvYHggnyBwqPBKIEiwQK3wOaBdsDCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYatwIqtAIKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiGgIIASKLAhKIAgpSkgFPCgsaCQoHCgUKA2NvbBok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIDa2V5IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGIalQEakgEKVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGIaHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIHd2luZG93MRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYiAggBCrYDogSyAwqGA5oFggMKggGSAX8KCxoJCgcKBQoDYXZnGlSSAVEKCxoJCgcKBQoDY29sGib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhreASLbAQoCGAESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGgIgASK0ARKxAQpz2gRwClKSAU8KCxoJCgcKBQoDY29sGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEgNrZXkiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIHd2luZG93MhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYiAggBEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZiABEgUKA2RmMxgDIgIIAwqAAwr9AgrtAoIJ6QIKvwKaBbsCCoYBkgGCAQoOGgwKCgoICgZzdGRkZXYaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaCIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoGpMBEpABClKSAU8KCxoJCgcKBQoDY29sGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoEgNrZXkiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaCABEgUKA2RmNBgEIgIIBArWAwrTAwrDA4IJvwMKlQOaBZEDCoYBkgGCAQoOGgwKCgoICgZzdGRkZXYaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqGukBEuYBClKSAU8KCxoJCgcKBQoDY29sGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEgNrZXkiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqClSSAVEKCxoJCgcKBQoDY29sGib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqGh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqIAESBQoDZGY1GAUiAggFCvwCCvkCCukCggnlAgq7ApoFtwIKggGSAX8KCxoJCgcKBQoDYXZnGlSSAVEKCxoJCgcKBQoDY29sGib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBqTARqQAQpSkgFPCgsaCQoHCgUKA2NvbBok+gwhChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIDa2V5IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwgARIFCgNkZjYYBiICCAYK/AIK+QIK6QKCCeUCCrsCmgW3AgqCAZIBfwoLGgkKBwoFCgNhdmcaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4SBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuGpMBGpABClKSAU8KCxoJCgcKBQoDY29sGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEgNrZXkiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobiABEgUKA2RmNxgHIgIIBwqwAgqtAgqdAoIJmQIK7wGaBesBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAaSCJGCgQSAggCEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBoCEgAiHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAgARIFCgNkZjgYCCICCAgKsgIKrwIKnwKCCZsCCvEBmgXtAQqCAZIBfwoLGgkKBwoFCgNhdmcaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHISBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUociIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyGkoiSAoEEgIIAhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHIaBBICCAEiHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUochIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHIgARIFCgNkZjkYCSICCAkKsQIKrgIKnQKCCZkCCu8BmgXrAQqCAZIBfwoLGgkKBwoFCgNhdmcaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodCIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0GkgqRgoEEgIIAhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQaAhIAIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0IAESBgoEZGYxMBgKIgIICgqzAgqwAgqfAoIJmwIK8QGaBe0BCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodhIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh2IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHYaSipICgQSAggCEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodhoEEgIIASIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh2EgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodiABEgYKBGRmMTEYCyICCAsKrwIKrAIKmwKCCZcCCu0BmgXpAQqCAZIBfwoLGgkKBwoFCgNhdmcaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHgSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoeCIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh4GkYiRAoCGAESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh4GgIIASIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh4EgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoeCABEgYKBGRmMTIYDCICCAwKrwIKrAIKmwKCCZcCCu0BmgXpAQqCAZIBfwoLGgkKBwoFCgNhdmcaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHoSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoeiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh6GkYiRAoCIAESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh6GgIIASIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh6EgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoeiABEgYKBGRmMTMYDSICCA0KrwIKrAIKmwKCCZcCCu0BmgXpAQqCAZIBfwoLGgkKBwoFCgNhdmcaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHwSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUofCIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHwSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh8GkYiRAoCGAESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh8GgIIASIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh8EgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUofCABEgYKBGRmMTQYDiICCA4KrwIKrAIKmwKCCZcCCu0BmgXpAQqCAZIBfwoLGgkKBwoFCgNhdmcaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKH4SBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUofiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKH4SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh+GkYiRAoCIAESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh+GgIIASIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh+EgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUofiABEgYKBGRmMTUYDyICCA8QARoREg8KDQoFZmluYWwQAxgJIBIiBBABGBc=
