## TEST CASE

from snowflake.snowpark.functions import col, avg, stddev

from snowflake.snowpark.window import Window

df = session.table("test_table")

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

window1 = Window.partition_by("value").order_by("key").rows_between(Window.CURRENT_ROW, 2)

window2 = Window.order_by(col("key").desc()).range_between(Window.UNBOUNDED_PRECEDING, Window.UNBOUNDED_FOLLOWING)

df3 = df.select(avg("value").over(window1).as_("window1"), avg("value").over(window2).as_("window2"))

df4 = df.select(stddev("value").over(Window.orderBy("key")))

df5 = df.select(stddev("value").over(Window.order_by("key", "value")))

df6 = df.select(avg("value").over(Window.partitionBy("key")))

df7 = df.select(avg("value").over(Window.partition_by("key")))

df8 = df.select(avg("value").over(Window.rangeBetween(0, 2)))

df9 = df.select(avg("value").over(Window.range_between(1, 2)))

df10 = df.select(avg("value").over(Window.rowsBetween(0, 2)))

df11 = df.select(avg("value").over(Window.rows_between(1, 2)))

df12 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.UNBOUNDED_FOLLOWING)))

df13 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.UNBOUNDED_PRECEDING)))

df14 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.unboundedFollowing)))

df15 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.unboundedPreceding)))

## EXPECTED UNPARSER OUTPUT



## EXPECTED ENCODED AST

CkMKQQozwgswEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4iAggBEgQKAmRmGAEiAggBCvcCCvQCCuUC+gjhAgqZAZoElQEKbooBawonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgGiSCDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgNOVU0iGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgNrZXkaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgIgIIAQqbAZoElwEKbooBawonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgGiSCDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgNTVFIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgV2YWx1ZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAiAggBEgeCAgQKAggBGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYCABEgQKAmRmGAIiAggCCtEJCs4JCr4J+gi6CQqABZoE/AQK0ASSBcwECrsBigG3AQonGiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmGnCKAW0KJxolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhomggwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYa7wIq7AIKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiGgIIASLDAhLAAgpuigFrCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGIaJIIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiGrEBGq4BCnCKAW0KJxolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhomggwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgd3aW5kb3cxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZiICCAEKjQSaBIkECt0DkgXZAwq7AYoBtwEKJxolCgcKBQoDYXZnEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhpwigFtCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYaJoIMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmGvwBIvkBCgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaAiABItIBEs8BCpAB0gSMAQpuigFrCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaJIIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkEgd3aW5kb3cyGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZiICCAESB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmIAESBQoDZGYzGAMiAggDCtQDCtEDCsED+gi9AwqTA5IFjwMKvgGKAboBCioaKAoKCggKBnN0ZGRldhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgacIoBbQonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoGiaCDCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBqvARKsAQpuigFrCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgaJIIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoGh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoIAESBQoDZGY0GAQiAggECsYECsMECrME+givBAqFBJIFgQQKvgGKAboBCioaKAoKCggKBnN0ZGRldhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoacIoBbQonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqGiaCDCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahqhAhKeAgpuigFrCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoaJIIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoKcIoBbQonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqGiaCDCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqGh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqIAESBQoDZGY1GAUiAggFCtEDCs4DCr4D+gi6AwqQA5IFjAMKuwGKAbcBCicaJQoHCgUKA2F2ZxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwacIoBbQonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsGiaCDCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBqvARqsAQpuigFrCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaJIIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsGh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsIAESBQoDZGY2GAYiAggGCtEDCs4DCr4D+gi6AwqQA5IFjAMKuwGKAbcBCicaJQoHCgUKA2F2ZxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4acIoBbQonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuGiaCDCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4iGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhqvARqsAQpuigFrCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4aJIIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4SA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuGh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4SB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuIAESBQoDZGY3GAciAggHCukCCuYCCtYC+gjSAgqoApIFpAIKuwGKAbcBCicaJQoHCgUKA2F2ZxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAacIoBbQonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwGiaCDCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBpIIkYKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwGgISACIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocCABEgUKA2RmOBgIIgIICArrAgroAgrYAvoI1AIKqgKSBaYCCrsBigG3AQonGiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyGnCKAW0KJxolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUochomggwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUochIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUochIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHIaSiJICgQSAggCEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUochoEEgIIASIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUociABEgUKA2RmORgJIgIICQrqAgrnAgrWAvoI0gIKqAKSBaQCCrsBigG3AQonGiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0GnCKAW0KJxolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBomggwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQaSCpGCgQSAggCEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBoCEgAiHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQgARIGCgRkZjEwGAoiAggKCuwCCukCCtgC+gjUAgqqApIFpgIKuwGKAbcBCicaJQoHCgUKA2F2ZxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHYacIoBbQonGiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh2GiaCDCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh2EgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHYiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh2EhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodhpKKkgKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh2GgQSAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHYSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh2IAESBgoEZGYxMRgLIgIICwroAgrlAgrUAvoI0AIKpgKSBaICCrsBigG3AQonGiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh4GnCKAW0KJxolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoeBomggwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoeBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh4IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoeBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHgaRiJECgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHgaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHgSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh4IAESBgoEZGYxMhgMIgIIDAroAgrlAgrUAvoI0AIKpgKSBaICCrsBigG3AQonGiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh6GnCKAW0KJxolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoehomggwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoehIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh6IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoehIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHoaRiJECgIgARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHoaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHoSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh6IAESBgoEZGYxMxgNIgIIDQroAgrlAgrUAvoI0AIKpgKSBaICCrsBigG3AQonGiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh8GnCKAW0KJxolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUofBomggwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUofBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh8IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUofBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHwaRiJECgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHwaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHwSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh8IAESBgoEZGYxNBgOIgIIDgroAgrlAgrUAvoI0AIKpgKSBaICCrsBigG3AQonGiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh+GnCKAW0KJxolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUofhomggwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUofhIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh+IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUofhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKH4aRiJECgIgARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKH4aAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKH4SB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh+IAESBgoEZGYxNRgPIgIIDxABGhESDwoNCgVmaW5hbBADGAkgEyIEEAEYFQ==
