## TEST CASE

from snowflake.snowpark.functions import col, avg, stddev

from snowflake.snowpark.window import Window

df = session.table(tables.table1)

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

window1 = Window.partition_by("value").order_by("key").rows_between(Window.CURRENT_ROW, 2)

window2 = Window.order_by(col("key").desc()).range_between(Window.UNBOUNDED_PRECEDING, Window.UNBOUNDED_FOLLOWING)

df3 = df.select(avg("value").over(window1).as_("window1"), avg("value").over(window2).as_("window2"))

df4 = df.select(stddev("value").over(Window.orderBy("key")))

df5 = df.select(stddev("value").over(Window.order_by("key", "value")))

df6 = df.select(avg("value").over(Window.partitionBy("key")))

df7 = df.select(avg("value").over(Window.partition_by("key")))

df8 = df.select(avg("value").over(Window.rangeBetween(0, 2)))

df9 = df.select(avg("value").over(Window.range_between(1, 2)))

df10 = df.select(avg("value").over(Window.rowsBetween(0, 2)))

df11 = df.select(avg("value").over(Window.rows_between(1, 2)))

df12 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.UNBOUNDED_FOLLOWING)))

df13 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.UNBOUNDED_PRECEDING)))

df14 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.unboundedFollowing)))

df15 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.unboundedPreceding)))

## EXPECTED UNPARSER OUTPUT

df = session.table("table1")

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

df3 = df.select(avg(col("value")).over(Window.partition_by(col("value")).order_by(col("key")).rows_between(Window.currentRow, 2)).as_("window1"), avg(col("value")).over(Window.order_by(col("key").desc()).range_between(Window.unboundedPreceding, Window.unboundedFollowing)).as_("window2"))

df4 = df.select(stddev(col("value")).over(Window.order_by(col("key"))))

df5 = df.select(stddev(col("value")).over(Window.order_by(col("key"), col("value"))))

df6 = df.select(avg(col("value")).over(Window.partition_by(col("key"))))

df7 = df.select(avg(col("value")).over(Window.partition_by(col("key"))))

df8 = df.select(avg(col("value")).over(Window.range_between(0, 2)))

df9 = df.select(avg(col("value")).over(Window.range_between(1, 2)))

df10 = df.select(avg(col("value")).over(Window.rows_between(0, 2)))

df11 = df.select(avg(col("value")).over(Window.rows_between(1, 2)))

df12 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedFollowing)))

df13 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedPreceding)))

df14 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedFollowing)))

df15 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedPreceding)))

## EXPECTED ENCODED AST

Cj8KPQovggwsEgoKCAoGdGFibGUxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoQyICCAESBAoCZGYYASICCAEKuwIKuAIKqQKCCaUCCnyiBHkKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEUSA05VTSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEUSA2tleRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEUiAggBCn6iBHsKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEUSA1NUUiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEUSBXZhbHVlGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRSICCAESB4ICBAoCCAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShFIAESBAoCZGYYAiICCAIKiQgKhggK9geCCfIHCo8EogSLBArfA5oF2wMKggGSAX8KCxoJCgcKBQoDYXZnGlSSAVEKCxoJCgcKBQoDY29sGib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShLEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEsiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShLEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSxq3Aiq0AgoEEgIIAhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEcaAggBIosCEogCClKSAU8KCxoJCgcKBQoDY29sGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShHEgNrZXkiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShHEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRxqVARqSAQpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRxIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShHEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRxoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShHEgd3aW5kb3cxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSyICCAEKtgOiBLIDCoYDmgWCAwqCAZIBfwoLGgkKBwoFCgNhdmcaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEsSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSyIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEsSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShLGt4BItsBCgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEkaAiABIrQBErEBCnPaBHAKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEkSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEkaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShJEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSRoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShJEgd3aW5kb3cyGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSyICCAESB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShLIAESBQoDZGYzGAMiAggDCoADCv0CCu0CggnpAgq/ApoFuwIKhgGSAYIBCg4aDAoKCggKBnN0ZGRldhpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTRIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShNIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE0akwESkAEKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE0SA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE0SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShNGh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE0SB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShNIAESBQoDZGY0GAQiAggECtYDCtMDCsMDggm/AwqVA5oFkQMKhgGSAYIBCg4aDAoKCggKBnN0ZGRldhpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTxIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShPIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE8a6QES5gEKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE8SA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE8KVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE8SBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE8aHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTxIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE8gARIFCgNkZjUYBSICCAUK/AIK+QIK6QKCCeUCCrsCmgW3AgqCAZIBfwoLGgkKBwoFCgNhdmcaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFESBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShRGpMBGpABClKSAU8KCxoJCgcKBQoDY29sGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShREgNrZXkiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShREhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoURoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShREgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUSABEgUKA2RmNhgGIgIIBgr8Agr5AgrpAoIJ5QIKuwKaBbcCCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUxIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShTIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFMakwEakAEKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFMSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFMSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShTGh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFMSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShTIAESBQoDZGY3GAciAggHCrACCq0CCp0CggmZAgrvAZoF6wEKggGSAX8KCxoJCgcKBQoDYXZnGlSSAVEKCxoJCgcKBQoDY29sGib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShVEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShVEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVRpIIkYKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShVGgISACIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShVEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVSABEgUKA2RmOBgIIgIICAqyAgqvAgqfAoIJmwIK8QGaBe0BCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVxIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShXIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFcaSiJICgQSAggCEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVxoEEgIIASIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShXEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVyABEgUKA2RmORgJIgIICQqxAgquAgqdAoIJmQIK7wGaBesBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWRIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShZIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFkaSCpGCgQSAggCEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWRoCEgAiHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWRIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFkgARIGCgRkZjEwGAoiAggKCrMCCrACCp8CggmbAgrxAZoF7QEKggGSAX8KCxoJCgcKBQoDYXZnGlSSAVEKCxoJCgcKBQoDY29sGib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShbEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFsiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShbEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWxpKKkgKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShbGgQSAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFsSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShbIAESBgoEZGYxMRgLIgIICwqvAgqsAgqbAoIJlwIK7QGaBekBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXRIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShdIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF0aRiJECgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF0aAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF0SB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShdIAESBgoEZGYxMhgMIgIIDAqvAgqsAgqbAoIJlwIK7QGaBekBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXxIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShfIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF8aRiJECgIgARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF8aAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF8SB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShfIAESBgoEZGYxMxgNIgIIDQqvAgqsAgqbAoIJlwIK7QGaBekBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYRIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShhIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYRIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGEaRiJECgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGEaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGESB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShhIAESBgoEZGYxNBgOIgIIDgqvAgqsAgqbAoIJlwIK7QGaBekBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYxIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShjIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGMaRiJECgIgARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGMaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGMSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShjIAESBgoEZGYxNRgPIgIIDxABGhESDwoNCgVmaW5hbBADGAkgFCIEEAEYFw==
