## TEST CASE

from snowflake.snowpark.functions import col, avg, stddev

from snowflake.snowpark.window import Window

df = session.table(tables.table1)

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

window1 = Window.partition_by("value").order_by("key").rows_between(Window.CURRENT_ROW, 2)

window2 = Window.order_by(col("key").desc()).range_between(Window.UNBOUNDED_PRECEDING, Window.UNBOUNDED_FOLLOWING)

df3 = df.select(avg("value").over(window1).as_("window1"), avg("value").over(window2).as_("window2"))

df4 = df.select(stddev("value").over(Window.orderBy("key")))

df5 = df.select(stddev("value").over(Window.order_by("key", "value")))

df6 = df.select(avg("value").over(Window.partitionBy("key")))

df7 = df.select(avg("value").over(Window.partition_by("key")))

df8 = df.select(avg("value").over(Window.rangeBetween(0, 2)))

df9 = df.select(avg("value").over(Window.range_between(1, 2)))

df10 = df.select(avg("value").over(Window.rowsBetween(0, 2)))

df11 = df.select(avg("value").over(Window.rows_between(1, 2)))

df12 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.UNBOUNDED_FOLLOWING)))

df13 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.UNBOUNDED_PRECEDING)))

df14 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.unboundedFollowing)))

df15 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.unboundedPreceding)))

## EXPECTED UNPARSER OUTPUT

df = session.table("table1")

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

df3 = df.select(avg(col("value")).over(Window.partition_by(col("value")).order_by(col("key")).rows_between(Window.currentRow, 2)).as_("window1"), avg(col("value")).over(Window.order_by(col("key").desc()).range_between(Window.unboundedPreceding, Window.unboundedFollowing)).as_("window2"))

df4 = df.select(stddev(col("value")).over(Window.order_by(col("key"))))

df5 = df.select(stddev(col("value")).over(Window.order_by(col("key"), col("value"))))

df6 = df.select(avg(col("value")).over(Window.partition_by(col("key"))))

df7 = df.select(avg(col("value")).over(Window.partition_by(col("key"))))

df8 = df.select(avg(col("value")).over(Window.range_between(0, 2)))

df9 = df.select(avg(col("value")).over(Window.range_between(1, 2)))

df10 = df.select(avg(col("value")).over(Window.rows_between(0, 2)))

df11 = df.select(avg(col("value")).over(Window.rows_between(1, 2)))

df12 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedFollowing)))

df13 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedPreceding)))

df14 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedFollowing)))

df15 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedPreceding)))

## EXPECTED ENCODED AST

Cj8KPQovggwsEgoKCAoGdGFibGUxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSiICCAESBAoCZGYYASICCAEKuwIKuAIKqQKCCaUCCnyiBHkKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEwSA05VTSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEwSA2tleRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEwiAggBCn6iBHsKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEwSA1NUUiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEwSBXZhbHVlGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoTCICCAESB4ICBAoCCAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShMIAESBAoCZGYYAiICCAIKiQgKhggK9geCCfIHCo8EogSLBArfA5oF2wMKggGSAX8KCxoJCgcKBQoDYXZnGlSSAVEKCxoJCgcKBQoDY29sGib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShSEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShSEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUhq3Aiq0AgoEEgIIAhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKE4aAggBIosCEogCClKSAU8KCxoJCgcKBQoDY29sGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShOEgNrZXkiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShOEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoThqVARqSAQpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoThIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShOEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoThoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShOEgd3aW5kb3cxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUiICCAEKtgOiBLIDCoYDmgWCAwqCAZIBfwoLGgkKBwoFCgNhdmcaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFISBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShSGt4BItsBCgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFAaAiABIrQBErEBCnPaBHAKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFASA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFAaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShQEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUBoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShQEgd3aW5kb3cyGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoUiICCAESB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShSIAESBQoDZGYzGAMiAggDCoADCv0CCu0CggnpAgq/ApoFuwIKhgGSAYIBCg4aDAoKCggKBnN0ZGRldhpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShUIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFQakwESkAEKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFQSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShUGh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFQSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShUIAESBQoDZGY0GAQiAggECtYDCtMDCsMDggm/AwqVA5oFkQMKhgGSAYIBCg4aDAoKCggKBnN0ZGRldhpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVhIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShWIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYa6QES5gEKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYKVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYaHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVhIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYgARIFCgNkZjUYBSICCAUK/AIK+QIK6QKCCeUCCrsCmgW3AgqCAZIBfwoLGgkKBwoFCgNhdmcaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWCIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYGpMBGpABClKSAU8KCxoJCgcKBQoDY29sGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEgNrZXkiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWCABEgUKA2RmNhgGIgIIBgr8Agr5AgrpAoIJ5QIKuwKaBbcCCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoakwEakAEKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaGh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaIAESBQoDZGY3GAciAggHCrACCq0CCp0CggmZAgrvAZoF6wEKggGSAX8KCxoJCgcKBQoDYXZnGlSSAVEKCxoJCgcKBQoDY29sGib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBpIIkYKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcGgISACIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXCABEgUKA2RmOBgIIgIICAqyAgqvAgqfAoIJmwIK8QGaBe0BCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aSiJICgQSAggCEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhoEEgIIASIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXiABEgUKA2RmORgJIgIICQqxAgquAgqdAoIJmQIK7wGaBesBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAaSCpGCgQSAggCEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBoCEgAiHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAgARIGCgRkZjEwGAoiAggKCrMCCrACCp8CggmbAgrxAZoF7QEKggGSAX8KCxoJCgcKBQoDYXZnGlSSAVEKCxoJCgcKBQoDY29sGib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGIiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhpKKkgKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiGgQSAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiIAESBgoEZGYxMRgLIgIICwqvAgqsAgqbAoIJlwIK7QGaBekBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaRiJECgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkIAESBgoEZGYxMhgMIgIIDAqvAgqsAgqbAoIJlwIK7QGaBekBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYaRiJECgIgARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmIAESBgoEZGYxMxgNIgIIDQqvAgqsAgqbAoIJlwIK7QGaBekBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgaRiJECgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoIAESBgoEZGYxNBgOIgIIDgqvAgqsAgqbAoIJlwIK7QGaBekBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoaRiJECgIgARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqIAESBgoEZGYxNRgPIgIIDxABGhESDwoNCgVmaW5hbBADGAkgFCIEEAEYFw==
