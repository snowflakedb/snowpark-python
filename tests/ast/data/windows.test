## TEST CASE

from snowflake.snowpark.functions import col, avg, stddev

from snowflake.snowpark.window import Window

df = session.table(tables.table1)

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

window1 = Window.partition_by("value").order_by("key").rows_between(Window.CURRENT_ROW, 2)

window2 = Window.order_by(col("key").desc()).range_between(Window.UNBOUNDED_PRECEDING, Window.UNBOUNDED_FOLLOWING)

df3 = df.select(avg("value").over(window1).as_("window1"), avg("value").over(window2).as_("window2"))

df4 = df.select(stddev("value").over(Window.orderBy("key")))

df5 = df.select(stddev("value").over(Window.order_by("key", "value")))

df6 = df.select(avg("value").over(Window.partitionBy("key")))

df7 = df.select(avg("value").over(Window.partition_by("key")))

df8 = df.select(avg("value").over(Window.rangeBetween(0, 2)))

df9 = df.select(avg("value").over(Window.range_between(1, 2)))

df10 = df.select(avg("value").over(Window.rowsBetween(0, 2)))

df11 = df.select(avg("value").over(Window.rows_between(1, 2)))

df12 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.UNBOUNDED_FOLLOWING)))

df13 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.UNBOUNDED_PRECEDING)))

df14 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.unboundedFollowing)))

df15 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.unboundedPreceding)))

## EXPECTED UNPARSER OUTPUT

df = session.table("table1")

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

df3 = df.select(avg(col("value")).over(Window.partition_by(col("value")).order_by(col("key")).rows_between(Window.currentRow, 2)).as_("window1"), avg(col("value")).over(Window.order_by(col("key").desc()).range_between(Window.unboundedPreceding, Window.unboundedFollowing)).as_("window2"))

df4 = df.select(stddev(col("value")).over(Window.order_by(col("key"))))

df5 = df.select(stddev(col("value")).over(Window.order_by(col("key"), col("value"))))

df6 = df.select(avg(col("value")).over(Window.partition_by(col("key"))))

df7 = df.select(avg(col("value")).over(Window.partition_by(col("key"))))

df8 = df.select(avg(col("value")).over(Window.range_between(0, 2)))

df9 = df.select(avg(col("value")).over(Window.range_between(1, 2)))

df10 = df.select(avg(col("value")).over(Window.rows_between(0, 2)))

df11 = df.select(avg(col("value")).over(Window.rows_between(1, 2)))

df12 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedFollowing)))

df13 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedPreceding)))

df14 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedFollowing)))

df15 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedPreceding)))

## EXPECTED ENCODED AST

Cj8KPQovggwsEgoKCAoGdGFibGUxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoVCICCAESBAoCZGYYASICCAEKuwIKuAIKqQKCCaUCCnyiBHkKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYSA05VTSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYSA2tleRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYiAggBCn6iBHsKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYSA1NUUiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFYSBXZhbHVlGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoViICCAESB4ICBAoCCAEaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShWIAESBAoCZGYYAiICCAIKiQgKhggK9geCCfIHCo8EogSLBArfA5oF2wMKggGSAX8KCxoJCgcKBQoDYXZnGlSSAVEKCxoJCgcKBQoDY29sGib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBq3Aiq0AgoEEgIIAhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgaAggBIosCEogCClKSAU8KCxoJCgcKBQoDY29sGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEgNrZXkiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBqVARqSAQpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWBoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShYEgd3aW5kb3cxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXCICCAEKtgOiBLIDCoYDmgWCAwqCAZIBfwoLGgkKBwoFCgNhdmcaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXCIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcGt4BItsBCgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoaAiABIrQBErEBCnPaBHAKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaEgd3aW5kb3cyGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXCICCAESB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcIAESBQoDZGYzGAMiAggDCoADCv0CCu0CggnpAgq/ApoFuwIKhgGSAYIBCg4aDAoKCggKBnN0ZGRldhpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4akwESkAEKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheGh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheIAESBQoDZGY0GAQiAggECtYDCtMDCsMDggm/AwqVA5oFkQMKhgGSAYIBCg4aDAoKCggKBnN0ZGRldhpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAa6QES5gEKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGASA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAKVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGASBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAaHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAgARIFCgNkZjUYBSICCAUK/AIK+QIK6QKCCeUCCrsCmgW3AgqCAZIBfwoLGgkKBwoFCgNhdmcaVJIBUQoLGgkKBwoFCgNjb2waJvoMIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYiIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiGpMBGpABClKSAU8KCxoJCgcKBQoDY29sGiT6DCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgNrZXkiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYiABEgUKA2RmNhgGIgIIBgr8Agr5AgrpAoIJ5QIKuwKaBbcCCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQakwEakAEKUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkGh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkIAESBQoDZGY3GAciAggHCrACCq0CCp0CggmZAgrvAZoF6wEKggGSAX8KCxoJCgcKBQoDYXZnGlSSAVEKCxoJCgcKBQoDY29sGib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhpIIkYKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmGgISACIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZiABEgUKA2RmOBgIIgIICAqyAgqvAgqfAoIJmwIK8QGaBe0BCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgaSiJICgQSAggCEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBoEEgIIASIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoEgeCAgQKAggCGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaCABEgUKA2RmORgJIgIICQqxAgquAgqdAoIJmQIK7wGaBesBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoaSCpGCgQSAggCEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahoCEgAiHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahIHggIECgIIAhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGogARIGCgRkZjEwGAoiAggKCrMCCrACCp8CggmbAgrxAZoF7QEKggGSAX8KCxoJCgcKBQoDYXZnGlSSAVEKCxoJCgcKBQoDY29sGib6DCMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBpKKkgKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsGgQSAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsIAESBgoEZGYxMRgLIgIICwqvAgqsAgqbAoIJlwIK7QGaBekBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4aRiJECgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4aAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4SB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuIAESBgoEZGYxMhgMIgIIDAqvAgqsAgqbAoIJlwIK7QGaBekBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAaRiJECgIgARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHASB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwIAESBgoEZGYxMxgNIgIIDQqvAgqsAgqbAoIJlwIK7QGaBekBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUochIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUochIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHIaRiJECgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHIaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHISB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyIAESBgoEZGYxNBgOIgIIDgqvAgqsAgqbAoIJlwIK7QGaBekBCoIBkgF/CgsaCQoHCgUKA2F2ZxpUkgFRCgsaCQoHCgUKA2NvbBom+gwjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQaRiJECgIgARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQSB4ICBAoCCAIaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0IAESBgoEZGYxNRgPIgIIDxABGhESDwoNCgVmaW5hbBADGAkgEyIEEAEYFw==
