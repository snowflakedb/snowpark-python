## TEST CASE

from snowflake.snowpark.functions import col, avg, stddev

from snowflake.snowpark.window import Window

df = session.table("test_table")

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

window1 = Window.partition_by("value").order_by("key").rows_between(Window.CURRENT_ROW, 2)

window2 = Window.order_by(col("key").desc()).range_between(Window.UNBOUNDED_PRECEDING, Window.UNBOUNDED_FOLLOWING)

df3 = df.select(avg("value").over(window1).as_("window1"), avg("value").over(window2).as_("window2"))

df4 = df.select(stddev("value").over(Window.orderBy("key")))

df5 = df.select(stddev("value").over(Window.order_by("key", "value")))

df6 = df.select(avg("value").over(Window.partitionBy("key")))

df7 = df.select(avg("value").over(Window.partition_by("key")))

df8 = df.select(avg("value").over(Window.rangeBetween(0, 2)))

df9 = df.select(avg("value").over(Window.range_between(1, 2)))

df10 = df.select(avg("value").over(Window.rowsBetween(0, 2)))

df11 = df.select(avg("value").over(Window.rows_between(1, 2)))

df12 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.UNBOUNDED_FOLLOWING)))

df13 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.UNBOUNDED_PRECEDING)))

df14 = df.select(avg("value").over(Window.rangeBetween(Window.CURRENT_ROW, Window.unboundedFollowing)))

df15 = df.select(avg("value").over(Window.rangeBetween(Window.currentRow, Window.unboundedPreceding)))

## EXPECTED ENCODED AST

CkMKQQozogswEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFgiAggBEgQKAmRmGB0iAggdCvUCCvICCuMC4gjfAgqYAfIDlAEKbXprCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoaJOoLIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSA05VTSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoSA2tleRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoiAggBCpoB8gOWAQptemsKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhok6gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIDU1RSIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoWhIFdmFsdWUaGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShaIgIIARIHigIECgIIHRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFogARIECgJkZhgeIgIIHgrKCQrHCQq3CeIIswkK/ATyA/gECswE6gTIBAq5AXq2AQonCiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgGm96bQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgGibqCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBrtAirqAgoEEgIIAhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwaAggBIsECEr4CCm16awonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcGiTqCyEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgNrZXkiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBqwARqtAQpvem0KJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBom6gsjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXBoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgd3aW5kb3cxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYCICCAEKigTyA4YECtoD6gTWAwq5AXq2AQonCiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgGm96bQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgGibqCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGAiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYBr7ASL4AQoCGAESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheGgIgASLRARLOAQqPAaoEiwEKbXprCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aJOoLIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhoeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgd3aW5kb3cyGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYCICCAESB4oCBAoCCB4aGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShgIAESBQoDZGYzGB8iAggfCtEDCs4DCr4D4gi6AwqQA+oEjAMKvAF6uQEKKgooCgoKCAoGc3RkZGV2EhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhpvem0KJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhom6gsjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoYhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGIargESqwEKbXprCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGIaJOoLIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiGh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGISB4oCBAoCCB4aGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShiIAESBQoDZGY0GCAiAgggCsIECr8ECq8E4girBAqBBOoE/QMKvAF6uQEKKgooCgoKCAoGc3RkZGV2EhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBpvem0KJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBom6gsjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShkIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQanwISnAIKbXprCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaJOoLIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSA2tleSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQKb3ptCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaJuoLIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQaHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZBIHigIECgIIHhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGQgARIFCgNkZjUYISICCCEKzgMKywMKuwPiCLcDCo0D6gSJAwq5AXq2AQonCiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmGm96bQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmGibqCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShmEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhquARqrAQptemsKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhok6gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIDa2V5IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYaHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoZhIHigIECgIIHhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGYgARIFCgNkZjYYIiICCCIKzgMKywMKuwPiCLcDCo0D6gSJAwq5AXq2AQonCiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoGm96bQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoGibqCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShoEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBquARqrAQptemsKJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBok6gshChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBIDa2V5IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGgaHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaBIHigIECgIIHhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGggARIFCgNkZjcYIyICCCMK5wIK5AIK1ALiCNACCqYC6gSiAgq5AXq2AQonCiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqGm96bQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqGibqCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGoiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoahpIIkYKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqGgISACIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShqEgeKAgQKAggeGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoaiABEgUKA2RmOBgkIgIIJArpAgrmAgrWAuII0gIKqALqBKQCCrkBerYBCicKJQoHCgUKA2F2ZxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwab3ptCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaJuoLIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobCIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShsGkoiSAoEEgIIAhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwaBBICCAEiHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobBIHigIECgIIHhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKGwgARIFCgNkZjkYJSICCCUK6AIK5QIK1ALiCNACCqYC6gSiAgq5AXq2AQonCiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuGm96bQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuGibqCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKG4iGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobhpIKkYKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuGgISACIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShuEgeKAgQKAggeGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUobiABEgYKBGRmMTAYJiICCCYK6gIK5wIK1gLiCNICCqgC6gSkAgq5AXq2AQonCiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwGm96bQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwGibqCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHAiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUocBpKKkgKBBICCAISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwGgQSAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHASB4oCBAoCCB4aGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShwIAESBgoEZGYxMRgnIgIIJwrmAgrjAgrSAuIIzgIKpALqBKACCrkBerYBCicKJQoHCgUKA2F2ZxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHIab3ptCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHIaJuoLIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHISBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUociIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHISGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyGkYiRAoCGAESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyGgIIASIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShyEgeKAgQKAggeGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUociABEgYKBGRmMTIYKCICCCgK5gIK4wIK0gLiCM4CCqQC6gSgAgq5AXq2AQonCiUKBwoFCgNhdmcSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0Gm96bQonCiUKBwoFCgNjb2wSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0GibqCyMKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EgV2YWx1ZSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh0EhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBpGIkQKAiABEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBoCCAEiHgocChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodBIHigIECgIIHhoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHQgARIGCgRkZjEzGCkiAggpCuYCCuMCCtIC4gjOAgqkAuoEoAIKuQF6tgEKJwolCgcKBQoDYXZnEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodhpvem0KJwolCgcKBQoDY29sEhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodhom6gsjChoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodhIFdmFsdWUiGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh2IhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUodhIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHYaRiJECgIYARIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHYaAggBIh4KHAoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHYSB4oCBAoCCB4aGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh2IAESBgoEZGYxNBgqIgIIKgrmAgrjAgrSAuIIzgIKpALqBKACCrkBerYBCicKJQoHCgUKA2F2ZxIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHgab3ptCicKJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHgaJuoLIwoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHgSBXZhbHVlIhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoeCIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKHgSGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh4GkYiRAoCIAESGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh4GgIIASIeChwKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSh4EgeKAgQKAggeGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoeCABEgYKBGRmMTUYKyICCCsQARoREg8KDQoFZmluYWwQAxgIIBMiBBABGBU=

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df = df.select(col("NUM").as_("key"), col("STR").as_("value"))

df3 = df.select(avg(col("value")).over(Window.partition_by(col("value")).order_by(col("key")).rows_between(Window.currentRow, 2)).as_("window1"), avg(col("value")).over(Window.order_by(col("key").desc()).range_between(Window.unboundedPreceding, Window.unboundedFollowing)).as_("window2"))

df4 = df.select(stddev(col("value")).over(Window.order_by(col("key"))))

df5 = df.select(stddev(col("value")).over(Window.order_by(col("key"), col("value"))))

df6 = df.select(avg(col("value")).over(Window.partition_by(col("key"))))

df7 = df.select(avg(col("value")).over(Window.partition_by(col("key"))))

df8 = df.select(avg(col("value")).over(Window.range_between(0, 2)))

df9 = df.select(avg(col("value")).over(Window.range_between(1, 2)))

df10 = df.select(avg(col("value")).over(Window.rows_between(0, 2)))

df11 = df.select(avg(col("value")).over(Window.rows_between(1, 2)))

df12 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedFollowing)))

df13 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedPreceding)))

df14 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedFollowing)))

df15 = df.select(avg(col("value")).over(Window.range_between(Window.currentRow, Window.unboundedPreceding)))
