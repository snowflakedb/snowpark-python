## TEST CASE

df = session.create_dataframe([(1, 1),(1, 2),(2, 1),(2, 2),(3, 1),(3, 2)], schema=["a", "b"])

df.group_by("a").min("b").collect()

df.group_by("a").max("b").collect()

df.group_by("a").median("b").collect()

df.group_by("a").function("avg")("b").collect()

df.group_by("a").count()

import pandas as pd

from snowflake.snowpark.types import StructType, StructField, StringType, FloatType

def convert(pandas_df):
    return pandas_df.assign(TEMP_F = lambda x: x.TEMP_C * 9 / 5 + 32)

df = session.createDataFrame([('SF', 21.0), ('SF', 17.5), ('SF', 24.0), ('NY', 30.9), ('NY', 33.6)],
        schema=['location', 'temp_c'])

df.group_by("location").apply_in_pandas(convert,
    output_schema=StructType([StructField("location", StringType()),
                              StructField("temp_c", FloatType()),
                              StructField("temp_f", FloatType())])).order_by("temp_c").collect()


df = session.create_dataframe([(1, 'A', 10000, 'JAN'), (1, 'B', 400, 'JAN'), (1, 'B', 5000, 'FEB')], schema=['empid', 'team', 'amount', 'month'])

df.group_by("empid").pivot("month", ['JAN', 'FEB']).sum("amount").sort(df["empid"]).show()

df.group_by("empid").pivot("month", ['JAN', 'FEB']).sum("amount").show()

df.group_by(["empid", "team"]).pivot("month").sum("amount").sort("empid", "team").show()

## EXPECTED UNPARSER OUTPUT

df = session.create_dataframe([(1, 1), (1, 2), (2, 1), (2, 2), (3, 1), (3, 2)], schema=["a", "b"])

df.group_by("a").min("b").collect()

df = session.create_dataframe([(1, 1), (1, 2), (2, 1), (2, 2), (3, 1), (3, 2)], schema=["a", "b"])

df.group_by("a").max("b").collect()

df = session.create_dataframe([(1, 1), (1, 2), (2, 1), (2, 2), (3, 1), (3, 2)], schema=["a", "b"])

df.group_by("a").median("b").collect()

df = session.create_dataframe([(1, 1), (1, 2), (2, 1), (2, 2), (3, 1), (3, 2)], schema=["a", "b"])

df.group_by("a").avg("b").collect()

df = session.create_dataframe([(1, 1), (1, 2), (2, 1), (2, 2), (3, 1), (3, 2)], schema=["a", "b"])

res14 = df.group_by("a").count()

df = session.create_dataframe([("SF", 21.0), ("SF", 17.5), ("SF", 24.0), ("NY", 30.9), ("NY", 33.6)], schema=["location", "temp_c"])

res16 = udtf("_ApplyInPandas", output_schema=PandasDataFrameType(StringType(), FloatType(), FloatType(), "LOCATION", "TEMP_C", "TEMP_F"), input_types=[StringType(), FloatType()], copy_grants=False, _registered_object_name="\"MOCK_DATABASE\".\"MOCK_SCHEMA\".SNOWPARK_TEMP_TABLE_FUNCTION_xxx")

df.group_by("location").apply_in_pandas(convert, StructType(fields=[StructField("location", StringType(), nullable=True), StructField("temp_c", FloatType(), nullable=True), StructField("temp_f", FloatType(), nullable=True)], structured=False), input_types=[StringType(), FloatType()], input_names=["LOCATION", "TEMP_C"]).sort("temp_c").collect()

df = session.create_dataframe([(1, "A", 10000, "JAN"), (1, "B", 400, "JAN"), (1, "B", 5000, "FEB")], schema=["empid", "team", "amount", "month"])

df.group_by("empid").pivot("month", values=["JAN", "FEB"]).sum("amount").sort(df["empid"]).show()

df = session.create_dataframe([(1, "A", 10000, "JAN"), (1, "B", 400, "JAN"), (1, "B", 5000, "FEB")], schema=["empid", "team", "amount", "month"])

df.group_by("empid").pivot("month", values=["JAN", "FEB"]).sum("amount").show()

df = session.create_dataframe([(1, "A", 10000, "JAN"), (1, "B", 400, "JAN"), (1, "B", 5000, "FEB")], schema=["empid", "team", "amount", "month"])

df.group_by(["empid", "team"]).pivot("month", values=None).sum("amount").sort("empid", "team").show()

## EXPECTED ENCODED AST

interned_value_table {
  string_values {
    key: -1
  }
  string_values {
    key: 2
    value: "SRC_POSITION_TEST_MODE"
  }
}
body {
  bind {
    expr {
      create_dataframe {
        data {
          dataframe_data__list {
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 3
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 3
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
              }
            }
          }
        }
        schema {
          dataframe_schema__list {
            vs: "a"
            vs: "b"
          }
        }
        src {
          end_column: 101
          end_line: 25
          file: 2
          start_column: 13
          start_line: 25
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      dataframe_group_by {
        cols {
          args {
            string_val {
              src {
                end_column: 24
                end_line: 27
                file: 2
                start_column: 8
                start_line: 27
              }
              v: "a"
            }
          }
          variadic: true
        }
        df {
          dataframe_ref {
            id: 1
          }
        }
        src {
          end_column: 24
          end_line: 27
          file: 2
          start_column: 8
          start_line: 27
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 2
  }
}
body {
  bind {
    expr {
      relational_grouped_dataframe_builtin {
        agg_name: "min"
        cols {
          args {
            string_val {
              src {
                end_column: 33
                end_line: 27
                file: 2
                start_column: 8
                start_line: 27
              }
              v: "b"
            }
          }
          variadic: true
        }
        grouped_df {
          relational_grouped_dataframe_ref {
            id: 2
          }
        }
        src {
          end_column: 33
          end_line: 27
          file: 2
          start_column: 8
          start_line: 27
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 3
  }
}
body {
  bind {
    expr {
      dataframe_collect {
        block: true
        case_sensitive: true
        df {
          dataframe_ref {
            id: 3
          }
        }
        src {
          end_column: 43
          end_line: 27
          file: 2
          start_column: 8
          start_line: 27
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 4
  }
}
body {
  eval {
    bind_id: 4
  }
}
body {
  bind {
    expr {
      create_dataframe {
        data {
          dataframe_data__list {
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 3
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 3
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
              }
            }
          }
        }
        schema {
          dataframe_schema__list {
            vs: "a"
            vs: "b"
          }
        }
        src {
          end_column: 101
          end_line: 25
          file: 2
          start_column: 13
          start_line: 25
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      dataframe_group_by {
        cols {
          args {
            string_val {
              src {
                end_column: 24
                end_line: 29
                file: 2
                start_column: 8
                start_line: 29
              }
              v: "a"
            }
          }
          variadic: true
        }
        df {
          dataframe_ref {
            id: 1
          }
        }
        src {
          end_column: 24
          end_line: 29
          file: 2
          start_column: 8
          start_line: 29
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 5
  }
}
body {
  bind {
    expr {
      relational_grouped_dataframe_builtin {
        agg_name: "max"
        cols {
          args {
            string_val {
              src {
                end_column: 33
                end_line: 29
                file: 2
                start_column: 8
                start_line: 29
              }
              v: "b"
            }
          }
          variadic: true
        }
        grouped_df {
          relational_grouped_dataframe_ref {
            id: 5
          }
        }
        src {
          end_column: 33
          end_line: 29
          file: 2
          start_column: 8
          start_line: 29
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 6
  }
}
body {
  bind {
    expr {
      dataframe_collect {
        block: true
        case_sensitive: true
        df {
          dataframe_ref {
            id: 6
          }
        }
        src {
          end_column: 43
          end_line: 29
          file: 2
          start_column: 8
          start_line: 29
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 7
  }
}
body {
  eval {
    bind_id: 7
  }
}
body {
  bind {
    expr {
      create_dataframe {
        data {
          dataframe_data__list {
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 3
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 3
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
              }
            }
          }
        }
        schema {
          dataframe_schema__list {
            vs: "a"
            vs: "b"
          }
        }
        src {
          end_column: 101
          end_line: 25
          file: 2
          start_column: 13
          start_line: 25
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      dataframe_group_by {
        cols {
          args {
            string_val {
              src {
                end_column: 24
                end_line: 31
                file: 2
                start_column: 8
                start_line: 31
              }
              v: "a"
            }
          }
          variadic: true
        }
        df {
          dataframe_ref {
            id: 1
          }
        }
        src {
          end_column: 24
          end_line: 31
          file: 2
          start_column: 8
          start_line: 31
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 8
  }
}
body {
  bind {
    expr {
      relational_grouped_dataframe_builtin {
        agg_name: "median"
        cols {
          args {
            string_val {
              src {
                end_column: 36
                end_line: 31
                file: 2
                start_column: 8
                start_line: 31
              }
              v: "b"
            }
          }
          variadic: true
        }
        grouped_df {
          relational_grouped_dataframe_ref {
            id: 8
          }
        }
        src {
          end_column: 36
          end_line: 31
          file: 2
          start_column: 8
          start_line: 31
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 9
  }
}
body {
  bind {
    expr {
      dataframe_collect {
        block: true
        case_sensitive: true
        df {
          dataframe_ref {
            id: 9
          }
        }
        src {
          end_column: 46
          end_line: 31
          file: 2
          start_column: 8
          start_line: 31
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 10
  }
}
body {
  eval {
    bind_id: 10
  }
}
body {
  bind {
    expr {
      create_dataframe {
        data {
          dataframe_data__list {
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 3
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 3
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
              }
            }
          }
        }
        schema {
          dataframe_schema__list {
            vs: "a"
            vs: "b"
          }
        }
        src {
          end_column: 101
          end_line: 25
          file: 2
          start_column: 13
          start_line: 25
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      dataframe_group_by {
        cols {
          args {
            string_val {
              src {
                end_column: 24
                end_line: 33
                file: 2
                start_column: 8
                start_line: 33
              }
              v: "a"
            }
          }
          variadic: true
        }
        df {
          dataframe_ref {
            id: 1
          }
        }
        src {
          end_column: 24
          end_line: 33
          file: 2
          start_column: 8
          start_line: 33
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 11
  }
}
body {
  bind {
    expr {
      relational_grouped_dataframe_builtin {
        agg_name: "avg"
        cols {
          args {
            string_val {
              src {
                end_column: 45
                end_line: 33
                file: 2
                start_column: 8
                start_line: 33
              }
              v: "b"
            }
          }
          variadic: true
        }
        grouped_df {
          relational_grouped_dataframe_ref {
            id: 11
          }
        }
        src {
          end_column: 45
          end_line: 33
          file: 2
          start_column: 8
          start_line: 33
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 12
  }
}
body {
  bind {
    expr {
      dataframe_collect {
        block: true
        case_sensitive: true
        df {
          dataframe_ref {
            id: 12
          }
        }
        src {
          end_column: 55
          end_line: 33
          file: 2
          start_column: 8
          start_line: 33
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 13
  }
}
body {
  eval {
    bind_id: 13
  }
}
body {
  bind {
    expr {
      create_dataframe {
        data {
          dataframe_data__list {
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 3
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 1
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 101
                  end_line: 25
                  file: 2
                  start_column: 13
                  start_line: 25
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 3
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 101
                      end_line: 25
                      file: 2
                      start_column: 13
                      start_line: 25
                    }
                    v: 2
                  }
                }
              }
            }
          }
        }
        schema {
          dataframe_schema__list {
            vs: "a"
            vs: "b"
          }
        }
        src {
          end_column: 101
          end_line: 25
          file: 2
          start_column: 13
          start_line: 25
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 1
  }
}
body {
  bind {
    expr {
      dataframe_group_by {
        cols {
          args {
            string_val {
              src {
                end_column: 24
                end_line: 35
                file: 2
                start_column: 8
                start_line: 35
              }
              v: "a"
            }
          }
          variadic: true
        }
        df {
          dataframe_ref {
            id: 1
          }
        }
        src {
          end_column: 24
          end_line: 35
          file: 2
          start_column: 8
          start_line: 35
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 14
  }
}
body {
  bind {
    expr {
      relational_grouped_dataframe_builtin {
        agg_name: "count"
        grouped_df {
          relational_grouped_dataframe_ref {
            id: 14
          }
        }
        src {
          end_column: 32
          end_line: 35
          file: 2
          start_column: 8
          start_line: 35
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 15
  }
}
body {
  bind {
    expr {
      create_dataframe {
        data {
          dataframe_data__list {
            vs {
              tuple_val {
                src {
                  end_column: 46
                  end_line: 45
                  file: 2
                  start_column: 13
                  start_line: 44
                }
                vs {
                  string_val {
                    src {
                      end_column: 46
                      end_line: 45
                      file: 2
                      start_column: 13
                      start_line: 44
                    }
                    v: "SF"
                  }
                }
                vs {
                  float64_val {
                    src {
                      end_column: 46
                      end_line: 45
                      file: 2
                      start_column: 13
                      start_line: 44
                    }
                    v: 21.0
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 46
                  end_line: 45
                  file: 2
                  start_column: 13
                  start_line: 44
                }
                vs {
                  string_val {
                    src {
                      end_column: 46
                      end_line: 45
                      file: 2
                      start_column: 13
                      start_line: 44
                    }
                    v: "SF"
                  }
                }
                vs {
                  float64_val {
                    src {
                      end_column: 46
                      end_line: 45
                      file: 2
                      start_column: 13
                      start_line: 44
                    }
                    v: 17.5
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 46
                  end_line: 45
                  file: 2
                  start_column: 13
                  start_line: 44
                }
                vs {
                  string_val {
                    src {
                      end_column: 46
                      end_line: 45
                      file: 2
                      start_column: 13
                      start_line: 44
                    }
                    v: "SF"
                  }
                }
                vs {
                  float64_val {
                    src {
                      end_column: 46
                      end_line: 45
                      file: 2
                      start_column: 13
                      start_line: 44
                    }
                    v: 24.0
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 46
                  end_line: 45
                  file: 2
                  start_column: 13
                  start_line: 44
                }
                vs {
                  string_val {
                    src {
                      end_column: 46
                      end_line: 45
                      file: 2
                      start_column: 13
                      start_line: 44
                    }
                    v: "NY"
                  }
                }
                vs {
                  float64_val {
                    src {
                      end_column: 46
                      end_line: 45
                      file: 2
                      start_column: 13
                      start_line: 44
                    }
                    v: 30.9
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 46
                  end_line: 45
                  file: 2
                  start_column: 13
                  start_line: 44
                }
                vs {
                  string_val {
                    src {
                      end_column: 46
                      end_line: 45
                      file: 2
                      start_column: 13
                      start_line: 44
                    }
                    v: "NY"
                  }
                }
                vs {
                  float64_val {
                    src {
                      end_column: 46
                      end_line: 45
                      file: 2
                      start_column: 13
                      start_line: 44
                    }
                    v: 33.6
                  }
                }
              }
            }
          }
        }
        schema {
          dataframe_schema__list {
            vs: "location"
            vs: "temp_c"
          }
        }
        src {
          end_column: 46
          end_line: 45
          file: 2
          start_column: 13
          start_line: 44
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 16
  }
}
body {
  bind {
    expr {
      dataframe_group_by {
        cols {
          args {
            string_val {
              src {
                end_column: 31
                end_line: 47
                file: 2
                start_column: 8
                start_line: 47
              }
              v: "location"
            }
          }
          variadic: true
        }
        df {
          dataframe_ref {
            id: 16
          }
        }
        src {
          end_column: 31
          end_line: 47
          file: 2
          start_column: 8
          start_line: 47
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 17
  }
}
body {
  bind {
    expr {
      udtf {
        handler {
          name: "_ApplyInPandas"
          object_name {
            name {
              name_flat {
                name: "\"MOCK_DATABASE\".\"MOCK_SCHEMA\".SNOWPARK_TEMP_TABLE_FUNCTION_xxx"
              }
            }
          }
        }
        input_types {
          string_type {
            length {
            }
          }
        }
        input_types {
          float_type: true
        }
        kwargs {
          _1: "copy_grants"
          _2 {
            bool_val {
              src {
                end_column: 75
                end_line: 50
                file: 2
                start_column: 8
                start_line: 47
              }
            }
          }
        }
        output_schema {
          udtf_schema__type {
            return_type {
              pandas_data_frame_type {
                col_names: "LOCATION"
                col_names: "TEMP_C"
                col_names: "TEMP_F"
                col_types {
                  string_type {
                    length {
                    }
                  }
                }
                col_types {
                  float_type: true
                }
                col_types {
                  float_type: true
                }
              }
            }
          }
        }
        parallel: 4
        src {
          end_column: 75
          end_line: 50
          file: 2
          start_column: 8
          start_line: 47
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 18
  }
}
body {
  bind {
    expr {
      relational_grouped_dataframe_apply_in_pandas {
        func {
          id: 1
          name: "convert"
        }
        grouped_df {
          relational_grouped_dataframe_ref {
            id: 17
          }
        }
        kwargs {
          _1: "input_types"
          _2 {
            list_val {
              src {
                end_column: 75
                end_line: 50
                file: 2
                start_column: 8
                start_line: 47
              }
              vs {
                datatype_val {
                  datatype {
                    string_type {
                      length {
                      }
                    }
                  }
                  src {
                    end_column: 75
                    end_line: 50
                    file: 2
                    start_column: 8
                    start_line: 47
                  }
                }
              }
              vs {
                datatype_val {
                  datatype {
                    float_type: true
                  }
                  src {
                    end_column: 75
                    end_line: 50
                    file: 2
                    start_column: 8
                    start_line: 47
                  }
                }
              }
            }
          }
        }
        kwargs {
          _1: "input_names"
          _2 {
            list_val {
              src {
                end_column: 75
                end_line: 50
                file: 2
                start_column: 8
                start_line: 47
              }
              vs {
                string_val {
                  src {
                    end_column: 75
                    end_line: 50
                    file: 2
                    start_column: 8
                    start_line: 47
                  }
                  v: "LOCATION"
                }
              }
              vs {
                string_val {
                  src {
                    end_column: 75
                    end_line: 50
                    file: 2
                    start_column: 8
                    start_line: 47
                  }
                  v: "TEMP_C"
                }
              }
            }
          }
        }
        output_schema {
          fields {
            column_identifier {
              column_name {
                name: "location"
              }
            }
            data_type {
              string_type {
                length {
                }
              }
            }
            nullable: true
          }
          fields {
            column_identifier {
              column_name {
                name: "temp_c"
              }
            }
            data_type {
              float_type: true
            }
            nullable: true
          }
          fields {
            column_identifier {
              column_name {
                name: "temp_f"
              }
            }
            data_type {
              float_type: true
            }
            nullable: true
          }
        }
        src {
          end_column: 75
          end_line: 50
          file: 2
          start_column: 8
          start_line: 47
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 19
  }
}
body {
  bind {
    expr {
      dataframe_sort {
        cols {
          args {
            string_val {
              src {
                end_column: 94
                end_line: 50
                file: 2
                start_column: 76
                start_line: 50
              }
              v: "temp_c"
            }
          }
          variadic: true
        }
        df {
          dataframe_ref {
            id: 19
          }
        }
        src {
          end_column: 94
          end_line: 50
          file: 2
          start_column: 76
          start_line: 50
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 20
  }
}
body {
  bind {
    expr {
      dataframe_collect {
        block: true
        case_sensitive: true
        df {
          dataframe_ref {
            id: 20
          }
        }
        src {
          end_column: 104
          end_line: 50
          file: 2
          start_column: 95
          start_line: 50
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 21
  }
}
body {
  eval {
    bind_id: 21
  }
}
body {
  bind {
    expr {
      create_dataframe {
        data {
          dataframe_data__list {
            vs {
              tuple_val {
                src {
                  end_column: 153
                  end_line: 53
                  file: 2
                  start_column: 13
                  start_line: 53
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 1
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "A"
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 10000
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "JAN"
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 153
                  end_line: 53
                  file: 2
                  start_column: 13
                  start_line: 53
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 1
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "B"
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 400
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "JAN"
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 153
                  end_line: 53
                  file: 2
                  start_column: 13
                  start_line: 53
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 1
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "B"
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 5000
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "FEB"
                  }
                }
              }
            }
          }
        }
        schema {
          dataframe_schema__list {
            vs: "empid"
            vs: "team"
            vs: "amount"
            vs: "month"
          }
        }
        src {
          end_column: 153
          end_line: 53
          file: 2
          start_column: 13
          start_line: 53
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 22
  }
}
body {
  bind {
    expr {
      dataframe_group_by {
        cols {
          args {
            string_val {
              src {
                end_column: 28
                end_line: 55
                file: 2
                start_column: 8
                start_line: 55
              }
              v: "empid"
            }
          }
          variadic: true
        }
        df {
          dataframe_ref {
            id: 22
          }
        }
        src {
          end_column: 28
          end_line: 55
          file: 2
          start_column: 8
          start_line: 55
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 23
  }
}
body {
  bind {
    expr {
      relational_grouped_dataframe_pivot {
        grouped_df {
          relational_grouped_dataframe_ref {
            id: 23
          }
        }
        pivot_col {
          string_val {
            src {
              end_column: 59
              end_line: 55
              file: 2
              start_column: 8
              start_line: 55
            }
            v: "month"
          }
        }
        src {
          end_column: 59
          end_line: 55
          file: 2
          start_column: 8
          start_line: 55
        }
        values {
          list_val {
            src {
              end_column: 59
              end_line: 55
              file: 2
              start_column: 8
              start_line: 55
            }
            vs {
              string_val {
                src {
                  end_column: 59
                  end_line: 55
                  file: 2
                  start_column: 8
                  start_line: 55
                }
                v: "JAN"
              }
            }
            vs {
              string_val {
                src {
                  end_column: 59
                  end_line: 55
                  file: 2
                  start_column: 8
                  start_line: 55
                }
                v: "FEB"
              }
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 24
  }
}
body {
  bind {
    expr {
      relational_grouped_dataframe_builtin {
        agg_name: "sum"
        cols {
          args {
            string_val {
              src {
                end_column: 73
                end_line: 55
                file: 2
                start_column: 8
                start_line: 55
              }
              v: "amount"
            }
          }
          variadic: true
        }
        grouped_df {
          relational_grouped_dataframe_ref {
            id: 24
          }
        }
        src {
          end_column: 73
          end_line: 55
          file: 2
          start_column: 8
          start_line: 55
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 25
  }
}
body {
  bind {
    expr {
      dataframe_sort {
        cols {
          args {
            dataframe_col {
              col_name: "empid"
              df {
                dataframe_ref {
                  id: 22
                }
              }
              src {
                end_column: 90
                end_line: 55
                file: 2
                start_column: 79
                start_line: 55
              }
            }
          }
          variadic: true
        }
        df {
          dataframe_ref {
            id: 25
          }
        }
        src {
          end_column: 91
          end_line: 55
          file: 2
          start_column: 8
          start_line: 55
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 26
  }
}
body {
  bind {
    expr {
      dataframe_show {
        df {
          dataframe_ref {
            id: 26
          }
        }
        n: 10
        src {
          end_column: 98
          end_line: 55
          file: 2
          start_column: 8
          start_line: 55
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 27
  }
}
body {
  eval {
    bind_id: 27
  }
}
body {
  bind {
    expr {
      create_dataframe {
        data {
          dataframe_data__list {
            vs {
              tuple_val {
                src {
                  end_column: 153
                  end_line: 53
                  file: 2
                  start_column: 13
                  start_line: 53
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 1
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "A"
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 10000
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "JAN"
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 153
                  end_line: 53
                  file: 2
                  start_column: 13
                  start_line: 53
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 1
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "B"
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 400
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "JAN"
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 153
                  end_line: 53
                  file: 2
                  start_column: 13
                  start_line: 53
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 1
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "B"
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 5000
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "FEB"
                  }
                }
              }
            }
          }
        }
        schema {
          dataframe_schema__list {
            vs: "empid"
            vs: "team"
            vs: "amount"
            vs: "month"
          }
        }
        src {
          end_column: 153
          end_line: 53
          file: 2
          start_column: 13
          start_line: 53
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 22
  }
}
body {
  bind {
    expr {
      dataframe_group_by {
        cols {
          args {
            string_val {
              src {
                end_column: 28
                end_line: 57
                file: 2
                start_column: 8
                start_line: 57
              }
              v: "empid"
            }
          }
          variadic: true
        }
        df {
          dataframe_ref {
            id: 22
          }
        }
        src {
          end_column: 28
          end_line: 57
          file: 2
          start_column: 8
          start_line: 57
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 28
  }
}
body {
  bind {
    expr {
      relational_grouped_dataframe_pivot {
        grouped_df {
          relational_grouped_dataframe_ref {
            id: 28
          }
        }
        pivot_col {
          string_val {
            src {
              end_column: 59
              end_line: 57
              file: 2
              start_column: 8
              start_line: 57
            }
            v: "month"
          }
        }
        src {
          end_column: 59
          end_line: 57
          file: 2
          start_column: 8
          start_line: 57
        }
        values {
          list_val {
            src {
              end_column: 59
              end_line: 57
              file: 2
              start_column: 8
              start_line: 57
            }
            vs {
              string_val {
                src {
                  end_column: 59
                  end_line: 57
                  file: 2
                  start_column: 8
                  start_line: 57
                }
                v: "JAN"
              }
            }
            vs {
              string_val {
                src {
                  end_column: 59
                  end_line: 57
                  file: 2
                  start_column: 8
                  start_line: 57
                }
                v: "FEB"
              }
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 29
  }
}
body {
  bind {
    expr {
      relational_grouped_dataframe_builtin {
        agg_name: "sum"
        cols {
          args {
            string_val {
              src {
                end_column: 73
                end_line: 57
                file: 2
                start_column: 8
                start_line: 57
              }
              v: "amount"
            }
          }
          variadic: true
        }
        grouped_df {
          relational_grouped_dataframe_ref {
            id: 29
          }
        }
        src {
          end_column: 73
          end_line: 57
          file: 2
          start_column: 8
          start_line: 57
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 30
  }
}
body {
  bind {
    expr {
      dataframe_show {
        df {
          dataframe_ref {
            id: 30
          }
        }
        n: 10
        src {
          end_column: 80
          end_line: 57
          file: 2
          start_column: 8
          start_line: 57
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 31
  }
}
body {
  eval {
    bind_id: 31
  }
}
body {
  bind {
    expr {
      create_dataframe {
        data {
          dataframe_data__list {
            vs {
              tuple_val {
                src {
                  end_column: 153
                  end_line: 53
                  file: 2
                  start_column: 13
                  start_line: 53
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 1
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "A"
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 10000
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "JAN"
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 153
                  end_line: 53
                  file: 2
                  start_column: 13
                  start_line: 53
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 1
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "B"
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 400
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "JAN"
                  }
                }
              }
            }
            vs {
              tuple_val {
                src {
                  end_column: 153
                  end_line: 53
                  file: 2
                  start_column: 13
                  start_line: 53
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 1
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "B"
                  }
                }
                vs {
                  int64_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: 5000
                  }
                }
                vs {
                  string_val {
                    src {
                      end_column: 153
                      end_line: 53
                      file: 2
                      start_column: 13
                      start_line: 53
                    }
                    v: "FEB"
                  }
                }
              }
            }
          }
        }
        schema {
          dataframe_schema__list {
            vs: "empid"
            vs: "team"
            vs: "amount"
            vs: "month"
          }
        }
        src {
          end_column: 153
          end_line: 53
          file: 2
          start_column: 13
          start_line: 53
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
      value: "df"
    }
    uid: 22
  }
}
body {
  bind {
    expr {
      dataframe_group_by {
        cols {
          args {
            string_val {
              src {
                end_column: 38
                end_line: 59
                file: 2
                start_column: 8
                start_line: 59
              }
              v: "empid"
            }
          }
          args {
            string_val {
              src {
                end_column: 38
                end_line: 59
                file: 2
                start_column: 8
                start_line: 59
              }
              v: "team"
            }
          }
        }
        df {
          dataframe_ref {
            id: 22
          }
        }
        src {
          end_column: 38
          end_line: 59
          file: 2
          start_column: 8
          start_line: 59
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 32
  }
}
body {
  bind {
    expr {
      relational_grouped_dataframe_pivot {
        grouped_df {
          relational_grouped_dataframe_ref {
            id: 32
          }
        }
        pivot_col {
          string_val {
            src {
              end_column: 53
              end_line: 59
              file: 2
              start_column: 8
              start_line: 59
            }
            v: "month"
          }
        }
        src {
          end_column: 53
          end_line: 59
          file: 2
          start_column: 8
          start_line: 59
        }
        values {
          null_val {
            src {
              end_column: 53
              end_line: 59
              file: 2
              start_column: 8
              start_line: 59
            }
          }
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 33
  }
}
body {
  bind {
    expr {
      relational_grouped_dataframe_builtin {
        agg_name: "sum"
        cols {
          args {
            string_val {
              src {
                end_column: 67
                end_line: 59
                file: 2
                start_column: 8
                start_line: 59
              }
              v: "amount"
            }
          }
          variadic: true
        }
        grouped_df {
          relational_grouped_dataframe_ref {
            id: 33
          }
        }
        src {
          end_column: 67
          end_line: 59
          file: 2
          start_column: 8
          start_line: 59
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 34
  }
}
body {
  bind {
    expr {
      dataframe_sort {
        cols {
          args {
            string_val {
              src {
                end_column: 89
                end_line: 59
                file: 2
                start_column: 8
                start_line: 59
              }
              v: "empid"
            }
          }
          args {
            string_val {
              src {
                end_column: 89
                end_line: 59
                file: 2
                start_column: 8
                start_line: 59
              }
              v: "team"
            }
          }
          variadic: true
        }
        df {
          dataframe_ref {
            id: 34
          }
        }
        src {
          end_column: 89
          end_line: 59
          file: 2
          start_column: 8
          start_line: 59
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 35
  }
}
body {
  bind {
    expr {
      dataframe_show {
        df {
          dataframe_ref {
            id: 35
          }
        }
        n: 10
        src {
          end_column: 96
          end_line: 59
          file: 2
          start_column: 8
          start_line: 59
        }
      }
    }
    first_request_id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
    symbol {
    }
    uid: 36
  }
}
body {
  eval {
    bind_id: 36
  }
}
client_ast_version: 1
client_language {
  python_language {
    version {
      label: "final"
      major: 3
      minor: 9
      patch: 1
    }
  }
}
client_version {
  major: 1
  minor: 31
}
id: "\003U\"\366q\366P\346\260\261?\234\303\254\316\353"
