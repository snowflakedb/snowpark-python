## TEST CASE

df = session.table("test_table")

df = df.select(col("A").cast("string(42)"))

df = df.select(col("A").cast(TimestampType(TimestampTimeZone.NTZ)))

df = df.select(col("A").cast(TimestampType(TimestampTimeZone.LTZ)))

df = df.select(col("A").cast(TimestampType(TimestampTimeZone.TZ)))

df = df.select(col("A").cast(ArrayType(GeometryType(), structured=True)))

df = df.select(col("A").cast(MapType(GeographyType(), VariantType(), structured=True)))

df = df.select(col("A").cast(VectorType(int, 64)))

df = df.select(col("A").cast(StructType([
    StructField(ColumnIdentifier("test1"), StringType(), nullable=False),
    StructField("test2", IntegerType(), nullable=True),
    StructField(ColumnIdentifier("test3"), ArrayType(LongType())),
    StructField("test4", MapType(DecimalType(42, 23), VectorType("float", 64)))
], structured=True)))

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df = df.select(col("A").cast(StringType(42)))

df = df.select(col("A").cast(TimestampType(TimestampTimeZone.NTZ)))

df = df.select(col("A").cast(TimestampType(TimestampTimeZone.LTZ)))

df = df.select(col("A").cast(TimestampType(TimestampTimeZone.TZ)))

df = df.select(col("A").cast(ArrayType(GeometryType(), structured=True)))

df = df.select(col("A").cast(MapType(GeographyType(), VariantType(), structured=True)))

df = df.select(col("A").cast(VectorType(IntegerType(), 64)))

df = df.select(col("A").cast(StructType([StructField("test1", StringType(), nullable=False), StructField("test2", IntegerType(), nullable=True), StructField("test3", ArrayType(LongType(), structured=False), nullable=True), StructField("test4", MapType(DecimalType(42, 23), VectorType(FloatType(), 64), structured=False), nullable=True)], structured=True)))

## EXPECTED ENCODED AST

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
