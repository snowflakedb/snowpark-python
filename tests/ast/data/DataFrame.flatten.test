## TEST CASE

df = session.table("test_table")

df1 = df.flatten("STR", "path", True, False)

df2 = df.flatten(col("NUM"), recursive=True, mode="ARRAY")

## EXPECTED UNPARSER OUTPUT



## EXPECTED ENCODED AST

CkMKQQozwgswEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoiAggBEgQKAmRmGAEiAggBCm0KawpcugdZCgeCAgQKAggBEiSCDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgNTVFIaAhABIAEqBgoEcGF0aDoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSBQoDZGYxGAIiAggCCrIBCq8BCp8BugebAQoHggIECgIIARJuigFrCicaJQoHCgUKA2NvbBIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aJIIMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4SA05VTSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKF4aAggBMAE6GhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgUKA2RmMhgDIgIIAxABGhESDwoNCgVmaW5hbBADGAkgEyIEEAEYFQ==
