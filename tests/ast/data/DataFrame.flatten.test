## TEST CASE

df = session.table(tables.table1)

df1 = df.flatten("STR", "path", True, False)

df2 = df.flatten(col("NUM"), recursive=True, mode="ARRAY")

## EXPECTED UNPARSER OUTPUT

df = session.table("table1")

df1 = df.flatten("STR", Some("path"), True, False, "BOTH")

df2 = df.flatten(col("NUM"), None, False, True, "ARRAY")

## EXPECTED ENCODED AST

Cj8KPQovggwsEgoKCAoGdGFibGUxGhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoRiICCAESBAoCZGYYASICCAEKbQprClzCB1kKB4ICBAoCCAESJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEgSA1NUUhoCEAEgASoGCgRwYXRoOhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoSBIFCgNkZjEYAiICCAIKlQEKkgEKggHCB38KB4ICBAoCCAESUpIBTwoLGgkKBwoFCgNjb2waJPoMIQoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEoSA05VTSIaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKEoaAggBMAE6GhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShKEgUKA2RmMhgDIgIIAxABGhESDwoNCgVmaW5hbBADGAkgFCIEEAEYFw==
