## TEST CASE

df = session.table("test_table")

df1 = df.flatten("STR", "path", True, False)

df2 = df.flatten(col("NUM"), recursive=True, mode="ARRAY")

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df1 = df.flatten("STR", Some("path"), True, False, "BOTH")

df2 = df.flatten(col("NUM"), None, False, True, "ARRAY")

## EXPECTED ENCODED AST

<<<<<<< HEAD
CkMKQQoz4gswEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoiAggBEgQKAmRmGAEiAggBCm0KawpcugdZCgeCAgQKAggBEiSyDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgNTVFIaAhABIAEqBgoEcGF0aDoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSBQoDZGYxGAIiAggCCpUBCpIBCoIBugd/CgeCAgQKAggBElKKAU8KCxoJCgcKBQoDY29sGiSyDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgNOVU0iGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheGgIIATABOhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIFCgNkZjIYAyICCAMQARoREg8KDQoFZmluYWwQAxgJIBQiBBABGBc=
=======
CkMKQQoz4gswEg4KDAoKdGVzdF90YWJsZRoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFoiAggBEgQKAmRmGAEiAggBCm0KawpcugdZCgeCAgQKAggBEiTaDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERShcEgNTVFIaAhABIAEqBgoEcGF0aDoaGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFKFwSBQoDZGYxGAIiAggCCpUBCpIBCoIBugd/CgeCAgQKAggBElKKAU8KCxoJCgcKBQoDY29sGiTaDCEKGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheEgNOVU0iGhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSheGgIIATABOhoaFlNSQ19QT1NJVElPTl9URVNUX01PREUoXhIFCgNkZjIYAyICCAMQARoREg8KDQoFZmluYWwQAxgJIBQiBBABGBc=
>>>>>>> 10efa4a6b (SNOW-1677859 Add table functions passthough dataframeAst)
