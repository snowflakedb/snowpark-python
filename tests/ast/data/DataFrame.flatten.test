## TEST CASE

df = session.table("test_table")

df1 = df.flatten("STR", "path", True, False)

df2 = df.flatten(col("NUM"), recursive=True, mode="ARRAY")

## EXPECTED UNPARSER OUTPUT

df = session.table("test_table")

df1 = df.flatten("STR", Some("path"), True, False, "BOTH")

df2 = df.flatten(col("NUM"), None, False, True, "ARRAY")

## EXPECTED ENCODED AST

CkkKRwo56gs2Eg4KDAoKdGVzdF90YWJsZRogCCgQWhoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSANKFoiAggBEgQKAmRmGAEiAggBCnkKdwpoygdlCgeCAgQKAggBEiq6DCcKIAg0EFwaFlNSQ19QT1NJVElPTl9URVNUX01PREUgDihcEgNTVFIaAhABIAEqBgoEcGF0aDogCDQQXBoWU1JDX1BPU0lUSU9OX1RFU1RfTU9ERSAOKFwSBQoDZGYxGAIiAggCCssBCsgBCrgByge0AQoHggIECgIIARKAAYoBfQotGisKBwoFCgNjb2wSIAgjEF4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgGSheGiq6DCcKIAgjEF4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgGSheEgNOVU0iIAgjEF4aFlNSQ19QT1NJVElPTl9URVNUX01PREUgGSheGgIIATABOiAIQhBeGhZTUkNfUE9TSVRJT05fVEVTVF9NT0RFIA4oXhIFCgNkZjIYAyICCAMQARoREg8KDQoFZmluYWwQAxgLIAkiBBABGBU=
